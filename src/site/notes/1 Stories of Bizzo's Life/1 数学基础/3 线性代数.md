---
{"dg-publish":true,"permalink":"/1 Stories of Bizzo's Life/1 数学基础/3 线性代数/","tags":["线性代数"]}
---



> [!quote] 引言  
> We think basis-free, we write basis-free, but when the chips are down we close the office door and compute with matrices like fury.  
> —— Kaplansky

---

> [!abstract] 本章目录  
> - 矩阵的秩  
> - 线性空间  
> - 线性映射和线性变换  
> - 不变子空间  
> - 线性变换的对角化  
> - 张量积  
> - Jordan 标准型

---

> [!note] 来源参考  
> 本章大部分内容来自《李忠华线性代数》。

---
## 线性代数的基础知识
### 高斯消元法
- [[高斯消元法\|高斯消元法]] 
## 矩阵的秩

> [!definition] 矩阵的秩（Rank of a matrix）  
> 对于矩阵 $A \in \mathbb{F}^{m \times n}$，矩阵的秩定义为其行向量组的秩（等于列向量组的秩）。记为 $\operatorname{rank}(A)=r$。

矩阵的秩代表了矩阵中真正的行、列的数量。矩阵的行向量组的秩等于列向量组的秩，由此定义矩阵的秩。设$A\in \mathbb{F}^{m \times n}$，线性映射$f(x)=Ax$，下面列举矩阵的秩的性质如下

> [!theorem] 矩阵秩的基本性质  
> 设线性映射 $f(x)=Ax$，矩阵 $A$ 的秩具有以下重要性质：  
> 1. 若 $A$ 等价于梯形矩阵 $B$，则 $\operatorname{rank}(A)$ 等于非零行的数目。  
> 2. $0 \le \operatorname{rank}(A) \le \min\{m, n\}$。  
> 3. $f$ 为单射 ⇔ $\operatorname{rank}(A) = n$ ⇔ $A$ 列满秩 ⇔ 存在 $B$ 使 $BA = I_n$。  
> 4. $f$ 为满射 ⇔ $\operatorname{rank}(A) = m$（行满秩）。  
> 5. $\operatorname{rank}(A)$ 等于 $A$ 的最大非零子式阶数。  
> 6. 若 $m=n$，则 $A$ 可逆 ⇔ 满秩。  
> 7. 对 $B \in \mathbb{F}^{n \times k}$，有 $\operatorname{rank}(AB) \le \min(\operatorname{rank}(A), \operatorname{rank}(B))$。  
> 8. $\operatorname{rank}(A)=r$ 当且仅当存在可逆矩阵 $X$, $Y$，使得  
> $$ 
> XAY = 
> \begin{pmatrix}
>   I_r & 0\\
>   0   & 0
> \end{pmatrix}.
> $$  
> 9. 对复数矩阵，有  
> $$ 
> \operatorname{rank}(A)=\operatorname{rank}(\overline{A})=
> \operatorname{rank}(A^{\top})=\operatorname{rank}(A^{\ast})=
> \operatorname{rank}(A A^{\ast})=\operatorname{rank}(A^{\ast} A).
> $$  
> 10. Frobenius 不等式：  
> $$ 
> \operatorname{rank}(AB) + \operatorname{rank}(BC) \le \operatorname{rank}(B) + \operatorname{rank}(ABC),
> $$  
> 推论（Sylvester）：  
> $$ 
> \operatorname{rank}(A) + \operatorname{rank}(C) - n \le \operatorname{rank}(AC).
> $$  
> 11. **满秩分解**：若 $\operatorname{rank}(A) = r$，则存在矩阵 $H \in \mathbb{F}^{m \times r}$，$L \in \mathbb{F}^{r \times n}$，满足 $A = H L$，且 $H$ 列满秩、$L$ 行满秩。  
> 12. 若 $S = \{X \mid AX=0\}$ 是齐次线性方程组 $AX=0$ 的解空间，则  
> $$ 
> \dim S = n - \operatorname{rank}(A).
> $$

> [!proof] 证明思路（示意）  
> - （1）利用初等行变换将 $A$ 化为梯形形式，直接统计非零行得出秩。  
> - （2）通过列满秩与存在左逆的等价性、行满秩与满射的对应，有基本结论3–6。  
> - （3）“满秩分解”可通过选取基扩展的方法构造 $H, L$。  
> - （4）秩与解空间维度关系来自基础维数公式：$\dim \ker f + \dim \mathrm{Im}\,f = n$。

---
## 线性空间

> [!definition] 线性空间和子空间
> 设 $V$ 是非空集合, 如果
> - 在 $V$ 中有二元运算$+$, 称为加法，$(V,+)$构成Abel群，即: 对任意 $\alpha, \beta \in V$, 存在唯一的 $\gamma \in V$ 与之对应, 称为 $\alpha$ 与 $\beta$ 的和, 记为 $\gamma=\alpha+\beta$. 加法满足:
>   - (加法结合律) $(\alpha+\beta)+\gamma=\alpha+(\beta+\gamma), \quad(\forall \alpha, \beta, \gamma \in V)$;
>   - (加法交换律) $\alpha+\beta=\beta+\alpha, \quad(\forall \alpha, \beta \in V)$;
>   - (零元存在性) $\exists 0 \in V$, 使得: $\forall \alpha \in V$ 有 $\alpha+0=\alpha$. 称 0 为 $V$ 的零元素;
>   - (负元存在性) $\forall \alpha \in V, \exists \beta \in V$, 使得 $\alpha+\beta=0$. 称 $\beta$ 为 $\alpha$ 的负元;
>
> - 在 $\mathbb{F}$ 和 $V$ 之间有运算, 称为数乘: 对任意 $c \in \mathbb{F}$, 任意 $\alpha \in V$, 存在唯一的 $\delta \in V$ 与之对应, 称为 $c$ 与 $\alpha$ 的数乘, 记为 $\delta=c \alpha=c \cdot \alpha$. 数乘满足
>   - (二次数乘律) $a(b \alpha)=(a b) \alpha, \quad(\forall a, b \in \mathbb{F}, \forall \alpha \in V)$;
>   - (单位数乘律) $1 \cdot \alpha=\alpha, \quad(\forall \alpha \in V)$;
>
> - 加法和数乘还满足
>   - (数对元的分配律) $c(\alpha+\beta)=c \alpha+c \beta, \quad(\forall c \in \mathbb{F}, \forall \alpha, \beta \in V)$;
>   - (元对数的分配律) $(a+b) \alpha=a \alpha+b \alpha, \quad(\forall a, b \in \mathbb{F}, \forall \alpha \in V)$,
>
> 则称 $V$ 是数域 $\mathbb{F}$ 上的\mydef{线性空间}或向量空间, 任意元素 $\alpha \in V$ 称为\mydef{向量}。 当 $\mathbb{F}=\mathbb{R}$ 时, 称 $V$ 是实线性空间; 当 $\mathbb{F}=\mathbb{C}$ 时, 称 $V$ 是复线性空间.
>
> 设 $W$ 是 $V$ 的非空子集, 如果 $W$ 对 $V$ 中的加法和数乘运算封闭，则称$W$是$V$的\mydef{子线性空间}。

---

> [!definition] 线性映射和同构
> 设 $V$ 和 $W$ 是 $\mathbb{F}$ 上的线性空间, 如果映射 $\varphi: V \rightarrow W$ 满足
>
> (i) $($ 保加法) $\varphi(\alpha+\beta)=\varphi(\alpha)+\varphi(\beta), \quad \forall \alpha, \beta \in V$;
>
> (ii) (保数乘) $\varphi(k \alpha)=k \varphi(\alpha), \quad \forall \alpha \in V, \forall k \in \mathbb{F}$,
> 则称 $\varphi$ 是 $V$ 到 $W$ 的\mydef{线性映射}. 称线性映射 $\varphi: V \rightarrow V$ 为 $V$ 上的线性变换, 称线性映射 $\varphi: V \rightarrow \mathbb{F}$ 为 $V$ 上的线性函数.
>
> 如果$\varphi$ 为双射,则称 $\varphi$ 是\mydef{同构映射}, 简称为同构. 此时称 $V$ 和 $W$ \mydef{同构}, 记为 $V \cong W$.

---

> [!note]
> 线性映射保持了线性空间的结构，是线性空间之间的“同态”。

---

> [!definition] 直和
> 设 $W_{1}, W_{2}, \ldots, W_{r} \subset V$ 是子空间 $(r \geqslant 2)$, 如果对任意 $\alpha \in W_{1}+W_{2}+\cdots+W_{r}, \alpha$ 可唯一写为
> $$\alpha=\alpha_{1}+\alpha_{2}+\cdots+\alpha_{r}, \quad\left(\alpha_{i} \in W_{i}, i=1,2, \ldots, r\right),$$
> 则称和 $W_{1}+W_{2}+\cdots+W_{r}$ 是\mydef{直和}, 记为 $W_{1} \oplus W_{2} \oplus \cdots \oplus W_{r}$.

---

> [!note]
> 除了上述的（内）直和以外，有另一种定义两个线性空间（外）直和的方法，赋予向量空间$U$和$V$的笛卡尔积$U\times V$数乘和加法
> $$\begin{array}{l}\left(\alpha_{1}, \beta_{1}\right)+\left(\alpha_{2}, \beta_{2}\right) \equiv\left(\alpha_{1}+\alpha_{2}, \beta_{1}+\beta_{2}\right), \quad\left(\alpha_{1}, \alpha_{2} \in U, \beta_{1}, \beta_{2} \in V\right) \\ c(\alpha, \beta) \equiv(c \alpha, c \beta), \quad(c \in \mathbb{F}, \alpha \in U, \beta \in V)\end{array}$$
> 并定义
> $$\begin{array}{l}\widetilde{U} \equiv\{(\alpha, 0) \in U \times V \mid \alpha \in U\} \subset U \times V, \\ \widetilde{V} \equiv\{(0, \beta) \in U \times V \mid \beta \in V\} \subset U \times V,\end{array}$$
> $$\begin{array}{l}\phi_{1}: U \rightarrow \widetilde{U} ; \alpha \mapsto(\alpha, 0), \\ \phi_{2}: V \rightarrow \widetilde{V} ; \beta \mapsto(0, \beta),\end{array}$$
> 可以证明：$\phi_1$和$\phi_2$是同构，$\widetilde{U}$ 和 $\widetilde{V}$ 是 $U \times V$ 的子空间, 并且 $U \times V=\widetilde{U} \oplus \widetilde{V}$
>
> 除了线性空间以外，线性映射也可以定义直和，参见第\ref{sec:invardirect}节。

---

> [!definition] 商空间和正则同态
> 设$W$是$V$的子空间，定义$a\in V$的等价类 $$\overline{\alpha}=\alpha+W \equiv\{\alpha+\beta \mid \beta \in W\}$$
> 则商集
> $$V / W=\{\overline{\alpha} \mid \alpha \in V\}$$
> 构成线性空间，称为\mydef{商空间}。
>
> 映射$c:V\rightarrow V/W,a\mapsto \overline{a} $是线性映射，称为\mydef{正则同态}或者正则线性映射。

---

> [!note]
> 任取一个子空间$W$都可以按照上面的方式诱导一个正则同态$c$，这个$c$的核$\mathrm{ker}$正是$W$，反之，每个线性映射$c$也可以定义一个子空间$W=\mathrm{ker}(c)$。换句话说，每个子空间都是正则同态（正则线性映射）的核。
>
> 从Zorn引理(与选择公理等价)可以推论每个线性空间，无论维度是否有限，都存在基底{\cite[Sec.1.6]{farenick2001AlgebrasLinearTransformations}}。

---

> [!definition] 正则同构
> 利用商空间可以构造同构。设$W$是$V$的子空间，$V=W \oplus U$，其中$U$是$V$关于$W$的任意直和补，则线性映射$f:U \rightarrow V /W, a \mapsto  \overline{a} $是同构，称为$V$关于$W$的\mydef{正则同构}。

---

在线性代数中讨论的基实际上是Hamel基，要求每个向量都能用基用有限和来展开。Hamel基通常会太大，$\mathbb{R}[x]^*=\mathbb{R}^\mathbb{N}$上的基是不可数大的，参见习题{\cite[Cha.1-23]{farenick2001AlgebrasLinearTransformations}}。在Hilbert空间中，存在收敛的概念，允许可数无穷多的求和，更多讨论，参见\href{https://en.wikipedia.org/wiki/Basis_(linear_algebra)}{basis}。

---

## 线性映射和线性变换

线性映射$\mathscr{A}\in \mathcal{L}(V,W)$满足
$$\left\{\begin{array}{c}\mathscr{A}\left(\alpha_{1}\right)=a_{11} \beta_{1}+a_{21} \beta_{2}+\cdots+a_{m 1} \beta_{m} \\ \mathscr{A}\left(\alpha_{2}\right)=a_{12} \beta_{1}+a_{22} \beta_{2}+\cdots+a_{m 2} \beta_{m} \\ \vdots \\ \mathscr{A}\left(\alpha_{n}\right)=a_{1 n} \beta_{1}+a_{2 n} \beta_{2}+\cdots+a_{m n} \beta_{m}\end{array}\right.$$
其中$\operatorname{dim} V=n, \operatorname{dim} W=m$。记$\mathscr{A}$的矩阵为$A$，则有
$$\mathscr{A}\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n}\right)=\left(\beta_{1}, \beta_{2}, \ldots, \beta_{m}\right) A$$
简记为$\mathscr{A}(\alpha_j)=\beta_i a_{ij}$，如果$\alpha $是一组标准正交基，用braket符号记为$ $\mathcal{A} = a_{ij} |\beta_i\rangle \langle \alpha_j|$ $，如果$$\alpha$$不是标准正交基，则使用对偶基$$\alpha^*$，$\mathcal{A} = \sum_{i,j} a_{ij} |\beta_i\rangle \langle \alpha_j^*|$。

---

> [!theorem] 同态基本定理
> 设 $\mathscr{A}: V \rightarrow W$ 是线性映射, $U \subset V$ 是 $V$ 的子空间.若 $U \subset \operatorname{ker}(\mathscr{A})$, 则存在唯一的线性映射 $\mathscr{B}: V / U \rightarrow W$, 使得 $\mathscr{B} \circ \phi=\mathscr{A}$, 即有交换图

---

> [!proof]
> 对任意的$\overline{\alpha}\in V/U$，定义$\mathscr{B}(\overline{\alpha})=\mathscr{A}(\alpha)$，并证明线性性和唯一性即可。

---

> [!note]
> 定理中的$\phi$就是正则同态。

---

> [!theorem] 第一同构定理{\cite[Sec.7.4]{李忠华线代}}
> 设 $\mathscr{A}: V \rightarrow W$ 是线性映射, 则
> - $\operatorname{Im}(\mathscr{A})$ 是 $W$ 的子空间,
> - $\operatorname{ker}(\mathscr{A})$ 是 $V$ 的子空间;
> - $V / \operatorname{ker}(\mathscr{A}) \cong \operatorname{Im}(\mathscr{A})$

---

> [!proof]
> 定义$\alpha\in W$的等价类
> $$\overline{\alpha}=\alpha+\mathrm{ker}(\mathscr{A}) \equiv\{\beta\in V|\mathscr{A}(\alpha)=\mathscr{A}(\beta)\}$$
>
> 则存在同构$h: V/\mathrm{ker}(\mathscr{A})\rightarrow \mathrm{Im}(\mathscr{A}), \overline{\alpha } \mapsto\mathscr{A}(\alpha)$，$V/\mathrm{ker}{\mathscr{A}}\cong \mathrm{Im} {\mathscr{A}}$。

---

> [!note]
> 该定理在群、环、模中都有类似物。
>
> 该定理中构造的同构$h$的逆$h^{-1}$能够被视为前述定义的正则同构。实际上，由于$\mathrm{ker}(\mathscr{A})$是$V$的子空间，可以做直和分解$V=\mathrm{ker}(\mathscr{A})\oplus U$，任取$v\in V$，有唯一分解$v=\beta+u$，其中$\beta\in  \mathrm{ker}(\mathscr{A}),~u\in U$。在该定理中取$\mathscr{A}(v)=u\in U$ ，则 $h^{-1}:\mathrm{Im}(\mathscr{A})\rightarrow V/\mathrm{ker}(\mathscr{A}),\mathscr{A}(v)=u\mapsto \overline{u}=\overline{v}$就是$V$关于子空间$\mathrm{ker}(\mathscr{A})$的正则同构。

---

> [!definition] 对偶空间
> 设 $V$ 是数域 $\mathbb{F}$ 上的线性空间, 则称线性映射 $f: V \longrightarrow \mathbb{F}$ 为 $V$ 上的线性函数. 通常记 $V$ 上所有的线性函数的集合 $\mathcal{L}(V, \mathbb{F})$ 为 $V^{*}$, 它在线性函数的加法和数乘下成为 $\mathbb{F}$ 上的线性空间, 称 $V^{*}$ 为 $V$ 的\mydef{对偶空间}。

---

> [!note]
> 在微分几何中，对偶空间中的元素被称为1-form。

---

$B(\mathsf{X},\mathsf{Y})$是线性映射的线性空间，如果分别在$\mathsf{X}$和$\mathsf{Y}$上取定基底$\{x_k\}$和$\{y_k\}$，那么$B(\mathsf{X},\mathsf{Y})$上有基底$E_{jk}$满足
$$ E_{jk}x_h=\delta_{kh}y_j $$
如果$\{x_k\}$是标准正交基，那么
$$ E_{jk}=|y_j\rangle \langle x_k|$$
## 不变子空间与直和 \label{sec:invardirect}

> [!theorem] 线性映射的直和分解
> 
> 设 $\mathscr{A}$ 是 $n$ 维线性空间 $V$ 上的线性变换.
> 
> (1) 如果存在 $V$ 的基 $\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n}$ 使得 $\mathscr{A}$ 在这组基下的矩阵是分块对角阵
> $$
> A=\operatorname{diag}\left(A_{1}, A_{2}, \ldots, A_{s}\right), \quad\left(A_{i} \in \mathbb{F}^{n_{i} \times n_{i}}, n_{1}+\cdots+n_{s}=n\right),
> $$
> 令
> $$
> W_{i}=\operatorname{Span}\left(\left\{\alpha_{n_{1}+\cdots+n_{i-1}+1}, \alpha_{n_{1}+\cdots+n_{i-1}+2}, \ldots, \alpha_{n_{1}+\cdots+n_{i}}\right\}\right) \subset V,
> $$
> 其中约定 $n_{0}=0$, 则 $W_{1}, W_{2}, \ldots, W_{s}$ 是 $\mathscr{A}$ 的不变子空间, $V=W_{1} \oplus W_{2} \oplus \cdots \oplus W_{s}$,且
> $$
> \begin{aligned}
> & \left.\mathscr{A}\right|_{W_{i}}\left(\alpha_{n_{1}+\cdots+n_{i-1}+1}, \alpha_{n_{1}+\cdots+n_{i-1}+2}, \ldots, \alpha_{n_{1}+\cdots+n_{i}}\right) \\
> = & \left(\alpha_{n_{1}+\cdots+n_{i-1}+1}, \alpha_{n_{1}+\cdots+n_{i-1}+2}, \ldots, \alpha_{n_{1}+\cdots+n_{i}}\right) A_{i}
> \end{aligned}
> $$
> 
> (2) 反之, 如果 $V=W_{1} \oplus W_{2} \oplus \cdots \oplus W_{s}$, 其中 $W_{1}, W_{2}, \ldots, W_{s}$ 都是 $\mathscr{A}$ 的不变子空间, $\operatorname{dim} W_{i}=n_{i}$. 任取 $W_{i}$ 的基 $\alpha_{n_{1}+\cdots+n_{i-1}+1}, \alpha_{n_{1}+\cdots+n_{i-1}+2}, \ldots, \alpha_{n_{1}+\cdots+n_{i}}$,则 $\mathscr{A}$ 在 $V$ 的基 $\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n}$ 下的矩阵是分块对角阵, 即有
> $$
> \mathscr{A}\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n}\right)=\left(\alpha_{1}, \alpha_{2}, \ldots, \alpha_{n}\right) \operatorname{diag}\left(A_{1}, A_{2}, \ldots, A_{s}\right),
> $$
> 其中 $A_{i} \in \mathbb{F}^{n_{i} \times n_{i}}$ 是 $\left.\mathscr{A}\right|_{W_{i}}$ 在 $W_{i}$ 的所取基下的矩阵. 有时将 $A$ 记为 $A=A_1\oplus A_2\oplus\cdots\oplus A_s$.

---

> [!theorem] 幺正变换的不变子空间的正交补也是不变子空间 \label{th:orthocomofunitary}
> 
> 设 $\mathsf{H}$ 是内积空间，$U:\mathsf{H}\rightarrow \mathsf{H}$ 是幺正变换，$\mathsf{K}$ 是 $U$ 的不变子空间，则
> 
> 1. $U(\mathsf{K})= \mathsf{K}$
> 2. $\mathsf{K}^\perp$ 也是 $U$ 的不变子空间。

> [!proof]
> 幺正变换是单射，所以它在 $\mathsf{K}$ 上的限制 $U|_\mathsf{K}:\mathsf{K}\rightarrow \mathsf{K}$ 也是单射，根据线性变换的性质，$U|_\mathsf{K}$ 也是满射\footnote{第一同构定理 $V/\mathrm{ker}~f\cong \mathrm{im}~f$ 可以推论 $\mathrm{dim} V=\mathrm{dim} ~\mathrm{ker}~ f+ \mathrm{dim} ~\mathrm{im}~f$ 的推论。参见：[SE贴](https://math.stackexchange.com/questions/460422/invariant-subspace-and-orthogonal-complemen)t。}。任取 $|u\rangle\in \mathsf{K},|v\rangle\in \mathsf{K}^\perp$，有 $U^{-1}|u\rangle \in \mathsf{K}$，因此
> $$
> \langle u |U|v\rangle=\langle v |U^\dagger |u\rangle  =\langle v|U^{-1}|u\rangle=0
> $$
> 因此 $\mathsf{K}^\perp$ 也是 $U$-不变子空间。

---

> [!note]
> 设 $P$ 是 $\mathsf{K}$ 上的正交投影算符，则 $\mathsf{K}$ 是 $U$ 的不变子空间等价于 $QUP=0$，命题的第二点可以等价地表述为 $PUP=UP\implies PUP=PU$。

---

> [!theorem] 可对角化线性变换的不变子空间的直和分解 \label{th:direcsofinv}
> 
> 设 $A$ 是 $V$ 上的可对角化的线性变换，$\lambda_i$ 是所有互不相同的本征值，相应的本征子空间记为 $V_{\lambda_i}$，则 $W$ 是 $A$ 的不变子空间当且仅当 $W$ 有直和分解
> $$
> W= \bigoplus_{i} (W \cap V_{\lambda_i} )
> $$

> [!proof]
> 充分性显然。必要性的证明来自 \href{https://math.stackexchange.com/questions/62338/diagonalizable-transformation-restricted-to-an-invariant-subspace-is-diagonaliza}{SE贴}。设 $v_i$ 是 $A$ 的本征值 $\lambda_i$ 对应的本征态，$\lambda_i$ 之间互不相同 (如果相同的话直接合而为一就行)，任取 $w=\sum_i v_i\in W$，则 $ v_i\in W $，这是因为
> $$
> v_i=\left(\prod_{j \neq i} \frac{A-\lambda_j I}{\lambda_i-\lambda_j}\right)(w)
> $$
> 因此
> $$
> \begin{equation}
>     W=\bigoplus_{\lambda}\left(W \cap V_\lambda\right)
> \end{equation}
> $$

---

> [!theorem] Burnside 定理 (关于不变子空间) {\cite[Th.3.15]{farenick2001AlgebrasLinearTransformations}} \label{th:burnsidesinvspace}
> 
> 设 $V$ 是代数闭域上的线性空间，如果 $\mathfrak{A} \subseteq \mathfrak{L}(V)$ 是一个传递子代数，即任意 $u,v\in V$，$u$ 非零，都存在 $A\in \mathfrak{A}$，使得 $u=Av$，则 $\mathfrak{A}=\mathfrak{L}(V)$.

> [!note]
> 只要证明任意形如 $|e\rangle \langle f|$ 的元素都生活在 $\mathfrak{A}$ 中。

---

## 可对角化与 Jordan 标准形
参见 {\cite[Chap.7,8]{李忠华线代}}。  
设 $V$ 是 $\mathbb{F}$ 上的 $n$ 维线性空间, $\mathscr{A}: V \longrightarrow V$ 是 $V$ 上的线性变换. 如果 $\mathscr{A}$ 可对角化, 则有最小多项式
$$
d_{\mathscr{A}}(\lambda)=\left(\lambda-\lambda_{1}\right)\left(\lambda-\lambda_{2}\right) \cdots\left(\lambda-\lambda_{s}\right),
$$
其中 $\lambda_{1}, \lambda_{2}, \ldots, \lambda_{s} \in \mathbb{F}$ 互不相同. 此时, 特征多项式
$$
\varphi_{\mathscr{A}}(\lambda)=\left(\lambda-\lambda_{1}\right)^{m_{1}}\left(\lambda-\lambda_{2}\right)^{m_{2}} \cdots\left(\lambda-\lambda_{s}\right)^{m_{s}}, \quad\left(m_{i} \geqslant 1, m_{1}+m_{2}+\cdots+m_{s}=n\right);
$$
且 $V$ 分解为特征子空间的直和
$$
V=V_{\lambda_{1}} \oplus V_{\lambda_{2}} \oplus \cdots \oplus V_{\lambda_{s}},
$$
其中特征子空间
$$
V_{\lambda_{i}}=\left\{\alpha \in V \mid \mathscr{A}(\alpha)=\lambda_{i} \alpha\right\}=\operatorname{ker}\left(\mathscr{A}-\lambda_{i}\mathbb{I}\right)
$$
然而线性变换不一定可以对角化，特征子空间的直和不必等于 $V_i$，可能有 $d_i<m_i$。  
实际上，有下面的定理

> [!theorem] 可对角化的充要条件 {\cite[Th.7.39]{李忠华线代}}
> 
> 设 $\operatorname{dim} V=n, \mathscr{A}: V \rightarrow V$ 是线性变换, 设特征多项式
> $$
> \varphi_{\mathscr{A}}(\lambda)=\left(\lambda-\lambda_1\right)^{m_1}\left(\lambda-\lambda_2\right)^{m_2} \cdots\left(\lambda-\lambda_s\right)^{m_s} f(\lambda),
> $$
> 其中 $\lambda_1, \lambda_2, \ldots, \lambda_s \in \mathbb{F}$ 是 $\mathscr{A}$ 在 $\mathbb{F}$ 上所有两两互不相同的特征值， $f(\lambda) \in \mathbb{F}[\lambda]$ 是无一次因式的首一多项式. 记 $d_i=\operatorname{dim} V_{\lambda_i}$ 是 $\lambda_i$ 的几何重数($\lambda_i$ Jordan块的数量)，$m_i$ 是代数重数(另一个定义是所有 $\lambda_i$ Jordan 块的总维度)。 则下面命题等价
> 
> (i) $\mathscr{A}$ 可对角化;
> 
> (ii) $\mathscr{A}$ 有完全特征向量组(即存在 $V$ 的基, 使得每个基向量都是 $\mathscr{A}$ 的特征向量);
> 
> (iii) $V=V_{\lambda_1} \oplus V_{\lambda_2} \oplus \cdots \oplus V_{\lambda_s}$
> 
> (iv) $f(\lambda)=1$, 且对 $i=1,2, \ldots, s$ 有 $d_i=m_i ; \quad$ (几何重数 $=$ 代数重数)
> 
> (v) $f(\lambda)=1$, 且对 $i=1,2, \ldots, s$ 和 $m_i>1$ 有 $d_i=m_i$;
> 
> (vi) 最小多项式 $d_{\mathscr{A}}(\lambda)$ 在 $\mathbb{F}$ 上分解为互不相同的一次因式之积, 即
> $$
> d_{\mathscr{A}}(\lambda)=\left(\lambda-\lambda_1\right)\left(\lambda-\lambda_2\right) \cdots\left(\lambda-\lambda_s\right) \text {. }
> $$

---

### 根子空间
$\mathbb{F}$ 上对特征多项式和最小多项式做不可约分解。
$$
\begin{aligned}
\varphi_{\mathscr{A}}(\lambda) & =p_{1}^{m_{1}}(\lambda) p_{2}^{m_{2}}(\lambda) \cdots p_{s}^{m_{s}}(\lambda) \\
d_{\mathscr{A}}(\lambda) & =p_{1}^{k_{1}}(\lambda) p_{2}^{k_{2}}(\lambda) \cdots p_{s}^{k_{s}}(\lambda)
\end{aligned}
$$
注意到任取 $i$，$\mathrm{ker}(p_i(\mathscr{A}))\neq 0$，否则 $d_\mathscr{A}$ 就不是最小多项式了。  
定义 $\mathscr{A}$ 关于 $p_i$ 的\mydef{根子空间} $W_i$
$$
W_{i} \equiv\bigcup_{m=1}^{\infty} W_{i}^{(m)}=\bigcup_{m=1}^{\infty} \operatorname{ker}\left(p_{i}^{m}(\mathscr{A})\right)=\left\{\alpha \in V \mid p_{i}^{m}(\mathscr{A})(\alpha)=0, \exists m \in \mathbb{N}\right\} \subset V
$$

> [!theorem] 根子空间分解定理
> 
> $$
> V=W_{1} \oplus W_{2} \oplus \cdots \oplus W_{s}
> $$
> $$
> \varphi_{\left.\mathscr{A}\right|_{W_{i}}}(\lambda)=p_{i}^{m_{i}}(\lambda), \quad d_{\left.\mathscr{A}\right|_{W_{i}}}(\lambda)=p_{i}^{k_{i}}(\lambda)
> $$
> $$
> \operatorname{dim} W_{i}=\operatorname{deg}\left(p_{i}^{m_{i}}(\lambda)\right)=m_{i} \operatorname{deg}\left(p_{i}(\lambda)\right)
> $$

---

> [!definition] 循环子空间
> 
> 设 $\alpha \in V$, 由 $\alpha$ 生成的(相对于 $\mathscr{A}$ 的) \mydef{循环子空间} $C_\mathscr{A}(\alpha)$ 定义为包含 $\alpha$ 的 $\mathscr{A}$ 的最小的不变子空间。

> [!note]
> 等价刻画
> $$
> \begin{aligned}
> C_\mathscr{A}(\alpha) & =\operatorname{Span}\left(\left\{\alpha, \mathscr{A}(\alpha), \mathscr{A}^{2}(\alpha), \ldots, \mathscr{A}^{m}(\alpha), \ldots,\right\}\right) \\
> & =\{f(\mathscr{A})(\alpha) \mid f(\lambda) \in \mathbb{F}[\lambda]\} .
> \end{aligned}
> $$

> [!theorem] 循环分解定理
> 
> 设 $\mathscr{A}: V \longrightarrow V$ 是线性变换, 其中 $\operatorname{dim} V=n$, 则
> 
> (1) (分解存在性) 存在 $0 \neq \alpha_{1}, \alpha_{2}, \ldots, \alpha_{t} \in V$, 使得
> $$
> V=C\left(\alpha_{1}\right) \oplus C\left(\alpha_{2}\right) \oplus \cdots \oplus C\left(\alpha_{t}\right)
> $$
> $$
> d_{\alpha_{1}}(\lambda)\left|d_{\alpha_{2}}(\lambda)\right| \cdots \mid d_{\alpha_{t}}(\lambda)
> $$
> (2) (分解唯一性) 循环分解中循环子空间的个数和 $\mathscr{A}$ 在各循环子空间的限制的最小多项式唯一. 即如果还有循环分解 $V=C\left(\beta_{1}\right) \oplus C\left(\beta_{2}\right) \oplus \cdots \oplus C\left(\beta_{l}\right)$, 其中 $0 \neq \beta_{1}, \beta_{2}, \ldots, \beta_{l} \in V$, 且有 $d_{\beta_{1}}(\lambda)\left|d_{\beta_{2}}(\lambda)\right| \cdots \mid d_{\beta_{l}}(\lambda)$, 那么 $t=l$,且 $d_{\alpha_{i}}(\lambda)=d_{\beta_{i}}(\lambda), i=1,2, \ldots, t$。

> [!note]
> 根据唯一性，记
> $$
> d_{i}(\lambda)=d_{\alpha_{i}}(\lambda) \in \mathbb{F}[\lambda], \quad(i=1,2, \ldots, t)
> $$
> 则 $d_{1}(\lambda)\left|d_{2}(\lambda)\right| \cdots \mid d_{t}(\lambda)$, 且它们由 $\mathscr{A}$ 唯一确定. 称 $d_{1}(\lambda), d_{2}(\lambda), \ldots, d_{t}(\lambda)$ 为 $\mathscr{A}$ 的\mydef{不变因子}。

---

## 半单代数
这部分不是泛函的内容，和冯诺依曼代数、$C^*$-代数非常密切，学习相关内容的目的是证明 $C^*$-代数的一个结构定理，这个定理启发了子系统码的定义。另外，半单代数的理论在群表示论中也有重要应用，例如定理 \ref{th:wedartindecomp}。主要参考 {\cite[Cha.4]{farenick2001AlgebrasLinearTransformations}}。因此本章节是量子力学、量子纠错和群表示论等相关章节的前置知识。

### 幂零代数
主要参考 {\cite[Sec.4.1]{farenick2001AlgebrasLinearTransformations}}。代数的子集的积
$$
\mathcal{S}_1 \cdot \ldots \cdot \mathcal{S}_n=\left\{\sum_{i=1}^m s_1^{(i)} s_2^{(i)} \cdots s_n^{(i)}: m \geqslant 1, s_j^{(i)} \in \mathcal{S}_j \text { for all } i, j\right\} .
$$

> [!theorem] 代数幂零当且仅当每个元素幂零 {\cite[Prop.4.2]{farenick2001AlgebrasLinearTransformations}}
> 
> （定理正文留空）

含有幺元的代数不可能是幂零的。

> [!definition] 代数的 Nil Radical 和代数元的 Properly Nilpotent
> 
> $\mathfrak{A}$ 是有限维代数，存在唯一的幂零理想 $\mathfrak{R}$，它是最大的，包含了 $\mathfrak{A}$ 中所有的幂零理想（待补充），称为 $ \mathfrak{A} $ 的\mydef{nil radical}，不致混淆时称为 radical，记为 $\mathrm{rad}\mathfrak{A}$。
> 
> 代数 $\mathcal{A}$ 中的元素 $a$ 称为\mydef{properly nilpotent}，如果 $a \mathfrak{A}$ 中的每个元素都是幂零的。

> [!theorem] 有限维代数的 Radical 的刻画
> 
> 有限维代数的 radical 正是所有 properly nilpotent 元素的集合。

> [!proof]
> 设 $\mathfrak{B}$ 是有限维代数 $\mathfrak{A}$ 的 properly nilpotent 元素的集合，只要证明 $\mathfrak{B}$ 是一个幂零理想，就有 $\mathfrak{B}\subset  \mathrm{rad}\mathfrak{A}$，反之，设 $z\in \mathrm{rad} \mathfrak{A}$，根据理想的定义，则对任意的 $a\in \mathfrak{A}$，$z a\in \mathrm{rad} \mathfrak{A} $ 是幂零的，根據 $\mathfrak{B}$ 的定义，$ z\in \mathfrak{B} $，于是 $  \mathrm{rad} \mathfrak{A}\subset\mathfrak{B} $。

> [!theorem] 有限维非幂零代数存在一个非零幂等元
> 
> （定理正文留空）

> [!definition] 半单代数
> 
> 非零有限维代数称为\mydef{半单}，如果 $\mathrm{rad} \mathfrak{A}=\{0\}$。

> [!note]
> Lie 代数的 radical 定义与代数的 radical 定义不同，而 Lie 代数的半单是用 Lie 代数的 radical 为零来定义的，因此 Lie 代数的半单与代数的半单不同，注意区分。

> [!theorem] 半单代数含有幺元
> 
> 设有限维非零 Lie 代数 $\mathfrak{A}$ 是半单的，即最大幂零理想为零， $ \mathrm{rad}\mathfrak{A}=\{0\}$，则 $\mathfrak{A}$ 是一个含幺代数，即存在一个乘法单位元。

> [!corollary]
> 所有有限维单代数都是含幺代数。

> [!proof]
> 单代数意味着 $\mathfrak{A}^2\neq\{0\}$，以及真子理想只有 $\{0\}$，如果 $\mathfrak{A}$ 本身不是幂零的，那么 $\mathfrak{A}$ 的最大幂零理想就是 $\{0\}$，因此 $\mathfrak{A}$ 半单，因此含有幺元。实际上 $\mathfrak{A}^2$ 是理想，因此只能有 $\mathfrak{A}^2=\mathfrak{A} $，因此 $\mathfrak{A}^k\neq \{0\}$，$\mathfrak{A}$ 不是幂零的。

> [!theorem] 半单代数的结构 \label{th:structureofsimalge}
> 
> 任何有限维单代数都同构于单代数的笛卡尔积。特别地，如果
> $$
> \mathfrak{A}=\mathfrak{J}_0 \supset \mathfrak{J}_1 \supset \cdots \supset \mathfrak{J}_n \supset \mathfrak{J}_{n+1}=\{0\}
> $$
> 是有限维半单代数 $\mathfrak{A}$ 的合成列(后一个是前一个的最大(真)理想)，那么
> $$
> \mathfrak{A} \cong\left(\mathfrak{J}_n / \mathfrak{J}_{n+1}\right) \times\left(\mathfrak{J}_{n-1} / \mathfrak{J}_n\right) \times \cdots \times\left(\mathfrak{J}_0 / \mathfrak{J}_1\right),
> $$
> 其中 $k=1, \ldots, n+1$，代数 $\mathfrak{J}_{k-1} / \mathfrak{J}_k$ 是单的，且 $\mathfrak{J}_{k-1} / \mathfrak{J}_k$ 与 $\mathfrak{A}$ 的理想同构。

> [!note]
> 比较定理 \ref{th:inequiirrpnum}。

> [!proposition] 除环上的右模的同态的矩阵
> 
> 设 $M$ 是除环 $\mathfrak{D}$ 上的有限生成右模，则 $M$ 是自由模且存在 $n \in \mathbb{Z}^{+}$ 使得 $M$ 上的模同态 $\mathrm{Hom}_{\mathfrak{D}}(M, M)$ 同构于 $M_n(\mathfrak{D})$，即以 $\mathfrak{D}$ 中的元素为元素的 $n \times n$ 矩阵。

> [!proposition]
> 
> 设 $R$ 是含幺环，其中幂等元 $e \in R$ 满足 $R e R=R$，则
> 
> 1. $M=Re$ 是右 $\mathfrak{D}$-模，其中 $\mathfrak{D}$ 是环 $ eRe$，
> 
> 2. 模同态构成的环 ${ \mathrm{Hom}}_{\mathfrak{D}}(M, M)$ 同构于 $R$。

> [!theorem] 单环的结构 \label{th:wedartindecomp1}
> 
> 设有限维代数 $\mathfrak{A}$ 是单的，如果 $\mathfrak{G}$ 是 $\mathfrak{A}$ 的极小左理想，则存在幂等元 $e \in \mathfrak{G}$ 满足
> 
> 1. $\mathfrak{G}=\mathfrak{A} e$;
> 
> 2. $\mathfrak{A} e \mathfrak{A}=\mathfrak{A}$;
> 
> 3. $\mathfrak{D}\equiv  e\mathfrak{A} e$ 是除环，且 $e$ 是 $\mathfrak{D}$ 的乘法单位元；
> 
> 4. $\mathfrak{A} \cong \mathrm{Hom}_{\mathfrak{D} }(\mathfrak{G},\mathfrak{G}) \cong M_n(\mathfrak{D})$，其中
> $$
> n=\frac{\operatorname{dim}_{\mathbb{F}} \mathfrak{G}}{\operatorname{dim}_{\mathbb{F}}(\mathfrak{D})} .
> $$

> [!note]
> 与定理 \ref{th:wedartindecomp} 相同。是否存在环同态的集合 $\mathrm{Hom}_\mathcal{A}(\mathfrak{G},\mathfrak{G})\cong e \mathfrak{A}e,~\theta_a \mapsto eae$，其中 $\theta_a(g)=ag$。

---

## 张量积
线性空间的张量积空间是笛卡尔积除以双线性关系。基于线性空间的张量积，我们可以定义线性映射的张量积。一般的泛性质参见：第 \ref{ssec:universalproperty} 节。

> [!definition] 线性映射的张量积
> 
> $$
> \mathscr{A}_{1} \otimes \mathscr{A}_{2}: V_{1} \otimes V_{2} \longrightarrow W_{1} \otimes W_{2},
> $$
> 使得
> $$
> \left(\mathscr{A}_{1} \otimes \mathscr{A}_{2}\right)\left(\alpha_{1} \otimes \alpha_{2}\right)=\mathscr{A}_{1}\left(\alpha_{1}\right) \otimes \mathscr{A}_{2}\left(\alpha_{2}\right), \quad \forall \alpha_{1} \in V_{1}, \forall \alpha_{2} \in V_{2} .
> $$
> 称 $\mathscr{A}_{1} \otimes \mathscr{A}_{2}$ 为线性映射 $\mathscr{A}_{1}$ 和 $\mathscr{A}_{2}$ 的\mydef{张量积}。

下面罗列一些关于矩阵张量积（克罗内克积）的性质 {\cite[Sec.7.12]{李忠华线代}}
 
> [!note]
> - 设 $A=\left(a_{i j}\right)_{m \times n} \in \mathbb{F}^{m \times n}$ 和矩阵 $B=\left(b_{i j}\right)_{p \times q} \in \mathbb{F}^{p \times q}$，则
> $$
> A \otimes B \equiv\left(\begin{array}{cccc}a_{11} B & a_{12} B & \cdots & a_{1 n} B \\ a_{21} B & a_{22} B & \cdots & a_{2 n} B \\ \vdots & \vdots & & \vdots \\ a_{m 1} B & a_{m 2} B & \cdots & a_{m n} B\end{array}\right) \in \mathbb{F}^{m p \times n q}
> $$
> - 基本运算性质
>   - $A \otimes(B+C)=A \otimes B+A \otimes C,(B+C) \otimes A=B \otimes A+C \otimes A$;
>   - $A \otimes(k B)=(k A) \otimes B=k A \otimes B$;
>   - $(A \otimes B) \otimes C=A \otimes(B \otimes C)$;
>   - $(A \otimes B)(C \otimes D)=(A C) \otimes(B D)$;
>   - 设 $A, B$ 为可逆方阵, 则 $A \otimes B$ 也可逆, 且 $(A \otimes B)^{-1}=A^{-1} \otimes B^{-1}$.
> - $|A \otimes B|=|A|^{m}|B|^{n}$
> - $\operatorname{Tr}(A \otimes B)=\operatorname{Tr}(A) \operatorname{Tr}(B)$
> - 设 $A \in \mathbb{F}^{n \times n}$ 和 $B \in \mathbb{F}^{m \times m}$ 的复特征值分别是 $\lambda_{1}, \lambda_{2}, \ldots, \lambda_{n}$ 和 $\mu_{1}, \mu_{2}, \ldots, \mu_{m}$，则
>   - $A \otimes B$ 的复特征值是 $\lambda_{i} \mu_{j}, \quad 1 \leqslant i \leqslant n, 1 \leqslant j \leqslant m$
>   - $A \otimes \mathbb{I}_{m}+\mathbb{I}_{n} \otimes B$ 的复特征值是 $\lambda_{i}+\mu_{j}, \quad 1 \leqslant i \leqslant n, 1 \leqslant j \leqslant m$
> 
> 思考：$SU(n)\times SU(n)$ 和某种张量积拓扑下的 $SU(n)\otimes SU(n)$ 作为拓扑群是否是同胚。$(u,v)\mapsto u\otimes v$ 是一个双射，但不确定是否为同胚。

判断一个算符能否关于给定的张量积结构写成两个算符的张量积形式的方法是使用奇异值分解，数值程序例子，参见：单个系统和两个系统之间的相似变换.nb。

# 松散的内容

[Trace inequality - Wikiwand](https://www.wikiwand.com/en/Trace_inequality)

冯琦的书？
[Jordan–Chevalley decomposition - Wikiwand](https://www.wikiwand.com/en/Jordan%E2%80%93Chevalley_decomposition)

关于两个成比例的线性映射
- [$\ker T\subset \ker S\Rightarrow S=rT$ when $S$ and $T$ are linear functionals - Mathematics Stack Exchange](https://math.stackexchange.com/questions/60460/ker-t-subset-ker-s-rightarrow-s-rt-when-s-and-t-are-linear-functionals)
- [How to prove that two non-zero linear functionals defined on the same vector space and having the same null-space are proportional? - Mathematics Stack Exchange](https://math.stackexchange.com/questions/311820/how-to-prove-that-two-non-zero-linear-functionals-defined-on-the-same-vector-spa)

矩阵和自己的转置是相似的
- [[[3 线性代数\|linear algebra]] - Matrix is conjugate to its own transpose - Mathematics Stack Exchange](https://math.stackexchange.com/questions/62497/matrix-is-conjugate-to-its-own-transpose)

可能和泛函有关的不等式（通常用于证明函数的连续性等），张量积的算符模小于等于各自的模相乘
- [functional analysis - Norm of a tensor product of operators - Mathematics Stack Exchange](https://math.stackexchange.com/questions/349585/norm-of-a-tensor-product-of-operators)

- 有限域上的矩阵处理
	- [MeatAxe - Computing with Modular Representations.](https://www.math.rwth-aachen.de/~MTX/)

- 求解一堆矩阵的共同不变子空间
	- [linear algebra - Computing Invariant Subspaces of Matrix Groups - Mathematics Stack Exchange ~ 线性代数 - 计算矩阵群的不变子空间](https://math.stackexchange.com/questions/380730/computing-invariant-subspaces-of-matrix-groups/615802#615802)
	- 