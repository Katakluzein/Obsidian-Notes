---
{"dg-publish":true,"permalink":"/1 Stories of Bizzo's Life/5 量子科学和量子技术/27 量子算法/"}
---



> [!quote] 
>  Quantum computation is... a distinctively new way of harnessing nature... It will be the first technology that allows useful tasks to be performed in collaboration between parallel universes. 
>  —— David Deutsch

> [!quote] 

> [!abstract] Contents
> - 算法

在量子计算研究初期，对于量子计算的质疑主要集中在量子系统的退相干性和噪声对大规模量子系统的破坏性影响。 量子纠错解错码、量子容错计算等方面的研究逐步打消了这方面的担忧。量子阈值定理给出了确定的噪声阈值——只要计算过程中每个部件的噪声控制在阈值之下，任意大规模的量子计算都能实现。 这在理论上铺平了量子计算发展的道路, 量子计算的实现看起只是一个工程技术问题。\par 

课程讲义，参见：第一章 量子计算简介.nb，第四章 量子线路.nb。

## 基本公式
基本公式在量子力学相关章节。
## 量子算法
在计算机理论方面，量子计算能否计算经典计算机无法计算的问题，或者能否在某些问题上超越经典计算机的计算效率，都是量子计算研究的重中之重。主要的量子算法包括：
> [!abstract] Contents
> - 基于量子Fourier变换的算法，Deutsch-Jozsa算法、Shor算法、离散对数算法。
> - 量子搜索算法。
> - 量子模拟。

### Deutsch算法
Deutsch能够仅仅通过一步计算就得到关于函数$f$的整体性质$f(0)\oplus f(1)$，体现了量子算法的并行性\footnote{参见：Deutsch算法.nb和Nielsen 第一章.nb}。这个算法启示我们，如果经典算法为了完成指定的任务需要获取额外的信息量，那么量子算法就有可能以更少的计算完成相同的任务。

\begin{figure}[htbp]
 \centering
 \includegraphics[width=0.4\textwidth]{image//deutschAlgo.pdf}
 \caption{  Deutsch算法，设$f(x)=x$}
 \label{  }
\end{figure}

### Shor算法
Shor算法解决大数分解问题。大数分解的困难性保证了RSA(Rivest-Shamir-Adleman)公钥密码通信的安全性。通用数域筛 (GNFS) 是已知用于分解大于 $10^{100}$的整数的最高效的经典算法。
$$
\exp \left(\left(\sqrt[3]{\frac{64}{9}}+o(1)\right)(\ln n)^{\frac{1}{3}}(\ln \ln n)^{\frac{2}{3}}\right)
$$
Shor算法的步骤如下

\begin{enumerate}[(1)]
	\item 输入$N$，$N$是奇数且至少有两个质因子。
	\item   任选 $y<N$, 并验证 $y$ 与 $N$ 互质，即计算$\mathrm{gcd}(y,N)$是否平凡；
	\item {\color{red}用量子算法求 $F_{N}(a)=y^{a}\mathrm{mod} N$ 的周期 $r$}
	(等价于求阶问题：求 $r$, 使 $y^{r} \equiv 1 \bmod N$, 即 $y ^{r}$ 除以 $N$ 余数为 1);
	\item  若 $r$ 为奇数则返回(1), 否则继续；
	\item  计算$n_{1}=\operatorname{gcd}\left(y^{r / 2}-1, N\right)$ ，若$n_1=N$，则返回(1)，若$n_1<N$，则计算$n_{2}=\operatorname{gcd}\left(y^{r / 2}+1,N\right)$
	\item  输出 $n_{1}, n_{2}$ 
\end{enumerate}

关于步骤(4)和(5)可以做一些说明。如果$r$是奇数，$r/2$不再是整数，显然不能再往下走，必须重新回到第一步。如果有$y^{r} \equiv 1 \bmod N$ 且$r$为偶数，那么$N|(y^r-1)$，即$N|(y^{r/2}-1)(y^{r/2}+1)$，计算$n_1=\operatorname{gcd}\left(y^{r / 2}-1, N\right)$，如果$n_1=1(\Leftrightarrow y^{r / 2}-1\text{与}N\text{互质})$，那么立即有$N|(y^{r/2}+1)(\Leftrightarrow y^{r / 2} \equiv -1 \bmod N)$，进而$\mathrm{gcd}(N,y^{r / 2}-1)=N$，该算法无法找到非平凡因子，必须返回第一步重新求$r$。如果$n_1$非平凡，那么$n_1$就是所求。类似地可以对$n_{2}=\operatorname{gcd}\left(y^{r / 2}+1,N\right)$做讨论。总的来说，只有当$N$既不整除$\left(y^{r / 2}+1\right)$也不整除$\left(y^{r / 2}-1\right)$时我们才能得到预期的结果。

\begin{figure}[htbp]
 \centering
 \includegraphics[width=0.6\textwidth]{image//2023-10-20-17-31-51.png}
 \caption{ RSA }
 
\end{figure}

介绍Shor算法前，补充量子Fourier变换。类似经典傅里叶变换，量子傅里叶变换$\mathrm{QFT}$可以写成
$$
|j\rangle \longrightarrow \mathrm{QFT}|j\rangle = \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1} \mathrm{e}^{2 \pi \mathrm{i} j k / N}|k\rangle=\frac{1}{2^{n / 2}} \bigotimes_{l=1}^{n}\left(|0\rangle+\mathrm{e}^{2 \pi \mathrm{i} j 2^{-l}}|1\rangle\right)
$$
其中$N=2^n$，上式右边的因式分解能帮助我们利用简单的门逻辑门设计Fourier变换线路。利用量子Fourier逆变换，可以对幺正矩阵的本征值进行估计。大家喜闻乐见的算符形式是
$$
\mathrm{QFT}:=\frac{1}{\sqrt{N}} \sum_{j,k=0}^{N-1} \exp \left(2 \pi \mathrm{i} \frac{k j}{N}\right)|k\rangle\langle j|
$$
设$\omega_{n}:=\exp \left(\frac{2 \pi \mathrm{i}}{2^{n}}\right)$
，则QFT的矩阵形式为
$$
\text{QFT}=\frac{1}{\sqrt{2^{n}}}\left(\begin{array}{cccc}1 & 1 & \cdots & 1 \\ 1 & \omega_{n} & \cdots & \omega_{n}^{2^{n}-1} \\ \vdots & \vdots & \ddots & \vdots \\ 1 & \omega_{n}^{2^{n}-1} & \cdots & \omega_{n}^{\left(2^{n}-1\right)^{2}}\end{array}\right)
$$
它是一个特殊的范德蒙德矩阵
$$
\text{QFT}=D_{ k}=\left(\begin{array}{cccc}1 & 1 & \ldots & 1 \\ x_{1} & x_{2} & \ldots & x_{ k} \\ \vdots & \vdots & & \vdots \\ x_{1}^{ k-1} & x_{2}^{ k-1} & \ldots & x_{ k}^{ k-1}\end{array}\right)
$$
其中，$x_{p}=\omega_{n}^{p-1},~p=1,\cdots,k=2^n$。
下面介绍求阶的量子算法。
\begin{enumerate}[(1)]
	\item 取初态为
$$
\left(\frac{1}{\sqrt{q}}
	 \sum_{a=0}^{q-1}|a\rangle\right)
	 \otimes\left(|0\rangle^{\otimes L}\right)
$$
其中$N^2<2^L=q<2N^2$
	\item 设存在幺正变换$U$满足$U|j\rangle|k\rangle=|j\rangle\left|k+x^{j} \bmod N\right\rangle,~j,k=0,\ldots,q,$，将它作用在初态上，有
$$
U\left(\left(\frac{1}{\sqrt{q}} \sum_{a=0}^{q-1}|a\rangle\right) \otimes\left(|0\rangle^{\otimes L}\right)\right)= \frac{1}{\sqrt{q}} \sum_{a=0}^{q-1}|a\rangle \otimes\left|y^{a} \bmod N\right\rangle
$$
\item 对第一个寄存器中的比特做反(到底是反变换还是正变换？)Fourier变换
$$
\begin{aligned} &\mathrm{QFT}^\text{}\left(\frac{1}{\sqrt{q}} \sum_{a=0}^{q-1}|a\rangle \right) \otimes\left|y^{a} \bmod N\right\rangle \\ =&\frac{1}{q} \sum_{k=0}^{q-1}\sum_{a=0}^{q-1} e^{2 \pi i k a / q}|k\rangle \otimes\left|y^{a} \bmod N\right\rangle \\ =&\frac{1}{q} \sum_{k=0}^{q-1} \sum_{m=0}^{A} \sum_{l=0}^{r-1} e^{2 \pi i k(m r+l) / q}|k\rangle \otimes\left|y^{l} \bmod N\right\rangle \\ =&\frac{1}{q} \sum_{l=0}^{r-1}\left(\sum_{k, m} e^{2 \pi i k(m r+l) / q}|k\rangle\right) \otimes\left|y^{l} \bmod N\right\rangle\end{aligned}
$$
\item （隐含）测量并舍弃第二个寄存器所得的态为，
$$
\frac{1}{\sqrt{q(A+1)}}  \sum_{k, m} e^{2 \pi i k(m r+l) / q}|k\rangle
$$
注意上式的归一化因子不是取决于$l$的求和项数$r$，而是取决于$k,m$的求和项数$q(A+1)$。
	\item 在第一个寄存器的计算基下进行测量，测得结果为$k$的概率为
$$
\Pr(k)=\left|\frac{1}{\sqrt{q(A+1)}} \sum_{m=1}^{A} e^{2 \pi i k(m r+l) / q}\right|^{2}=\frac{  e^{- {2 i \pi  (A-1) k r}/{q}} \left(-1+e^{ {2 i \pi  A k r}/{q}}\right)^2}{q(A+1) \left(-1+e^{ {2 i \pi  k r}/{q}}\right)^2}
$$
\item （待补充）高概率的结果是哪些，如何从中提取出$r$。
\end{enumerate}

### 隐藏子群问题HSP

> [!definition] 子群的隐藏
> - $G$是一个群，$H$是其子群，$X$是一个集合，函数$f:G\rightarrow X$，若任取$g_1,g_2\in G$，有
$$
f(g_1)=f(g_2)\Leftrightarrow g_1H=g_2H
$$
>   则称函数$f$**隐藏**了子群$H$。

> [!note]
> - 用群作用的观点来看，一个陪集就是$H$作用在$G$上产生的一条轨道。对于被$f$隐藏的子群$H$，两个群元的函数值相等等价于其关于$H$的陪集相同，也就是说，两个群元的函数值相等等价于他们\myemph{产生相同的轨道}。

> [!example]
> - $f$隐藏了$H$的例子：
>
$$
\begin{array}{l}G=\mathbb{Z}_{6}=\{0,1,2,3,4,5\} \\ H=\langle 2\rangle =\mathbb{Z}_{3}=\{0,2,4\} \\ {[0]=0+H=\{0,2,4\}=[2]=[4]} \\ {[1]=1+H=\{1,3,5\}=[3]=[5]} \\ f(0)=f(2)=f(4) \neq f(1)=f(3)=f(5)\end{array}
$$
考虑循环群的子群[[lomont2004HiddenSubgroupProblem\|lomont2004HiddenSubgroupProblem]]，给定正整数$N$，$G=\left\langle\mathbb{Z}_{N},+\right\rangle$是模$N$加法群，$f:G\rightarrow X$隐藏了子群$H=\langle d\rangle=\{|0\rangle,|d\rangle,|2 d\rangle, \ldots,|(M-1) d\rangle\}$，$|G|=N,|H|=M,d=N/M$。我们可以执行黑箱幺正变换
$$
U_f:|x\rangle|y\rangle \rightarrow|x\rangle|f(x) \oplus y\rangle
$$
具体算法如下
\begin{itemize}
	\item 将两个寄存器初始化到
$$
|0\rangle|0\rangle
$$
\item 第一个寄存器做成均匀叠加，得到
$$
\frac{1}{\sqrt{N}} \sum_{j=0}^{N-1}|j\rangle|0\rangle
$$
\item 作用一次$U_f$，
$$
\frac{1}{\sqrt{N}} \sum_{j=0}^{N-1}|j\rangle|f(j)\rangle
$$
\item 测量第二寄存器得到$|f(j_0)\rangle$，测得结果后舍弃第二寄存器，此时第一寄存器会仅剩下$j_0+H$的中的态的均匀叠加，
$$
|j_0+H\rangle\equiv \frac{1}{\sqrt{M}} \sum_{h \in H}\left|j_{0}+h\right\rangle=\frac{1}{\sqrt{M}} \sum_{s=0}^{M-1}\left|j_{0}+s d\right\rangle
$$
\item 对第一寄存器做傅里叶变换，只有$M=|H|$的整数倍存活下来，
$$
\mathrm{QFT}\frac{1}{\sqrt{M}} \sum_{s=0}^{M-1}\left|j_{0}+s d\right\rangle=\frac{1}{\sqrt{M}} \sum_{s} \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1} e^{\frac{2 \pi i\left(j_{0}+s d\right) k}{N}}|k\rangle=\frac{1}{\sqrt{d}} \sum_{t=0}^{d-1} e^{\frac{2 \pi i j_{0} t M}{N}}|t M\rangle
$$
\item 测量第一寄存器，得到$M$的整数倍的态的均匀分布。重复上述步骤若干次，得到$t_1M,\ldots, t_kM,~1\leqslant t_i<d$，用辗转相除法(欧几里得算法)确定这些测量结果的最大公约数$M$。
	成功概率（[[lomont2004HiddenSubgroupProblem\|lomont2004HiddenSubgroupProblem]] Apdx.E）
$$
\operatorname{Pr}\left(\operatorname{gcd}\left(t_{1}, t_{2}, \ldots, t_{k}\right)=1\right) \geqslant 1-\left(\frac{1}{2}\right)^{k / 2}
$$
\end{itemize}

### 实现量子加速的算法

#### **像Shor算法这样成功的其他量子算法**

是的，除了Shor算法，还有其他几个重要的量子算法，它们同样利用了问题的特殊结构，在 `NP ∩ co-NP` 或其他具有相似特性的复杂性类中取得了指数级或超多项式的加速。

这些成功的算法，几乎都围绕着一个核心的、更广义的问题框架：**隐子群问题 (Hidden Subgroup Problem, HSP)**。

**隐子群问题 (HSP)** 是一个统一的框架，Shor算法是它的一个特例。它的目标是：给定一个群 `G` 和一个函数 `f`，这个函数 `f` 在一个未知的子群 `H` 的陪集上是常数。你的任务是找出这个“隐藏”的子群 `H`。

Shor算法的成功之处在于，它利用**量子傅里叶变换 (QFT)** 高效地解决了**阿贝尔群（Abelian Groups，即群内元素满足交换律）**上的HSP。

以下是其他几个成功的例子：

1.  **离散对数问题 (Discrete Logarithm Problem)**
    *   **问题**：给定素数 `p` 和生成元 `g`，以及一个数 `y`，找到 `x` 使得 `g^x ≡ y (mod p)`。这是许多公钥密码学（如Diffie-Hellman密钥交换）的基础。
    *   **量子算法**：Shor的算法框架同样适用，通过QFT解决。
    *   **复杂性类**：与大数分解类似，也在 `NP ∩ co-NP` 的“边缘”，被认为不是NP完全问题。
    *   **“秘诀”**：同样是利用了模算术下隐藏的**周期性结构**。

2.  **佩尔方程 (Pell's Equation) 与主理想问题 (Principal Ideal Problem)**
    *   **问题**：这些是来自代数数论的更复杂的问题。例如，佩尔方程是寻找方程 `x² - ny² = 1` 的整数解。
    *   **量子算法**：由Hallgren在2007年提出。它推广了Shor算法的思想，能够解决更复杂的代数结构（数域的单位群）中的HSP，这些结构不再是简单的循环群。
    *   **意义**：这表明QFT的威力**不仅限于简单的周期性**，还可以用来揭示更广义的代数结构。

3.  **量子模拟 (Quantum Simulation)**
    *   **问题**：计算和预测分子、材料或其他量子力学系统的行为。经典计算机模拟这些系统时，所需资源会随系统规模指数级增长。
    *   **量子算法**：这是量子计算最原生的应用之一。理查德·费曼最初提出量子计算机的构想，就是为了模拟量子系统。量子计算机本身就是一个可控的量子系统，因此它能**自然地、高效地**模拟其他量子系统的演化。
    *   **复杂性类**：这个问题属于 **BQP** (有界错误量子多项式时间)，但被认为不属于 `P`。
    *   **“秘诀”**：利用了“**以量子制量子**”的原理，问题的结构（量子力学）与计算机的结构完美匹配。

4.  **求解线性方程组 (HHL Algorithm)**
    *   **问题**：求解线性方程组 `Ax = b`。
    *   **量子算法**：Harrow, Hassidim, 和 Lloyd 提出的HHL算法能在特定条件下提供指数级加速。
    *   **重要限制**：这个算法有非常严格的适用条件（例如，矩阵A是稀疏的，我们需要准备特定的量子态，且最终得到的是关于解向量x的某种期望值，而不是x本身）。
    *   **“秘诀”**：利用了**量子相位估计**来高效地计算矩阵的本征值，从而实现矩阵求逆。

#### **结论：成功的“秘诀”是什么？**

这些成功的量子算法有一个共同点，也是它们与NP完全问题的根本区别：

**它们所解决的问题都具有深刻的、可被量子计算机利用的“隐藏结构”。**

*   对于Shor算法及其推广，这个结构是**代数周期性**，量子傅里叶变换是打开这把锁的钥匙。
*   对于量子模拟，这个结构就是**量子力学本身的演化规律**。
*   对于HHL，这个结构是**线性代数的内在性质**。

而NP完全问题（如旅行商、3-SAT）的“困难”之处，恰恰在于它们被认为是**“无结构的”或“混沌的”**。它们的困难源于局部约束的组合爆炸，缺乏那种可以被量子傅里叶变换等工具一举破解的全局性、规律性的结构。

因此，量子计算机并非万能的“神谕”，它更像是一位**“结构发现大师”**。对于那些拥有特殊数学结构的问题，它能展现出惊人的力量；而对于那些看似随机和组合性的难题，它目前能提供的帮助，主要还停留在Grover算法的平方加速上。

### 量子搜索算法
Householder变换
$$
\begin{aligned} H:|x\rangle  & \mapsto|x\rangle-2\langle\psi | x\rangle|\psi\rangle \\ & =(\mathbb{1}-2|\psi\rangle\langle\psi|)|x\rangle\end{aligned}
$$
## 魔法态 Magic State
魔法态的刻画[[gu2023little\|gu2023little]]：
> [!abstract] Contents
> - 非 Clifford 性质：魔法态不是 Clifford 群的元素，这意味着它们不能仅通过 Clifford 门（如单量子比特泡利门和 CNOT 门）来制备。这使得它们在量子计算中具有非平凡的特性，因为它们可以用于实现非 Clifford 量子门，如 T 门。
> - 高魔法值：魔法态的魔法值（magic value）通常很高，这意味着它们在量子系统中的非经典性程度较高。魔法值是衡量量子态非 Clifford 资源的量度，与量子态的非稳定子集（nonstabilizer subspace）的大小有关。
> - 蒸馏和合成：在量子错误校正中，魔法态可以通过特定的协议（如魔法态蒸馏）从多个副本中提取出来，以提高其质量。此外，魔法态也可以通过量子门操作从其他量子态合成。
> - 量子优势：魔法态的存在与量子计算中的量子优势直接相关。它们是实现某些量子算法（如量子搜索算法）的关键资源，这些算法在量子计算机上比在经典计算机上运行得更快。

## 变分量子求解器 Variational Quantum Eigensolver

# 松散的内容
- [[forrelation\|forrelation]]  [[0 fleeting/未解问题与新项目/新项目#^76sepr\|新项目#^76sepr]]
- [Quantum Algorithms: A Call To Action | Quantum Frontiers ~ 量子算法：行动电话|量子前沿](https://quantumfrontiers.com/2025/04/20/quantum-algorithms-a-call-to-action/)
	- 还提到两种不是那么像量子算法的能够体现量子优越性的应用：[[learning with quantum memory\|learning with quantum memory]], [[quantum streaming\|quantum streaming]] 