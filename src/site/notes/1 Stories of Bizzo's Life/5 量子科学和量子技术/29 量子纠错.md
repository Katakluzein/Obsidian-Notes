---
{"dg-publish":true,"permalink":"/1 Stories of Bizzo's Life/5 量子科学和量子技术/29 量子纠错/","tags":["量子纠错"]}
---


[[旧格式量子纠错\|旧格式量子纠错]]

**摘要**
- Knill-Laflamme QEC 条件
- 稳定子码

## 量子纠错简介

组织和分类种类繁多的量子比特码是一项艰巨的任务，参见[[ErrorCorrectionZoo\|ErrorCorrectionZoo]]和[[Lidar2013\|Lidar2013]]。纠正噪声的方法包括量子纠错码、无噪声子系统、动力学解耦合。

量子纠错码的研究与联合高阶数值范围(joint higer rank numerical range)之间存在密切联系[[li2011GeneralizedNumericalRanges\|li2011GeneralizedNumericalRanges]],[[caoNumericalRangesApplications\|caoNumericalRangesApplications]]。

常用记号
- 子空间码 $((n, K, d))_q$，每个量子位的维度是$q=p^l$，$p$是质数，码空间的维度是$K$，编码空间有$n$个量子位，$d$称为码距，能够检测$d-1$位的错误，纠正权重为$\lfloor\frac{d-1}{2}\rfloor$的错误。
- 子空间码 $[[n, k, d \|n, k, d ]]_q$，$K=q^k$。
- 子系统码 $[[n,k,r,d\|n,k,r,d]]_q$，$r$个规范量子位。
- 经典量子混合码[[grassl2017CodesSimultaneousTransmission\|grassl2017CodesSimultaneousTransmission]]。
- 经典纠错码的符号是将双括号改成单括号。

### 纠错码的界

- **Hamming界**：容纳错误的空间的数量大于离散化的错误数
  $$
  \sum_{j=0}^{d-1}\binom{n}{j} 3^j \leq 2^{n-k}
  $$
  如果$n,k,d$满足上述不等式，那么相应的稳定子码存在，参见[讲义](https://www.math.uwaterloo.ca/~anayak/courses/co781-s08/lectures/QECC-FT.pdf)，证明方式是计算一共有多少个稳定子码，以及有多少个不满足Hamming界。
- **Quantum Singleton Bound**：
  $$
  n-k \geq 2(d-1)
  $$

### 基本知识

**定义：量子纠错码**

- 设$\mathsf{H_1}$和$\mathsf{H_2}$是希尔伯特空间，$\mathrm{dim} \mathsf{H_1} < \mathrm{dim}\mathsf{H_2}$，$c:\mathsf{H_1}\rightarrow \mathsf{H_2}$是两个Hilbert空间之间的等距映射(isometry)，即
  $$
  c^\dagger c = \mathbb{I}_{\mathsf{H_1}},
  $$
  称$c$为**编码映射**(encoding)，$\mathsf{H_2}$称为**编码空间**(encoding space)，而$\mathsf{H}^c\equiv c(\mathsf{H_1})$称为**码空间**(code space)，码空间中的元素称为**码字**(code words)，线性映射$d:\mathsf{H}^{c} \rightarrow \mathsf{H_1}$，满足
  $$
  d c|\psi\rangle=|\psi\rangle \quad \forall| \psi\rangle \in \mathsf{H_1}.
  $$
  称为**解码映射**(decoding)。**量子纠错码**由编码和解码映射构成。

**笔记**
- 等距映射都是单射，但不必是满射。

设$P$是码空间上的正交投影算符，则编码空间上的幺正变换$U$是**逻辑算符**当且仅当$(I-P) U P=0$，逻辑算符集是一个Lie子群 (eastin2009RestrictionsTransversalEncoded, Lm.2)，记为$G_L$，称为**逻辑群**。逻辑算符$U$可以做直和分解[^1]$U=U_L\oplus U_N$，其中$U_L\in \mathsf{U}(\mathsf{H}^c)$作用在码空间上，是真正发挥作用的逻辑运算部分，$U_N$作用在码空间的正交补上。根据算符的直和分解，存在群的直积关系$G_L= \mathsf{U}(\mathsf{H}^c)\times \mathsf{U}(\mathsf{H}^{c\perp})$，只要$U_L$相同，那么逻辑算符就有着相同的效果，因此有时候也将**逻辑群**(或称**逻辑商群**)定义为商群$G_{L}^\prime \equiv G_L/(\mathbb{I}_{\mathsf{H}^{c }}\oplus\mathsf{U}( \mathsf{H}^{c\perp})) = G_L/\mathsf{U}( \mathsf{H}^{c\perp}) =\mathsf{U}(\mathsf{H}^c)$，因此商逻辑群也能被视为$G_L$的子群[^2]。

$\rho \in \mathsf{H_2}$是码字$\Leftrightarrow \rho \in \mathsf{H}^c\Leftrightarrow P\rho P=\rho \Leftrightarrow P\rho =\rho$

逻辑群$G_{L}^\prime$基本上就是(Lie群同构？)作用在未编码空间上的幺正变换群$U(\mathsf{H}_1)$，可以容易地证明一个更弱的命题，当$1<\mathrm{dim} \mathsf{H}_1<\mathrm{dim}\mathsf{H}_2$时，$SU(\mathsf{H}_1)$不是$SU(\mathsf{H}_2)$的正规子群，这是因为$SU(n)$的Lie代数是单的，因此Lie子群只能是离散的，又可以证明连通拓扑群的离散正规子群一定在生活在群的中心，所以$SU(n)$的闭正规子群(闭蕴含Lie)一定被包含在$\mathrm{Z}(SU(n)) =\mathbb{Z}_n$中，参见[SE贴](https://math.stackexchange.com/questions/1200499/normal-subgroups-of-sun)。

预期(没有严格证明)在前述条件下，$U(\mathsf{H}_1)$(以特定的方式嵌入时[^3])也不是$U(\mathsf{H}_2)$的正规子群。

一般的幺正相似变换很容易破坏直和分解的结构，即$U (U_L\oplus U_N) U^\dagger$不再有相同的直和分解，所以逻辑群$G_L$和逻辑商群$G_L^\prime$都不是$\mathsf{U}(\mathsf{H}_2)$的正规子群。

**定义：可纠正**

- 设$P$是码空间$\mathsf{H}^c$上的正交投影，编码空间为$\mathsf{H}$，则可$\mathcal{E}$纠正定义为，存在$\mathcal{R}$，使得
  $$
  (\mathcal{R} \circ \mathcal{E})(\sigma)=\sigma~ \mathrm{tr}(\mathcal{E}(\sigma))\quad \forall \sigma=P \sigma P,\sigma\in B(\mathsf{H})
  $$
  即$\mathcal{R}\mathcal{E}$作用在任意的支集和像集都包含于$\mathsf{H}^c$的元素上都是恒等作用。

**笔记**
- 我们要求$\mathcal{R}$是保迹的相当于要求对于任何一种可能出现的测量结果，我们都要给出相应的恢复操作。
- 根据映射的线性性，将定义中的$\sigma\in B(\mathsf{H}),\sigma=P \sigma P$改成$\sigma\in D(\mathsf{H}^c)$不会有任何区别。

**命题：无噪声子空间的等价刻画**

- 设$\mathsf{H}^c$是$\mathsf{H}$的子空间，$\mathcal{E}:B(\mathsf{H})\rightarrow B(\mathsf{H})$是量子信道，$P$是$\mathsf{H}^c$的正交投影，则下列等价
  - $\mathcal{E}(\rho)=\rho,~\forall \rho \in D(\mathsf{H}^c)$
  - $P \mathcal{E}(\rho) P=\rho,~\forall \rho \in D(\mathsf{H}^c)$

**证明**
- $(\Leftarrow )$在码空间$\mathsf{H}^c$及其正交补上做直和分解$\mathcal{E}(\rho)=\rho_1\oplus \rho_2$，则$\rho_1=\rho,\rho_2=0$

**横向门**[^4]：横向是指逻辑算符能够写成单比特算符的直积，免去了执行逻辑操作中的解码、在裸露的逻辑比特中执行逻辑操作、最后再编码的过程，从而“不会在代码块内传播错误，因此具有容错能力”[[eastin2009RestrictionsTransversalEncoded\|eastin2009RestrictionsTransversalEncoded]], (raussendorf2012KeyIdeasQuantum, (4.4))。例如对于Steane码，$X$、$Z$和$H$门都可以用直积来简单地横向实现。很多码都只能横向实现Clifford门[[chatterjee2024MagicMirrorWall\|chatterjee2024MagicMirrorWall]]，也有一些码能够横向实现$T$门[[koutsioumpas2022SmallestCodeTransversal\|koutsioumpas2022SmallestCodeTransversal]]。

- 使用一般的基准测试手段[[chatterjee2024MagicMirrorWall\|chatterjee2024MagicMirrorWall]]来分析码的纠错性能。
  - **量子比特开销 (Qubit Overhead)**：
    - 定义：编码一个逻辑量子比特所需的物理量子比特数量。
    - 分析：量子比特开销与错误纠正能力之间的权衡，以评估QECC的实用性。
  - **错误阈值 (Error Threshold)**：
    - 定义：错误阈值是QECC能够有效纠正错误的最高物理错误率。分析容错阈值pseudo-threshold[[schwartzman-nowik2024ModelingErrorCorrection\|schwartzman-nowik2024ModelingErrorCorrection]]就是计算物理量子比特的错误概率与逻辑量子比特的错误概率相等的点。
    - fidelity of some codewords？与容错阈值的关系？具体计算方法？
  - **错误保护 (Error Protection)**：
    - 定义：衡量QECC识别和纠正一系列量子错误的范围。
    - 设计能够检测和纠正所有可能量子错误的QECC是最终目标。评估QECC在处理不同错误类型方面的多样性和有效性。
  - **解码 (Decoding)**：
    - 定义：从症状推断错误的过程。
    - 分析：评估QECC依赖的解码算法的效率和准确性。
  - **横向门 (Transversal Gates)**：
    - 定义：纠错码能够横向实现的门的集合。
  - **可扩展性 (Scalability)**：
    - 定义：QECC在系统规模增大时保持其错误纠正效果的能力。与容错阈值密切相关。
  - **物理实现 (Realization)**：
    - 定义：QECC在不同量子比特类型上的实现情况，展示了其适应性和实际相关性。
    - 分析：QECC在多种量子计算架构中的适用性是其广泛采用的强指标。
  - **复杂性 (Complexity)**：
    - 定义：QECC的结构和操作复杂性影响其实施性和效率。
    - 分析：在设计和选择QECC时，需要平衡复杂性与效果和资源效率。
- 如何分析不同比特之间的串扰crosstalk?
- 是否能获得真正的量子计算机上的实验模型和参数来进行数值分析？数据库：Zenodo

基于这些基准测试方法，我们可以在不同的因素之间权衡利弊，通过调整不同因素的重要性权重，最优化的目标也会发生变化。考虑量子比特开销和错误保护的权衡，QEC的许多工作都围绕着能够消除任意误差对单个量子位影响的代码展开，这些代码非常强大，但开销也较高。5比特码、Steane码和Shor码都属于这一类型。然而，当我们对特定的物理过程有足够的了解时，可以考虑针对特定的噪声来设计近似或完美纠错码，从而在比特开销和错误保护能力之间取得平衡。举例来说，3比特重复码能够近似纠正比特翻转错误，4量子位代码能够纠正振幅阻尼噪声的[[leung1997ApproximateQuantumError\|leung1997ApproximateQuantumError]](是完美还是近似纠错？)，对资源的要求较低。（这个提法似乎没有足够的吸引力）

比纠错码更更广泛的概念是 “quantum characterization, verification, and validation”(QCVV)[[velazquez2024DynamicalQuantumMaps\|velazquez2024DynamicalQuantumMaps]]
- **表征**：对量子系统的物理特性进行详细测量和描述的过程。这包括了解系统的量子态、量子门的精确操作、以及系统对外部扰动的响应。表征过程通常涉及量子态的制备、量子操作的实现、以及对结果的测量。
- **验证**：确认量子系统是否能够执行预定任务的过程。这通常涉及到检查量子计算机是否能够正确执行[[量子算法\|量子算法]]，以及量子通信系统是否能够安全地传输信息。验证过程可能包括对量子比特的纠缠、量子门的保真度、以及量子错误校正代码的有效性进行测试。
- **validation**: 检验量子系统在实际应用中能够达到预期性能的过程。这包括对量子系统的稳定性、可靠性和可扩展性进行评估。验证过程可能涉及到长时间的运行测试，以确保系统在实际操作条件下的一致性和性能。

### 著名的码

- **量子重复码 (Quantum Repetition Code)**：经典纠错码的直接类比，最简单的QECC形式之一，主要用于保护量子信息免受比特翻转错误的影响。
- **Shor码** (shor_nine)：由Peter Shor在1995年开发，是第一个能够纠正任意量子错误的QECC，包括比特翻转和相位翻转错误。
- **5比特码** (stab_5_1_3)：能够纠正任意单比特错误的比特数最少的码。
- **6比特码**[[shaw2008EncodingOneLogical\|shaw2008EncodingOneLogical]]。
- **Steane码**：也称为7量子比特码，由Andrew Steane在1996年引入，是Calderbank-Shor-Steane（CSS）家族的一部分，提供了一种对称的方法来纠正比特翻转和相位翻转错误。
- **`[[11,1,5]]`码**，参见NCAlgebra算符广场.nb，以及 (scott2005ProbabilitiesFailureQuantum, (158))
- **Toric码**：由Alexei Kitaev引入，利用拓扑属性进行量子纠错，使用二维环形晶格结构，对局部错误具有鲁棒性。
- **Surface码**：扩展了Toric码的原理到平面几何结构，以其高阈值错误率而闻名，是可扩展量子计算的有前景的候选者。
- **Bacon-Shor码**：是Shor码的一个子类，简化了量子计算中的错误纠正过程，通过在正方形晶格上编码量子比特来确定X和Z错误纠正属性。
- **3D颜色码 (3D Color Code)**：通过将逻辑量子比特编码到三维结构中，扩展了表面码的原理，能够纠正更广泛的错误类型，包括复杂的相关错误。
- **Heavy Hexagon码**：通过在六边形晶格上增加策略性放置的“重”量子比特来提高错误纠正效率，这种设计增强了量子信息的完整性。

## Knill-Laflamme QEC 条件

主要参考了[[Scherer2019\|Scherer2019]]。

**引理：可纠错的必要条件**

- 设$\mathcal{R}$和$\mathcal{S}$是量子操作，且$\mathcal{S}$可以被$\mathcal{R}$恢复，即对于任意的密度算符$\rho\in D(\mathsf{H})$，有
  $$
  \mathcal{R}\left(\frac{\mathcal{S}(\rho)}{\operatorname{tr}(\mathcal{S}(\rho))}\right)=\rho
  $$
  证明
  $$
  \operatorname{tr}(\mathcal{S}(\rho))= \mathrm{const.}\quad \forall \rho
  $$

**证明**
- 设$\rho=\alpha \rho_{1}+(1-\alpha) \rho_{2} , ~\alpha \in(0,1)$，且$\rho_1\neq \rho_2$。
  恢复条件可以等价地写成$\mathcal{R} \circ \mathcal{S}(\rho)=\operatorname{tr} (\mathcal{S}(\rho)) \rho$，代入$\rho$的分解式得到
  $$
  \alpha \mathcal{R} \circ \mathcal{S}\left(\rho_{1}\right)+(1-\alpha) {\mathcal{R}\circ \mathcal{S}}\left(\rho_{2}\right)=\left(\alpha \operatorname{tr}\left(\mathcal{S}\left(\rho_{1}\right)\right)+(1-\alpha) \operatorname{tr}\left(\mathcal{S}\left(\rho_{2}\right)\right)\right)\left(\alpha \rho_{1}+(1-\alpha) \rho_{2}\right)
  $$
  再次利用可恢复条件将左侧的$\mathcal{R}$消去，整理得到
  $$
  \left(\rho_{1}-\rho_{2}\right)\left(\operatorname{tr}\left(\mathcal{S}\left(\rho_{1}\right)\right)-\operatorname{tr}\left(\mathcal{S}\left(\rho_{2}\right)\right)\right)=0
  $$

**笔记**
- 可恢复信道只在码空间上满足这个性质，这等价于
  $$
  \mathrm{tr}\left(\mathcal{S}\circ \mathcal{P} (\rho)\right)=\mathrm{const.}~\times ~\mathrm{tr}(\rho P)=\left\{
  \begin{array}{ll}
  &0,\quad \mathrm{sup}\rho \subset \mathsf{H}^{c\perp}\\
  & \mathrm{const}, \mathrm{sup}\rho \subset \mathsf{H}^{c}
  \end{array}\right.
  $$
  用Kraus算符写成
  $$
  \sum PS_i^\dagger S_i P=\alpha P
  $$
  其中$\alpha=\mathrm{tr}(\mathcal{S}(\rho)),~ 0< \alpha \leqslant 1$。上式是KL条件的一个推论，由此可见，这个必要条件不会对噪声空间的可纠正性施加额外的约束。

---
**脚注**

[^1]: 参见：[SE贴](https://quantumcomputing.stackexchange.com/questions/21245/general-conditions-to-define-a-logical-operator-is-there-some-general-character)
[^2]: 如果两个群不是直积的关系，商群通常不会是子群，反例参见[SE贴](https://math.stackexchange.com/questions/2498922/is-a-quotient-group-a-subgroup)。
[^3]: 是否存在这样的例子：当一个群以某种方式嵌入另一个群时是正规子群？
[^4]: 更多相关讨论参见[SE帖](https://quantumcomputing.stackexchange.com/questions/24269/what-is-formally-a-transversal-operator)。

好的，这是您笔记的第二部分，继续严格按照原文内容进行格式化。

---

**定理：Knill-Laflamme**

- 设量子操作$\mathcal{E}:B(\mathsf{H}^{2^n})\rightarrow B(\mathsf{H}^{2^n})$的Kraus算符集同样记为$\mathcal{E}$，即 $\mathcal{E}=\left\{ {E}_{a} \mid a =1, \ldots, l \right\} \in B\left(\mathsf{H}^{2^n}\right)$ 是$[[n, k \|n, k ]]$量子纠错码$V:\mathsf{H}^{2^k}\rightarrow \mathsf{H}^{2^n}$的编码空间上的错误操作，码空间记为 $\mathsf{H}^{c}\equiv V(\mathsf{H}^{2^k})\subset \mathsf{H}^{2^n}$ ，设$\left\{\left|\psi_{w}\right\rangle \mid w \in\left\{0, \ldots, 2^{k}-\right.\right.$ $1\}\}$ 是 $\mathsf{H}^{c}$的一组标准正交基(ONB)，则下列等价
  1. 错误操作 $\mathcal{E}=\left\{ {E}_{a}\right\}$可纠正。
  2. $\exists C \in\mathbb{C}^{l\times l}$ 满足 $\forall {E}_{a}, {E}_{b} \in \mathcal{E}$ $\left|\psi_{x}\right\rangle,\left|\psi_{y}\right\rangle \in\left\{\left|\psi_{w}\right\rangle\right\}$有
     $$
     \left\langle {E}_{a} \psi_{x} \mid {E}_{b} \psi_{y}\right\rangle=c_{a b} \delta_{x y}
     $$
     上式右边的矩阵称为**QEC矩阵**[[zheng2024NearOptimalPerformanceQuantum\|zheng2024NearOptimalPerformanceQuantum]]，记为$M_{xa,yb}=c_{ab}\delta_{xy}$，简记为$M=C\otimes \mathbb{I}_L$
  3. $\exists C \in\mathbb{C}^{l\times l}$ 满足 $\forall {E}_{a}, {E}_{b} \in \mathcal{E}$ 有
     $$
     P {E}_a^\text{} {E}_b P=c_{ab}P
     $$
     其中$P=\sum_{w}|\psi_w\rangle\langle \psi_w|=VV^\dagger$是码空间上的投影算符。
  4. $\exists C \in\mathbb{C}^{l\times l}$ 满足 $\forall {E}_{a}, {E}_{b} \in \mathcal{E}$ 有
     $$
     V^\dagger E_a^\dagger E_b V=c_{ab}\mathbb{I}_{\mathsf{H}^{2^k}}
     $$
- 且如果上面的命题成立，那么有
  $$
  \operatorname{tr}(C)=\operatorname{tr}( \mathcal{E}(\rho)) \quad \forall \rho \in D\left(\mathsf{H}^{c}\right)
  $$

**证明**

- (1)$\implies$(2)。根据引理，可设 $\operatorname{tr}(\mathcal{E}(\rho))=\kappa_\mathcal{E}$ 。因此$\mathcal{E}$可纠正等价于，存在恢复信道$\mathcal{R}=\{R_r\}$，使得对任意的$\rho \in D(\mathsf{H}^c)$，有
  $$
  \rho =\mathcal{R}\left(\frac{\mathcal{E}(\rho)}{\operatorname{tr}(\mathcal{E}(\rho))}\right)=\frac{1}{\kappa_{\mathcal{E}}} \sum_{r a} R_r E_{a} \rho E_{a}^{\dagger} R_{r}^{\dagger}
  $$
  取$\rho=|\psi\rangle\langle \psi |$，则有
  $$
  \kappa_{\mathcal{E}}=\sum_{r {a}}\left|\left\langle\psi\left|R_{r} E_{a}\right| \psi\right\rangle\right|^{2}
  $$
  可以证明任意态都是本征态的算符正比于单位算符，因此可设
  $$
  \left.\left(R_{r} E_{a}-z_{r a} \mathbb{I}\right)\right|_{\mathsf{H}^{c}}=0
  $$
  根据定义，$\mathcal{R}$是保迹的，因此可以推论$\sum_r R_r^\dagger R_r=\mathbb{I}$
  $$
  \begin{aligned}\left\langle\psi_{x}\left|E_{a}^\dagger E_{b}\right| \psi_{y}\right\rangle & =\left\langle\psi_{x}\left|E_{a}^\dagger R_{r}^\dagger R_{r} E_{b}\right| \psi_{y}\right\rangle \\ & =z_{r b} z_{r a}^{*}\left\langle\psi_{x} \mid \psi_{y}\right\rangle\end{aligned}
  $$
  容易证明$\sum_r z_{rb}z_{ra}^*$是厄米的，因此取$c_{ab}=\sum_r z_{rb}z_{ra}^*$，$C=Z^\dagger Z$即可。
- (1)$\implies$式。根据前面的式子，可知$\kappa_\mathcal{E}=\sum_r z_{ra}z_{ra}^*=\mathrm{tr}~C$
- (2)$\Longleftrightarrow$(3) 显然。
- (3)$\implies$(1) $C$是厄米阵，做对角化得到$D=U^\dagger C U$，或等价地$d_{i} \delta_{i j}=u_{ai}^{*} C_{a b} u_{b j}$，因此$P E_{a}^\dagger E_{b} P=c_{a b} P$可以写成
  $$
  P\left(u_{i a}^{*} E_{a}^\dagger\right)\left(u_{b j} E_{b}\right) P=d_{i} \delta_{i j} P
  $$
  定义$F_j=\sum_b u_{bj}E_b$，可得
  $$
  P F_{i}^\dagger F_{j} P=d_{i} \delta_{i j} P
  $$
  由于只相差幺正变换，故$\{E_i\}$和$\{F_i\}$将生成同一个信道。
  - 利用极分解公式$A=U P=U \sqrt{A^{\dagger} A}$可知，任取$j$，存在$U_j$满足[^5]
    $$
    F_{j} P=U_{j} \sqrt{P F_{j}^\dagger F_{j} P}=\sqrt{d_{j}} U_{j} P
    $$
    $U_j$的分解有很大的自由度，可以选择合适的$U_j$使得$U_j|\psi\rangle$当$F_jP=0$时，$d_j=0$，做极分解是没有意义的，$U_j$可以选为任意的幺正算符，虽然会得到不同的恢复信道，但是都能纠正这个错误操作，因此直接取相应的$U_j=\mathbb{I}$即可。
  - 定义恢复信道
    $$
    \mathcal{R}(\cdot)\equiv P_0 \cdot P_0 +\sum_{d_j>0} U_{j}^\dagger P_{j} \cdot P_{j} U_{j}=P_0 \cdot P_0 +\sum_{d_j>0} P U_{j}^\dagger \cdot U_{j} P= P_0 \cdot P_0+\sum_{d_j>0}\frac{1}{d_j}P F_j^\dagger \cdot F_j P
    $$
    其中$P_{j}=U_{j} P U_{j}^\dagger=\frac{1}{\sqrt{d_{j}}} F_{j} P U_{j}^\dagger=\frac{1}{\sqrt{d_{j}}} U_{j} P F_{j}^{\dagger}$，$P_0\equiv \mathbb{I}-\sum_{i>0}P_i$ ，$\mathcal{R}$的Kraus算符为 $>\sum \frac{u_{b_j}^*}{\sqrt{d}_j} P E_b^{\dagger}dg >$ (这个公式怎么乱七八糟的？)。
- (2)$\implies$(1)。与(3)$\implies$(1)的证明中类似，做对角化可得，
  $$
  \left\langle\psi_{x}\left|F_{i}^\dagger F_{j}\right| \psi_{y}\right\rangle=c_{i} \delta_{i j} \delta_{x y}
  $$
  因此，$c_{i}=\left\langle\psi\left|F_{i}^{\dagger} F_{i}\right| \psi\right\rangle \geqslant 0$，可以将$i$生活的指标集做划分，设当 $i \in I_{0}$ 时 $c_{i}=0$ ，当$i \in I_{>}$时 $c_{i}>0$。$\forall i \in I_{0}, c_{i}= 0 \Rightarrow F_{i} |_{\mathsf{H}^{{c}}}=0~\Leftrightarrow ~\mathsf{H}^{{c}}\subset \mathrm{ker}~F_i=(\mathrm{im}~F_i^\dagger)^\perp$。另一方面$\forall i \in I_{>}, ~ \left|\psi_{x}\right\rangle \in \mathsf{H}^{\mathrm{C_{q}}}$，定义
  $$
  \left|\varphi_{i, x}\right\rangle=\frac{1}{\sqrt{c_{i}}} F_{i}\left|\psi_{x}\right\rangle
  $$
  $$
  R_{i}=\sum_{x}\left|\psi_{x}\right\rangle\left\langle\varphi_{ix}\right|,~\forall i\in I_>
  $$
  根据定义，$\mathcal{R}$是保迹的，而
  $$
  \sum_{i} R_{i}^{\dagger} R_{i}=\sum_{i x}\left|\varphi_{ix}\right\rangle\left\langle\varphi_{i y}\right|
  $$
  不一定完备， 因此定义
  $$
  P_{0}=\mathbb{I}-\sum_{i \in I_>} R_{i}^\dagger R_{i}
  $$
  容易检验，
  $$
  \mathcal{R}(\cdot)=P_{0} \cdot P_{0}^\dagger+ \sum_{i\in I_>} R_{i} \cdot R_{i}^\dagger
  $$
  就是所求的恢复信道，它满足完备性且能够纠正错误$\mathcal{E}$。
- $(3)\iff (4)$显然，仅仅是记号稍有不同。

**笔记**
- 显然$\mathrm{tr}~C=\mathrm{tr}~\mathcal{E}(\rho)$不能为零。
- $P_0=0$意味着发生错误的态张成了整个空间，编码空间被充分利用了。
- 存在某个$i$使得 $F_{i} |_{\mathsf{H}^{{c}}}=0$，或等价地$F_iP=0$，不意味着$\mathcal{E}$不保迹。
- $P_0=0$与$\mathcal{E}$保迹互不蕴含。考虑3比特码与以概率$p$发生的第一个比特的翻转错误，噪声是保迹的，但是错误态没有张满整个空间，因此$P_0>0$。5比特码的所有单比特错误张满了整个空间因此$P_0=0$，但如果各种错误的概率发生的概率加起来不是1，则可以使得$\mathcal{E}$不保迹[^6]。
- 假设$\mathcal{E}$是保迹的，即任取$\rho\in D(\mathsf{H}^{c})$，有$\kappa_\mathcal{E}=\mathcal{E}(\rho)=1$，那么
- 恢复信道的Kraus算符$\{P_0,R_i=U_i^\dagger P_i\}$与码空间和错误操作$\mathcal{E}$都有关。当$P_0>0$时，恢复信道$\mathcal{R}$(作为映射)不由$\mathcal{E}$和$\mathsf{H}^c$唯一确定，而是存在一定的自由度。而当$P_0=0$时，$\mathcal{R}$是由$\mathcal{E}$和$\mathsf{H}^c$唯一确定的（待证），其Kraus算符可以分解为先投影测量再做幺正变换，其中幺正变换的选取存在一定的自由度。
- 由于对$C$做了对角化，我们构造的信道的投影算符之间是相互正交的，
  $$
  \begin{aligned} P_{i} P_{j} & =\frac{1}{\sqrt{d_{i} d_j}} U_{i} P F_{i}^\dagger F_{j} P U_{j}^\dagger \\ & =\frac{d_{i} \delta_{i j}}{\sqrt{d_i d_j}} U_{i} P U_{j}^\dagger \\ & =\delta_{i j} U_{i} P U_{j}^{\dagger} \\ & =\delta_{i j} P_{i}\end{aligned}
  $$
- 任意给定一个错误操作$\mathcal{E}$，用幺正矩阵中系数对它做线性叠加，得到一个新的操作$\mathcal{\tilde{E}}$。在新的操作下，KL条件中的矩阵$C$是对角阵，
  $$
  \left\langle {\tilde{E}}_{a} \psi_{x} \mid {\tilde{E}}_{b} \psi_{y}\right\rangle=c_{a} \delta_{a b} \delta_{x y}
  $$
  这意味着不同的错误将码空间$\mathsf{H}^c$映到相互正交的线性空间。从直观上说，这保证了错误有足够好的区分度。粗略地说，可纠错条件就是错误操作的Kraus算符可以被正交化，使得每个错误都保持码空间的内积结构。实际上任何量子操作的Kraus算符都可以被对角化。
- 对可纠错条件做共轭转置可知$C^\text{}=C$
- 补充不可区分性和可恢复性的等价性[[li2024PenroseTilingQuantum\|li2024PenroseTilingQuantum]]。
- 在这个定理的条件下，是否有$P{E}_b P\propto P$自动成立？从稳定子码的角度考虑，单位算符总是可以被纠正的。实际上我们总是要求单位阵可以被纳入到错误操作的Kraus算符中。
- 如果厄米阵$(c_{ab})$是奇异的，那么称码**简并** (Djordjevic2021book, p.311)，否则称为**非简并**。
- [海森堡表象下的纠错条件的讨论](https://www.birs.ca/workshops/2010/10w5005/files/kribs.pdf)，讲义中省略的推导参见[[beny2009QuantumErrorCorrection\|beny2009QuantumErrorCorrection]]，另参见[[#算符代数量子纠错 OAQEC]]。
  设噪声信道$\mathcal{E}$的任意一组Kraus算符张成的空间为$\mathsf{E}$，则可纠正的充要条件是
  $$
  P \mathsf{E}^\dagger \mathsf{E} P=\mathbb{C} P
  $$
  上式利用了算符的线性空间的乘积是良定义的。

如果认为连续纠错的纠错速率是含时的，那么周期性纠错是连续纠错在给定的时间节点上做无穷大的纠错，而在其他时间段不做纠错，所以周期性纠错是连续纠错的特殊情况。

需要注意的是，对于给定的码空间来说，厄米共轭不必保持可纠错集，反例参见：`构造厄米共轭不保持可纠错集的例子反例.nb`。

略去定理中与编码、解码有关的内容，遵循类似的证明，可以得到下面的定理。

**定理：Knill-Laflamme(简化)**

- 设$\mathcal{E} :B(\mathsf{H}_0)\rightarrow B(\mathsf{H}_1)$ 是量子操作，Kraus算符记为$\{E_i\}$，则下列等价
  1. 存在信道$\mathcal{R} :B(\mathsf{H}_1)\rightarrow B(\mathsf{H}_0)$，使得$\mathcal{R}\circ \mathcal{E} =\mathrm{id}$。
  2. 对任意的$i,j$，存在$c_{ij}$使得，$E_i^\dagger E_j = c_{ij } \mathbb{I}_{\mathsf{H}_0}$

**证明**
- $(\Rightarrow)$，类似引理可以证明$\operatorname{tr}(\mathcal{E}(\rho))=\kappa_\mathcal{E}$，利用可恢复性可以证明
  $$
  \sum_{ij}|R_iE_j |\psi\rangle -\langle \psi |R_i E_j|\psi\rangle |\psi\rangle |=0，~\forall |\psi\rangle \in \mathsf{H}_0
  $$
  因此任何态都是$R_i E_j$的本征态，进而$R_i E_j = z_{ij} \mathbb{I}_{\mathsf{H}_0}$，利用$\mathcal{R}$的保迹性，
  $$
  \mathbb{I}_{\mathsf{H}_0} \propto\sum E_a^\dagger R_i^\dagger R_i E_b= E_a^\dagger E_b
  $$
- $(\Leftarrow)$，做对角化$D=U^\dagger C U$，或等价地$d_{i} \delta_{i j}=u_{ai}^{*} C_{a b} u_{b j}$，
  $$
  F_{i}^\dagger F_{j} =d_{i} \delta_{i j}
  $$
  根据极分解公式，存在等距算符$U_i:\mathsf{H}_0\rightarrow \mathsf{H}_1$，使得
  $$
  F_i=\sqrt{d_i} U_i
  $$
  容易检验恢复信道$\mathcal{R}$的Kraus算符为$\{ U_j^\dagger = \frac{F_j^\dagger}{\sqrt{d_j}} \}$并上一个的正交投影算符，使得$\mathcal{R}$具有保迹性。

**笔记**
- 在证明子系统码的可恢复性定理的时候会用到。

可以证明 (Scherer2019, Cor.7.21)，如果两组算符$\{ {E}^\prime_i\}$和$\{ {E}^{\prime\prime}_i\}$是可以被$\{R_i\}$纠正的，那么
$$
{E}_{u}=\sum_{a} V_{a u} {E}^\prime _{a}+\sum_{s} W_{s u} {E}^{\prime\prime}_{s}
$$
也能被$\{R_i\}$纠正，其中$V$和$W$是任意的形状合适的矩阵。作为推论，可纠错性与Kraus算符的选取无关。因此我们可以将错误离散化[^7]，只考虑如何纠正算符空间中的一组完备的基底，例如泡利群$\mathcal{P}_n$。

---
**脚注**

[^5]: 注意：极分解总是给出一个幺正变换和一个正算符，这里也不例外！但是这里的特殊之处是这个正算符可以写成正比于某个正交投影算符的形式。另外算符$U_j$只要是$\mathrm{im} P$上的偏等距(partial isometry)即可，拥有很大的自由度。错误作用在码空间上的效果可以等效成一个幺正变换乘上一个系数，这体现了错误必须在一定程度上保持码空间的内积结构。
[^6]: 如何理解5比特码仍然可以完美纠正这种错误，而不是概率性的失败？态是强制归一的？对于那些可以纠错的量子操作，总是可以归一化让它变成一个信道。
[^7]: 对于不可纠正的错误，为什么还能离散化呢？

好的，这是您笔记的第三部分，也是最后一部分。我继续严格按照原文内容进行格式化。

---

**定义：码距(code distance)** (Djordjevic2021book, p.311)

- 量子纠错码的**码距**为$d$，如果任意权重小于$d$的错误$E$都满足
  $$
  \langle x|E |y \rangle= C_E \delta_{xy}
  $$
  且存在一个权重为$d$的错误违反上式。

**笔记**
- 码距是有非平凡作用的逻辑算符的最小权重。
- 例如能够纠正任何单比特的错误的Shor码和5比特码的码距都是3.

**定义：纠错码的简并、纯码、简并类** (li2010StructuredErrorRecovery, (5))

- 设纠错码$V$的码空间为$\mathsf{H}^c$，如果对于任何两个线性独立的错误$E_1, E_2$，"错误空间"(corrupted) $E_1 \mathsf{H}^c \cap E_2 \mathsf{H}^c =\{0\}$，则称码$V$是**非简并的**。
- 更严格地，如果$E_1 \mathsf{H}^c \perp E_2 \mathsf{H}^c$，则称码是**纯码**。
- 如果$E_1 \mathsf{H}^c = E_2 \mathsf{H}^c$，则称错误$E_1$和$E_2$~**相互简并**，也称他们属于同一个**简并类**。

**笔记**
- 对于CWS码（包括了所有稳定子码）和USt(union stabilizer)码来说，任何两个错误空间要么相等、要么正交，根据上面的定义，如果这些码非简并，那么一定是纯码。

如果存在两个可纠正的错误具有相同的症状，那么称码是简并的。对于稳定子码来说，码是简并的当且仅当稳定子$S$中含有至少一个权重小于码距的非平凡元素 (Djordjevic2021book, p342)。

**定理：Eastin-Knill定理** (eastin2009RestrictionsTransversalEncoded)

- 对于一个能够检测任意单比特错误的纠错码，能够横向实现的逻辑门的集合是有限的，因此不可能构成一组通用门。

**笔记**
- 证明思路：由于具备纠正任意单比特的能力，与单位元的联通分支内的直积形式的逻辑算符在码空间上只能有平凡的作用，由于直积形式的逻辑算符Lie群是紧的，因此其联通分支的数量是有限的，直积形式的逻辑算符的等价类(每个等价类在码空间上有不同的作用)是有限多的。

## 稳定子码

设稳定子(泡利群的不含$\langle i\mathbb{I}\rangle$的阿贝尔子群)为$S$,稳定子的正规化子$N(S)$是Pauli群中与$S$对易的群元组成的群，任意给定用泡利矩阵制作的随机幺正操作$\mathcal{E}=\left\{ {E}_{a} \mid a=1, \ldots, l\right\}$，有可纠正的充分性定理：如果
$$
{E}_{a}^{\text{}} {E}_{b} \notin N(S) \backslash S,\quad \forall {E}_{a}, {E}_{b} \in \mathcal{E}
$$
那么错误$\mathcal{E}$是可纠正的。注意这个条件不是必要的，如果存在稳定子元$s\in S$以及$E_a^\dagger E_b=i s$，那么$\mathcal{E}$仍有可能可以纠正，但是此时有$E_a^\dagger E_b\in N(S) \backslash S$ 。

**定理：泡利错误可纠正的充要条件**

- 设$\mathcal{E}$是用泡利矩阵制作的信道，$S$是稳定子群，则$\mathcal{E}$可被$S$确定的稳定子码纠正当且仅当
  $$
  E_i^\dagger E_j\notin N(S)-\langle i \mathbb{I},S\rangle,\quad \forall i\neq j
  $$

**证明**
- $P$是稳定子群$S$生成的码空间的正交投影算符.
- **充分性**，由于$E_i^\dagger E_j\notin N(S)-\langle i \mathbb{I},S\rangle$ ，故$E_i^\dagger E_j$至少和一个稳定子生成元反对易，因此$PE_i^\dagger E_jP=0$
- **必要性**，设存在$i,j$使得，$E_i^\dagger E_j\in N(S)-\langle i \mathbb{I},S\rangle =C(S)-\langle i \mathbb{I},S\rangle$，则$PE_i^\dagger E_jP=PE_i^\dagger E_j$不能正比于$P$，因此$\mathcal{E}$不可纠正。

**笔记**
- 由于存在可裂的正合列
  $$
  1\rightarrow \langle i \mathbb{I}\rangle \stackrel{i}{\hookrightarrow}\hat{G}=\langle i \mathbb{I},S\rangle=\langle i \mathbb{I}\rangle S \stackrel{p}{\rightarrow} S=\hat{G}/\langle i \mathbb{I}\rangle \rightarrow 1
  $$
  故存在半直积关系$\langle i \mathbb{I},S\rangle =\langle i \mathbb{I}\rangle \rtimes S$。实际上，由于$\langle i \mathbb{I}\rangle$和$S$都是$\hat{G}$的正规子群，且$\langle i \mathbb{I}\rangle \cap S=\mathbb{I}$，因此存在直积
  $$
  \langle i \mathbb{I},S\rangle=\langle i \mathbb{I}\rangle \times S
  $$
- 另外，根据中心积$\circ$的定义$\langle i \mathbb{I},S\rangle=\langle i \mathbb{I}\rangle \circ S$，这是因为两个因子中的任意一对元素都是对易的(中心积是对称的)。中心积的另一个例子$\mathcal{P}_1 = C_4\circ D_4$，$D_4$是四边形的对称性，8阶群。

集合$N(S) \backslash S$中的算符被视为潜在的稳定子或者这个码的逻辑算符。对于稳定子码来说，如果$\mathbb{I}\notin \mathcal{E}$，总是可以将$\mathbb{I}$添加到这组算符中，由于泡利算符满足$\sigma^2=\mathbb{I}$，因此新的信道对于原有的纠错码来说仍然是可纠正的。下面考虑发生的错误不可纠正时，如何根据症状推断发生的错误，并尽可能地恢复逻辑态。

[Image Placeholder: 待整理：中心化子的生成元Quantum Subsystem Codes Their Theory and Use, QCQI notes p.20 - image//2024-05-08-08-47-45.png]

**定义：稳定子码的症状映射** (Scherer2019, Def.7.36)

- $c$ be an $[[n, k \|n, k ]]_{q}$ QECC with stabilizer
  $$
  S=\left\langle g_{1}, \ldots, g_{n-k}\right\rangle<\mathcal{P}_{n}
  $$
  We define the **syndrome** map of the stabilizer QECC $c$ as
  $$
  \begin{aligned}
  \operatorname{syn}_{q}: \mathcal{P}_{n} & \longrightarrow \mathbb{F}_{2}^{n-k} \\
  g & \longmapsto\left(l_{1}(g), \ldots, l_{n-k}(g)\right),
  \end{aligned}
  $$
  where
  $$
  l_{j}(g)=\left\{\begin{array}{ll}
  0 & \text { if } g g_{j}=g_{j} g \\
  1 & \text { if } g g_{j}=-g_{j} g
  \end{array}\right.
  $$
  for $j \in\{1, \ldots, n-k\}$.

**笔记**
- 这个定义是非常直接的，为了纠正错误，我们必须测量纠错码的稳定子，对发生错误的比特位置和类型进行推断。容易证明，稳定子码的症状映射一个群同态，泡利群中的乘法是有限域中的模二加法。

根据泡利群的性质可知，只有与稳定子对易的泡利群元才在稳定子的中心化子中[^8]，而这些与稳定子对易的群元作为错误是不会产生任何症状的，因此稳定子的中心化子就是作为群同态的症状映射$\mathrm{syn}_q$的核，即 (Djordjevic2021book, (9.21))
$$
N(S)=\operatorname{ker}\left(\operatorname{syn}_{q}\right)
$$
每个同态核都是正规子群，因此有$N(S)=\operatorname{ker}\left(\operatorname{syn}_{q}\right) \lhd \mathcal{P}_n$，即稳定子群的正规化子是泡利群的正规子群，这一关系也不难直接检验。利用症状映射的性质，我们有以下定理。

**定理：症状映射与同态基本定理**

- 下面的映射是同构
  $$
  \begin{aligned} \widehat{\operatorname{syn}}_{q}: \mathcal{P}_{n} / N(S) & \longrightarrow \mathbb{F}_{2}^{n-k} \\ \overline{g}=gN(S) & \longmapsto \operatorname{syn}_{q}(g)\end{aligned}
  $$

**证明**
- $\operatorname{syn}_{q}$是群同态，根据群同态的基本定理可得。

**笔记**
- 映射$\mathcal{P}_n\rightarrow \mathcal{P}_{n} / N(S),~g\mapsto \overline{g}$被称为正则同态。

任取群元$g\in \mathcal{P}_n$，有一整个等价类$\overline{g}$中的群元造成的错误都产生相同的症状，反之，具有相同症状的错误都属于同一个等价类，我们可以根据实验条件或者其他实际情况，确定等价类中的发生概率最高的一个错误，然后针对这个错误进行纠错，这一选取方式决定了我们设计的纠错码可以纠正哪些错误。通常情况下，单比特错误比多比特错误更有可能发生，因此我们会选择那些比特数少的错误。确定了错误以后，我们只需要再作用一个相同的错误即可完成纠错。

作为定理的推论，不可检测的错误、即对码字有非平凡作用但是不产生任何症状的泡利群元来自集合$N(S)-S$。从群论中的拉格朗日定理容易计算$|N(S)|=|\mathcal{P}_n|/|\mathbb{F}_2^{n-k}|=2^{n+k+2}>2^k=|S|$，因此总会存在一些不可检测、因而不可纠正的错误。从另一个角度来，计算设$S=\langle s_1,\ldots,s_r\rangle$，$G$是对应的$r\times 2n$的奇偶校验矩阵，$\Omega$是$2n$维的度量矩阵，方程$G\Omega x=0$的解的个数就是中心化子中群元的个数的四分之一(考虑到相位因子)，由于解空间是$2n-r$维的，所以中心化子的元素的个数是$2^{2n-r+2}=2^{n+k+2}$.

稳定子码的完整的纠错过程总结参见 (Scherer2019, Sec.7.3) 的小节末尾。

**命题**

- 设$S$是泡利群$\mathcal{P}_n$的一个不包含$-\mathbb{I}$的阿贝尔子群，$N(S)$是$S$在$\mathcal{P}_n$的正规化子(实际上也是中心化子)，任取$p\in \mathcal{P}_n-N(S)$，有$p$恰好与$S$中一半的群元素对易，与另一半反对易。

**证明**
- 设$S$可以由$N$个元素生成，记为$S=\langle g_1\ldots g_N \rangle$，因为$p\in \mathcal{P}_n-N(S)$，因此可以设$p$与$a$个生成元对易，其中$0\leqslant a< N$，与$b=N-a>0$个生成元反对易，则$p\in N(S)$。计算$S$中与$p$反对易的群元的个数
  $$ \begin{align} & \sum_{m=0}^{\lfloor N / 2\rfloor} \sum_{k=0}^{m} C_{a}^{2 {k}} C_{b}^{2 m+1-2 k}+\sum_{m=0}^{\lfloor N / 2\rfloor} \sum_{k=0}^{m} C_{a}^{2 k+1} C_{b}^{2 m+1-2 k} \\ = & \sum_{m=0}^{\lfloor N / 2\rfloor} \sum_{k=0}^{m}\left(C_{a}^{2 k}+C_{a}^{2 k+ 1}\right) C_{b}^{2 m+1-2 k} \\ = & \sum_{m=0}^{\lfloor N / 2\rfloor} \sum_{k=0}^{m} C_{a+1}^{2 k+1} C_{b}^{2 m+1-2 k} \\ =&\sum_{k=0}^{\lfloor N / 2\rfloor} \sum_{m=k}^{\lfloor N / 2\rfloor} C_{a+1}^{2 k+1} C_{b}^{2 m+1-2 k} \\ =&\sum_{k= 0}^{\lfloor N / 2\rfloor} \sum_{l=0}^{\lfloor N / 2\rfloor-k} C_{a+1}^{2 k+1} C_{b}^{2 l+1} \\ =&\sum_{k=0}^{\lfloor N / 2\rfloor} \sum_{l= 0}^{\lfloor N / 2\rfloor} C_{a+1}^{2 k+1} C_{b}^{2 l+1} \\ =&\left(\sum_{k=0}^{\lfloor N / 2\rfloor} C_{a+1}^{2 k+1}\right)\left(\sum_{l=0}^{\lfloor N / 2\rfloor} C_{b}^{2 l+1}\right) \\ = & 2^{a+b-1}=2^{N-1}\end{align}$$
  其中，${\lfloor \circ \rfloor}$表示向下取整。$|S|=2^N$，因此$p$恰好与一半的群元对易。

根据$g=\prod_{k=1}^N(\mathbb{I}+g_k)$，$pgp= \prod_{k=1}^N(\mathbb{I}+(-1)^{s_k}g_k)$，并令$g_k$为单位阵，有$f(pgp)=0$，可得相同的结论，严谨的证明待补充。是否要求$-\mathbb{I}$不在$S$中？
作为推论，对与一个稳定子码可能产生的任何泡利错误$p$、稳定子群的群元总是有一半与$p$对易，而另一半反对易。

---
**脚注**

[^8]: 稳定子群$S$是指泡利群的不包含$-\mathbb{I}$的阿贝尔子群。$S$满足$N(S)=C(S)$，即中心化子等于正规化子。

好的，这是您笔记的第四部分，也是最后一部分。我继续严格按照原文内容进行格式化。

---

## 适应噪声的纠错码

在有辅助系统的情况下，可以给出一种根据噪声空间制作纠错码的方法 (zhou2018AchievingHeisenbergLimit, (28))，设$\mathsf{E}=\mathrm{span}\{E_i\}$是噪声空间，作用在编码空间$\mathsf{H}_P$上，$\mathsf{E}$可以是任何信道提供的，不仅是Markov演化一阶近似提供的噪声空间，可以包括Markov演化中哈密顿量的贡献。设$\mathsf{F}=\mathrm{span}_\mathbb{R}\{ \mathrm{Re}[E_i^\dagger E_j],\mathrm{Im}[E_i^\dagger E_j]\}=\{M\mid M^\dagger=M,~M\in \mathrm{span}_\mathbb{C}\{E_i^\dagger E_j\}\}\equiv \mathrm{span}_H\{ E_i^\dagger E_j\}$，$\mathsf{F}$由$\mathsf{E}$唯一确定。在$\mathsf{F}^\perp$中任取一个无迹厄米算符(如果存在)，并分解为两项$G_{\perp}=\frac{1}{2}\left(\operatorname{tr}\left|G_{\perp}\right|\right)\left(\rho_0-\rho_1\right)$，对$\rho_0$和$\rho_1$做纯化，则码空间由纯化所得的$|C_0\rangle ,|C_1\rangle\in \mathsf{H}_P\otimes \mathsf{H}_A$张成，$\mathsf{H}_A$是辅助系统。
对任何$O\in \mathsf{E}$，有
$$
\Pi_C(O \otimes I) \Pi_C=\left\langle C_0\right|(O \otimes I)\left|C_0\right\rangle \Pi_C
$$
其中$\Pi_C=|C_0\rangle\langle C_0|+|C_1\rangle\langle C_1|$。

*类似的构造是否能够推广到无辅助系统以及多个逻辑比特？*

## 算符量子纠错(OQEC)和子系统码

相关理论主要来自Kribs和Poulin[[kribs2005OperatorQuantumError\|kribs2005OperatorQuantumError]]。

### 数学动机和基本定义

给定编码空间$\mathsf{H}$上的量子信道$\mathcal{E}=\{E_i\}$，$\mathcal{A}$是$\{E_i\}$生成的(有限维)$C^*$-代数，关于一组标准正交基有分解 (davidson1996CalgebrasExample, Th.I.10.8;Th.III.1.1), (farenick2001AlgebrasLinearTransformations, Th.5.6)，证明详见定理
$$
\mathcal{A} \cong \bigoplus_{J}\left(\mathcal{M}_{m_{J}} \otimes \mathbb{I}_{n_{J}}\right)
$$
$$
\mathcal{A}=\left(\begin{array}{cccc}
\mathcal{M}_{m_1} \otimes \mathbb{I}_{n_1} & 0 & \cdots & 0 \\
0 & \mathcal{M}_{m_2} \otimes \mathbb{I}_{n_2} & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \cdots & \mathcal{M}_{m_N} \otimes \mathbb{I}_{n_N}
\end{array}\right) .
$$
其中$\mathcal{M}_{m_J}$是完整的$m_J$阶矩阵代数$B(\mathbb{C}^{m_J})$。代数$\mathfrak{A}$的维度$D=\sum_k m_k^2$。根据代数的分解可以得到$\mathsf{H}$分解成子空间且每个子空间又分解成两个子系统
$$
\mathsf{H}=\bigoplus_{J} \mathsf{H}_{J}^{A} \otimes \mathsf{H}_{J}^{B}
$$
系统$A$带噪声，而$B$不带噪声。
$\mathcal{A}$的交换子(commutant)$\mathcal{A}^\prime$有分解
$$
\mathcal{A}^\prime \cong \bigoplus_{J}\left(\mathbb{I}_{m_{J}} \otimes \mathcal{M}_{n_{J}}\right)
$$
考虑单一一个sector
$$
\mathsf{H}=\left(\mathsf{H}^{A} \otimes \mathsf{H}^{B}\right) \oplus \mathsf{K}
$$
设$\mathrm{dim}(\mathsf{H}^A)=m,\mathrm{dim}(\mathsf{H}^B)=n$。
将$\mathsf{H}^A\otimes \mathsf{H}^B$视为码空间，码空间上的关于$A$，$B$两体划分的直积态被用作码字，$A$系统是辅助子系统，也成为规范子系统，可以受到噪声影响，在恢复时不需要回到原来的态，而$B$被称为逻辑子系统，在纠错时需要回到原来的状态。定义子空间$\mathsf{H}^A\otimes \mathsf{H}^B$上的直积算符(不必是量子态)构成的半群
$$
\mathfrak{A}\equiv \left\{\sigma \in B(\mathsf{H})\mid \sigma=\sigma^{A} \otimes \sigma^{B},\sigma^{A,B}\in B(\mathsf{H}^{A,B})\right\}
$$
定义其子代数
$$
\mathfrak{A}_{0}\equiv \mathbb{I}^{A} \otimes B\left(\mathsf{H}^{B}\right)
$$
设$\{\alpha_i\}$是$\mathsf{H}^A$上的一组标准正交基，定义$B(\mathsf{H}^A)$上的matrix unit~$P_{k l} \equiv\left|\alpha_k\right\rangle\left\langle\alpha_l\right| \otimes \mathbb{I}^B \quad \forall 1 \leq k, l \leq m$，$P_\mathfrak{A}=\sum_{i=1}^{m}|\alpha_i\rangle\langle\alpha_i |\otimes \mathbb{I}^B=\sum_{k=1}^{m}P_{kk}=\mathbb{I}^A\otimes \mathbb{I}^B$

**定义：无噪声子系统**

- 遵循上述定义，$\mathsf{H}=\left(\mathsf{H}^{A} \otimes \mathsf{H}^{B}\right) \oplus \mathsf{K}$
  $$
  \forall \sigma^{A} \forall \sigma^{B}, \exists \tau^{A}: \mathcal{E}\left(\sigma^{A} \otimes \sigma^{B}\right)=\tau^{A} \otimes \sigma^{B}
  $$
  称$B$是关于$\mathcal{E}$~**无噪声子系统**。

**定理：无噪声子系统的等价刻画**

- $\mathcal{E}=\left\{E_a\right\}$是$B(\mathsf{H})$上的量子信道，$\mathsf{H}=\left(\mathsf{H}^{A} \otimes \mathsf{H}^{B}\right) \oplus \mathsf{K}$ 下列等价：
  1. $B$是关于$\mathcal{E}$无噪声子系统，即
     $$
     \forall \sigma^A \forall \sigma^B, \exists \tau^A: \mathcal{E}\left(\sigma^A \otimes \sigma^B\right)=\tau^A \otimes \sigma^B
     $$
  2. $$
     \forall \sigma^B, \exists \tau^A: \mathcal{E}\left(\mathbb{I}^A \otimes \sigma^B\right)=\tau^A \otimes \sigma^B
     $$
  3. $$
     \forall \sigma \in \mathfrak{A}:\left(\operatorname{tr}_A \circ \mathcal{P}_{\mathfrak{A}} \circ \mathcal{E}\right)(\sigma)=\operatorname{tr}_A(\sigma)
     $$
  4. 对于任意的$a$，限制$\left.E_a\right|_{P_{\mathfrak{A}} \mathsf{H}}$ 属于代数 $B\left(\mathsf{H}^A\right) \otimes \mathbb{I}^B$，即
     $$
     E_a P_\mathfrak{A}=(\tau^A_a\otimes \mathbb{I}^B )P_\mathfrak{A},\forall a.
     $$
     作为推论，$P_{\mathfrak{A}} \mathsf{H}=\mathsf{H}^A \otimes \mathsf{H}^B$是$E_a$的不变子空间。
  5. 对任意ONB，$\{P_{kl}\}$，存在$\lambda_{akl}$，使得
     $$
     P_{k k} E_a P_{l l}=\lambda_{a k l} P_{k l} \quad \forall a, k, l
     $$
     以及
     $$
     E_a P_{\mathfrak{A}}=P_{\mathfrak{A}} E_a P_{\mathfrak{A}} \quad \forall a
     $$

**证明**
- 比较显然的几个蕴含关系$(1)\implies (2),(1)\implies (3) ,(4)\iff (5)$。

**笔记**
- 对于平凡的子系统$A$，$P_\mathfrak{A}\mathsf{H}=\mathsf{H}^B$,$P_\mathfrak{A}=\mathbb{I}^B$，上述定理退化为无噪声子空间的等价刻画
  1. $B$是关于$\mathcal{E}$无噪声子空间，即
     $$
     \forall \sigma\in B(\mathsf{H}^B): \mathcal{E}\left(\sigma\right)= \sigma
     $$
  2. 同上一点。
  3. $$
     \forall \sigma\in B(\mathsf{H}^B): \left( \mathcal{P}_{\mathfrak{A}} \circ \mathcal{E}\right)(\sigma)=\sigma
     $$
  4. 对于任意的$a$，限制$\left.E_a\right|_{P_{\mathfrak{A}} \mathsf{H}}$ 属于代数 $\mathbb{C} \otimes \mathbb{I}^B$，是数乘算符。作为推论，$P_{\mathfrak{A}} \mathsf{H}= \mathsf{H}^B$是$E_a$的不变子空间。
  5. 存在$\lambda_a$，使得
     $$
     E_a \mathbb{I}^B =\lambda_{a } \mathbb{I}^B \quad \forall a
     $$
- 为什么第三点要加上一个到码空间的投影？ 投影保证了 $\mathrm{tr}_A$是定义良好的，如果去掉$P_\mathfrak{A}$转而在整个$B(\mathsf{H})$上定义$\mathrm{tr}_A(\cdot)=\sum_i \langle \alpha_i|\cdot |\alpha_i\rangle \otimes \mathbb{I}^B$实际上已经暗含了需要做投影。
- 如果信道推广为一般的量子操作可能要有较大的改动。
- 如果$\mathsf{K}=\{0\}$，那么

**定义：可纠正子系统**

- 给定三元组$(\mathcal{R}, \mathcal{E}, \mathfrak{A})$，称$\mathfrak{A}$的$B$系统关于错误$\mathcal{E}$是**可纠错的**，如果存在$B(\mathsf{H})$上的量子信道$\mathcal{R}$，使得
  $$
  \left(\operatorname{tr}_{A} \circ \mathcal{P}_{\mathfrak{A}} \circ \mathcal{R} \circ \mathcal{E}\right)(\sigma)=\operatorname{tr}_{A}(\sigma) \quad \forall \sigma \in \mathfrak{A}
  $$
  其中$\mathcal{P}_\mathfrak{A}(\cdot)=P_\mathfrak{A}\cdot P_\mathfrak{A}$，$P_\mathfrak{A}=\mathbb{I}^A\otimes \mathbb{I}^B$。

**定理：给定恢复操作时子系统码可纠错的充要条件**

- 设信道$\mathcal{R}=\{R_r\}$，信道$\mathcal{E}=\{E_a\}$，码空间$P_\mathfrak{A}\mathsf{H}=\mathsf{H}^A\otimes \mathsf{H}^B$，则$\mathfrak{A}$的$B$系统关于错误$\mathcal{E}$可以被$\mathcal{R}$纠正的充要条件是存在算符一系列$\tau_{ra}^A\in B(\mathsf{H}^A)$使得
  $$
  \left( R_rE_a-\tau^A_{ra}\otimes \mathbb{I}^B\right)P_\mathfrak{A}=0,~\forall a,r
  $$

**笔记**
- 类似子空间码，这个定理说明了只要纠正离散的噪声即可。

**推论：子系统码的错误离散化**

- 设信道$\mathcal{R}=\{R_r\}$，信道$\mathcal{E}=\{E_j\}$，码空间$P_\mathfrak{A}\mathsf{H}=\mathsf{H}^A\otimes \mathsf{H}^B$，如果$\mathcal{E}$能够被$\mathcal{R}$纠正，那么信道
  $$
  \mathcal{F}=\left\{F_i=\sum _{jk}E_j (N_{jk}^A\otimes \mathbb{I}^B)\right\}
  $$
  也能够被$\mathcal{R}$纠正，其中$N_{jk}^A\in B(\mathsf{H}^A)$。

**证明**
- $$
  R_rF_iP_\mathfrak{A} = \sum_{jk} R_r E_j(N_{ik}^A\otimes \mathbb{I}^B) P_\mathfrak{A} = \sum_{jk} R_r E_jP_\mathfrak{A}(N_{ik}^A\otimes \mathbb{I}^B) = \left(\sum_{jk} \tau_{rj}N_{ik} \otimes \mathbb{I}^B \right) P_\mathfrak{A} , ~\forall a,i
  $$

**定理：子系统码可纠正的等价刻画**

- $\mathcal{E}=\left\{E_a\right\}$是$B(\mathsf{H})$上的量子操作，$\mathsf{H}=(\mathsf{H}^A\otimes \mathsf{H}^B)\oplus \mathsf{K}$，$\mathfrak{A}$是码空间上的直积形式半群，下列等价
  1. $\mathfrak{A}$的$B$系统关于错误$\mathcal{E}$是可纠错的。
  2. 存在$B(\mathsf{H})$上的量子信道$\mathcal{R}$，存在$\sigma^{\prime A}\in B(\mathsf{H}^A)$，使得
     $$
     (\mathcal{R} \circ \mathcal{E})(\sigma^A\otimes \sigma^B)=\sigma^{\prime A}\otimes \sigma^B \quad \forall \sigma^{A}\in B(\mathsf{H}^A),\sigma^{ B}\in B(\mathsf{H}^B)
     $$
  3. 存在$B(\mathsf{H})$上的量子信道$\mathcal{R}$，使得
     $$
     (\mathcal{R} \circ \mathcal{E})(\sigma)=\sigma \quad \forall \sigma \in \mathfrak{A}_0= \mathbb{I}^{A} \otimes B\left(\mathsf{H}^{B}\right).
     $$
  4. 用任意ONB确定的$\left\{P_{k l}\right\}$，存在复数$\lambda_{a b k l}$使得
     $$
     P_{k k} E_a^{\dagger} E_b P_{l l}=\lambda_{a b k l} P_{k l} \quad \forall a, b, k, l
     $$
  5. 存在一组$\tau^A_{ab}\in B(\mathsf{H}^A)$使得[[nielsen2007AlgebraicInformationtheoreticConditions\|nielsen2007AlgebraicInformationtheoreticConditions]]
     $$
     P_\mathfrak{A}E_a^\dagger E_b P_\mathfrak{A}=\tau^A_{ab}\otimes \mathbb{I}^B\quad \forall a,b
     $$

**证明**
- $(4)\iff (5)$是显然的。
- $(5)\Rightarrow (3)$，显式地构造出恢复信道，在$\mathsf{H}^A$中取一组ONB~$\{|i\rangle\}$，$i=1,\ldots,m_A$，得到
  $$
  \frac{1}{m_A}(\langle i | \otimes \mathbb{I})P E_a^\dagger E_b P(|j\rangle \otimes \mathbb{I})=\frac{1}{m_A} \langle i |\tau_{ab}^A|j\rangle \mathbb{I}^B\equiv \lambda_{ij;ab} \mathbb{I}^B
  $$
  设量子操作$\mathcal{E}^\prime:B(\mathsf{H}^B)\rightarrow B(\mathsf{H})$，Kraus算符为$\{ \frac{1}{\sqrt{m_A}} E_b P(|j\rangle \otimes \mathbb{I}) \}$ ，利用定理，可知存在信道$\mathcal{R}^\prime$，使得$\mathcal{R}^\prime \mathcal{E}^\prime =\mathrm{id}_{\mathsf{H}^B}$，根据证明过程可知，$\mathcal{R}^\prime$的Kraus算符为$R^\prime_{ia}= F_{ia}^\dagger / \sqrt{d_{ia}}$。

**笔记**
- 与子空间码不同，可纠正的$\mathcal{E}$对应的$\mathrm{tr}(\mathcal{E}(\rho))$不一定与$\rho$无关，
  $$
  \begin{aligned}
  & \operatorname{tr}\left(\sum E_a^{\dagger} E_a \rho\right) \\
  =&\operatorname{tr}\left(\left(\sum \tau_{a a}\otimes \mathbb{I}^B\right) \sigma^A \otimes \sigma^B\right) \\
  =& \operatorname{tr}\left(\sum \tau_{a a}^A \sigma^A\right)
  \end{aligned}
  $$
- 从恢复信道的结构可以看出，恢复信道完全抹除了规范系统上的信息，它本质上是先将信息全部恢复到$\mathsf{H}^B$上，再将态以预先给定的方式拓展到$\mathsf{H}^A\otimes \mathsf{H^B}$上。
- 算例参见：`六比特稳定子子系统码.nb`。

当$\mathsf{K}$平凡($\mathsf{K}=\mathbb{C}$)时，可纠正的噪声有下面的表示[[nielsen2007AlgebraicInformationtheoreticConditions\|nielsen2007AlgebraicInformationtheoreticConditions]]
$$
\mathcal{E}=\mathcal{U} \circ\left( \mathcal{N}_A \otimes\mathcal{I}_B\right)
$$
可纠正的噪声都是辅助系统上的噪声直积上逻辑比特系统上的单位算符再复合$\mathsf{H}^A\otimes \mathsf{H}^B$上的幺正变换。

**摘要**
- 如何理解规范系统和逻辑系统之间的纠缠
- 恢复信道会保证末态一定回到直积和的形式吗？似乎不一定？如果不能，那纠错码还能够正常工作吗？在这种情况下如何定义恢复和解码映射？解码时求偏迹，导致纯态解码为混态。

我们还可以将信息编码到每一个直和项对应的空间中，得到经典与量子混合的子系统码 (caoNumericalRangesApplications, Chap.5)，[[grassl2017CodesSimultaneousTransmission\|grassl2017CodesSimultaneousTransmission]]。

### 稳定子形式的子系统码

参考[[dauphinais2024StabilizerFormalismOperator\|dauphinais2024StabilizerFormalismOperator]]。设编码空间为$\mathsf{H}$，$S$是稳定子群，码空间$\mathsf{C}$是被$S$中的元素稳定的态，设$\mathrm{dim}\mathsf{C}=N=2^n$，码空间的正交投影算符记为$P$，对于任意$g\in N(S)=C(S)$，有$gP=Pg$[^9]。设代数$\mathcal{A}=\{ a \in B(\mathsf{H}) \mid a P=P a \}$，那么$\mathcal{A}P=\{aP\mid a\in \mathcal{A}\}$是$B(\mathsf{C})$的子代数且支集是$\mathsf{C}$[^10]。码空间上有子系统结构，设存在$N(S)$有子集$G_0$和$L_0$满足下面的条件
1. $\operatorname{Alg}\left(G_0\right) P$和矩阵代数$M_{2^m}(\mathbb{C})$幺正等价，$\operatorname{Alg}\left(L_0\right) P$和矩阵代数$M_{2^k}(\mathbb{C})$幺正等价
2. $G_0$和$L_0$中各任取一个元素都相互对易。
3. 正规化子$N(S)=\langle S,i \mathbb{I},L_0,G_0\rangle$

定义**规范群**$G=\langle S,i \mathbb{I},G_0\rangle$以及**逻辑群**$L=\langle i \mathbb{I},L_0\rangle$。


---
**脚注**

[^9]: 等价地$PgP=gP$以及$QgQ=gQ$，其中$Q=\mathbb{I}-P$，又等价地$\mathsf{C}$和$\mathsf{C}^{\perp}$都是$g$的不变子空间。
[^10]: 代数的支集是如何定义的？

Of course. This is the final part of your notes, formatted with strict adherence to the original text.

---

## 海森堡表象的量子纠错；算符代数量子纠错 OAQEC

**定义：Effect与代数的可纠正性** [[beny2009QuantumErrorCorrection\|beny2009QuantumErrorCorrection]]

- 称一个算符，例如effect~$A$，在子空间$P \mathsf{H}$中关于噪声信道 $\mathcal{E}:B(\mathsf{H})\rightarrow B(\mathsf{H})$ 下**可纠正**，如果存在信道 $\mathcal{R}:B(\mathsf{H})\rightarrow B(\mathsf{H})$满足
  $$
  P(\mathcal{R} \circ \mathcal{E})^{\dagger}(A)P=PAP
  $$
- 称算符的集合，例如POVM集、operator system、冯诺依曼代数，$\mathfrak{A}$ **可（同时）纠正**，如果它的每一个effect都可以被同一个$\mathcal{R}$纠正。

**笔记**
- 定义中的式子可以等价地写成
  $$
  \mathcal{P}\circ (\mathcal{R} \circ \mathcal{E})^{\dagger}(A)=\mathcal{P}(A)
  $$
  $$
  (\mathcal{R} \circ \mathcal{E}\circ \mathcal{P})^{\dagger}(A)=\mathcal{P}(A)
  $$

**定理：正交投影算符可纠正的充要条件** (beny2009QuantumErrorCorrection, Th.3.3)

- 正交投影算符(sharp effect) $P:\mathsf{H}_0\rightarrow \mathsf{H}_0$， 在全空间$\mathsf{H}_1$中关于编码以及噪声的复合信道 $\mathcal{E}:B(\mathsf{H}_0)\rightarrow B(\mathsf{H}_1),~\mathcal{E}(\rho)=\sum_i E_i \rho E_i^\dagger$可纠正当且仅当
  $$
  \left[P, E_i^* E_j\right]=0 \quad \text { 任取} i, j
  $$

**笔记**
- 证明参见[海森堡表象下的纠错条件的讨论](https://www.birs.ca/workshops/2010/10w5005/files/kribs.pdf)，以及论文原文。恢复信道的显式表达式由Petz recovery map提供
  $$
  \mathcal{R}(\rho)=\mathcal{E} ^\dagger\left(\mathcal{E} (\mathbb{I})^{-1/2} \rho \mathcal{E} (\mathbb{I})^{-1/2}\right)
  $$
  根据线性性，如果两个正交投影被纠正，那么他们的凸线性组合(作为新的effect)也能够被同一个恢复信道纠正，因此所有可纠正的正交投影的凸包可以被纠正。集合
  $$
  \mathfrak{A}_{\mathcal{E}}\equiv \left\{A \in B\left(\mathsf{H}_1\right):\left[A, E_i^{\dagger} E_j\right]=0 \text { for all } i, j\right\}
  $$
  是一个冯诺依曼代数，而冯诺依曼代数中的effect的集合正是正交投影算符的凸包。因此$\mathfrak{A}_{\mathcal{E}}$中的effect都可以被纠正，$\mathfrak{A}_{\mathcal{E}}$包含了所有的可纠正的正交投影，且effect都生活在$\mathfrak{A}_\mathcal{E}$中的POVM都可以被同时纠正。$\mathfrak{A}_{\mathcal{E}}$被称为$\mathcal{E}$的**可纠正代数**，它完全由$\mathrm{span}\{E_i\}$确定。

**定义：可纠正代数**

两个值得考量的问题

**摘要**
- $\mathfrak{A}_\mathcal{E}$总是可以做$C^*$代数的分解？然后求得相应的子系统码？这是一种比子系统码的启发式定义更优的获得纠错码的方式？
- 由 (beny2009QuantumErrorCorrection, Th.4.2) 启发：如果operator system可纠正，而不是整个代数可纠正，在薛定谔表象下意味着什么？只有特定的态而不是所有的态能够恢复吗？在 薛定谔表象下，被保护的态一定构成子空间，在海森堡表象下，被保护的物理量一定构成整个代数？

实际上，对可纠正代数的定义稍作推广，有下面的定理：

**定理：算符代数可纠错的充要条件** (beny2007QuantumErrorCorrection, Th.9)

- 设 $\mathfrak{A}$ 是 $B( P \mathsf{H})$的子代数，$P$是$\mathsf{H}$上的正交投影算符，则下列等价
  1. $\mathfrak{A}$ 在子空间$P \mathsf{H}$ 中关于 $\mathcal{E}$ 可纠正，即存在信道$\mathcal{R}$，使得
     $$
     P(\mathcal{R} \circ \mathcal{E})^{\dagger}(A) P=P A P,~\forall A\in \mathfrak{A}
     $$
  2. $\left[ P E_i^{\dagger} E_j P , A\right]=0$ 任取 $A \in \mathfrak{A}$ 以及 $i, j$，即$\mathfrak{A}\subset \{PE_i^\dagger E_j P\}^\prime$。

**笔记**
- 直接取$P=\mathbb{I}$所得的$\mathfrak{A}$就是$\mathcal{E}$的可纠正代数$\mathfrak{A}_\mathcal{E}$。
- 根据对易子的性质可知$\mathfrak{A}$是一个冯诺依曼代数。

下面我们先取定一个纠错码，从$\mathsf{H}$中任意取一个子空间作为码空间，正交投影是$P$，然后讨论哪些代数$\mathfrak{A}$可以被纠正。

**摘要**
- 如果$P$取得非常好，交换子作为冯诺依曼代数正是码空间上的整个算符代数，即$\{PE_i^\dagger E_j P\}^\prime =B(P \mathsf{H})$，那么在定理中取$\mathfrak{A}\subset B(P \mathsf{H})$就可以使其可纠正。
- 当选取得稍微不那么好时，冯诺依曼代数$\{PE_i^\dagger E_j P\}^\prime$是一个因子，即中心是$Z(\{PE_i^\dagger E_j P\}^\prime )$一维的，那么根据定理，给定基底时，存在$U$，使得$U \{PE_i^\dagger E_j P\}^\prime U^\dagger = M_q(\mathbb{C})\otimes \mathbb{I}_k$，这时候我们得到一个子系统码，取$\mathfrak{A} \subset U M_q(\mathbb{C})\otimes \mathbb{I}_k U^\dagger$即可使其被纠正。
- 在最一般的情况下，有$U \{PE_i^\dagger E_j P\}^\prime U^\dagger = \bigoplus_i M_{q_i}(\mathbb{C})\otimes \mathbb{I}_{k_i}$，取$\mathfrak{A}\subset U \bigoplus_i M_{q_i}(\mathbb{C})\otimes \mathbb{I}_{k_i} U^\dagger$可以使其被纠正。

根据上面的分析可知，无论选择何种$P$都可以得到某种纠错码，仅仅是性能有所区别。为了获得尽可能好的纠错，通常三个包含号会取为等号。利用表象变换，算符的可纠错性等效地变为量子态的可纠错性，上述讨论的$\mathfrak{A}$的可恢复条件等价于子空间码、子系统码或者经典量子混合码的可纠错条件，下面三个推论会具体说明这一点。例如当取$\mathfrak{A}=B(\mathsf{H}^c)$时，$\mathfrak{A}$在子空间$P \mathsf{H}$关于噪声$\mathcal{E}$可纠错等价于
$$
\left(\mathcal{R}\circ \mathcal{E}\right)^\dagger|_{B{(\mathsf{H}^c)}}=\mathrm{id}
$$
做共轭转置可得
$$
\mathcal{R}\circ \mathcal{E} |_{B{(\mathsf{H}^c)}}=\mathrm{id}
$$
于是我们回到了薛定谔表象下的可纠正的定义。

**推论：子空间码可纠错的充要条件(代数形式)**

- 设编码映射为$V:\mathsf{H}_0\rightarrow \mathsf{H}_1$，编码信道$\mathcal{V}$，码空间$\mathsf{H}^c= V \mathsf{H}_0$，$B(\mathsf{H}^c)\equiv B(P \mathsf{H}_1) =\{VXV^\dagger \in B(\mathsf{H}_1)\mid X\in B(\mathsf{H}_0)\}$，噪声信道$\mathcal{E}\sim \{E_i\}$，则下列等价
  1. 纠错码$V$能够纠正$\mathcal{E}$；
  2. $B(\mathsf{H}^c)$ 在子空间$P \mathsf{H}$ 中关于 $\mathcal{E}$ 可纠正。

**证明**
- 根据定理，$B(\mathsf{H}^c)$在子空间$P \mathsf{H}$ 中 可纠正当且仅当
  $$
  \left[B\left(\mathsf{H}^c\right),P E_i^\dagger E_j P\right]=0
  $$
  这等价于
  $$
  PE_i^\dagger E_j P\propto P
  $$
  根据Knill-Laflamme定理，又等价于$V$纠正$\mathcal{E}$。

**笔记**
- 另参见讲义：`海森堡表象纠错Kribs.pdf`
- 为什么不说整个编码空间上的代数$B(\mathsf{H})$都可以纠正呢？这是因为定理中假设的前提就是$\mathfrak{A}$是$B(\mathsf{H}^c)$的子代数。实际上，$B(\mathsf{H}^c)$ 在子空间$P \mathsf{H}$ 中关于 $\mathcal{E}$ 可纠正与$B(\mathsf{H})$ 在子空间$P \mathsf{H}$ 中关于 $\mathcal{E}$ 可纠正是完全等价的，怎么说都一样！
- 除了命题中的等价刻画，下列也等价
  - $\{V^\dagger E_i^\dagger E_j V \}=B(\mathsf{H_0})^\prime=\mathbb{C}~\mathbb{I}_{\mathsf{H}_0}$，根据定义，这时候我们称，$B(\mathsf{H}_0)$是$\mathcal{E}\circ \mathcal{V}$的可纠正代数。
  - 任取$A\in B(\mathsf{H}^c)$，有$[A,PE_i^\dagger E_jP]=0$其中$P=VV^\dagger$，即$\left[B\left(\mathsf{H}^c\right),P E_i^\dagger E_jP\right]=0$
  - $\left[V B\left(\mathsf{H}_0\right) V^\dagger,P E_i^\dagger E_jP\right]=0$
  - $\left[B\left(\mathsf{H}_0\right), V^\dagger E_i^\dagger E_j V\right]=0$
  - $\left\{V^\dagger E_i^\dagger E_j V\right\}=B\left(\mathsf{H}_0\right)^{\prime}=\mathbb{C} \mathbb{I}_{\mathsf{H}_0}$
  - $V^\dagger E_i^\dagger E_j V= \lambda_{ij} \mathbb{I}_{\mathsf{H}_0}$
  找到这样的$P$等价于$E_i^\dagger E_j$在某组正交基下具有形式
  $$
  E_i^{\dagger} E_j=\left(\begin{array}{cc}
  \lambda_{i j} \mathbb{I} & A \\
  B & C
  \end{array}\right)
  $$
  注意$P \mathsf{H}$不必是$E_i^\dagger E_j$的不变子空间。

对编码空间做定理中的分解$\mathsf{H}=(\mathsf{H}^A\otimes \mathsf{H}^B)\oplus \mathsf{K}$，将$\mathfrak{A}$取为$\mathbb{I}^A\otimes B(\mathsf{H}^B)$，则有子系统码(算符纠错)的可纠错的充要条件。

**推论：子系统码可纠错的充要条件(代数形式)**

- $\mathcal{E}=\left\{E_a\right\}$是$B(\mathsf{H})$上的量子操作，$\mathsf{H}=(\mathsf{H}^A\otimes \mathsf{H}^B)\oplus \mathsf{K}$，下列等价
  1. $\mathcal{E}$发生在子系统$B$上的错误可以被纠正。
  2. 存在一组$\tau^A_{ab}\in B(\mathsf{H}^A)$使得
     $$
     P E_a^\dagger E_b P =\tau^A_{ab}\otimes \mathbb{I}^B \quad \forall a,b
     $$
  3. 矩阵代数$\mathbb{I}^A\otimes B(\mathsf{H}^B)$在$P \mathsf{H}$上关于$\mathcal{E}$可纠正。
  4. 对于任意的$F\in B(\mathsf{H}^B)$，$[\mathbb{I}^A\otimes F,P E_i^\dagger E_jP ]=0$

更一般地，可以得到经典量子混合纠错码（算符代数纠错码）可纠错的充要条件。

**推论：算符代数纠错码可纠错的充要条件**

- $\mathcal{E}=\left\{E_a\right\}$是$B(\mathsf{H})$上的量子操作，$\mathsf{H}=(\bigoplus_k\mathsf{H}^A_k\otimes \mathsf{H}^B_k)\oplus \mathsf{K}$，设正交投影算符$P$的支集是$\mathsf{K}^\perp$，$P_k$的支集是第$k$个“sector”$\mathsf{H}^A_k\otimes \mathsf{H}^B_k$，下列等价
  - $\mathcal{E}$发生在子系统$\mathsf{H}_k^A$上的错误可以被纠正。
  - 存在一组$\tau^{B}_{k;ij}\in B(\mathsf{H}^B)$使得，有
    $$
    PE_i^\dagger E_j P=\sum_k \mathbb{I}_k^A\otimes\tau^{B}_{k;ij}
    $$
    或等价地
    $$
    P_pE_i^\dagger E_j P_q=\sum_k \delta_{pq}\mathbb{I}_k^A\otimes \tau^{B}_{k;ij}
    $$
  - 代数$\bigoplus_k \mathbb{I}^A_k\otimes B(\mathsf{H}^B_k)$在$P \mathsf{H}$上关于$\mathcal{E}$可纠正。

作为算符代数纠错码的特殊情况，经典量子混合码要求每个sector的辅助系统$B$都是1维的，有下面的推论。

**推论：经典量子混合码可纠错的充要条件**

**笔记**
- 经典量子混合码$[[n,k:m,d\|n,k:m,d]]$中的$m$是指经典比特数，该纠错码有$2^m$个sector，注意与子系统码$[[n,k,r,d\|n,k,r,d]]$的规范比特数$r$进行区分。

## 近似量子纠错

近似量子纠错的实用性在于可以被用于构建量子开销低的近似纠错码、以及分析码在遭受无法纠正的噪声时的性能。一般性的讨论参见[[jayashankar2023AdaptiveQuantumCodes\|jayashankar2023AdaptiveQuantumCodes]], [[mandayam2012UnifiedFrameworkApproximate\|mandayam2012UnifiedFrameworkApproximate]], [[ng2010SimpleApproachApproximate\|ng2010SimpleApproachApproximate]]。更一般地讨论动力学回溯，动力学求逆的问题，参见[[lautenbacher2022ApproximatingInvertibleMaps\|lautenbacher2022ApproximatingInvertibleMaps]]。

**定义：Petz恢复映射** (wilde2013quantum, Sec.12.3)

- $\sigma\in B(\mathsf{H})$是半正定算符，$\mathcal{N}:B(\mathsf{H})\rightarrow B(\mathsf{H}^\prime)$是量子信道，定义**Petz恢复映射**$\mathcal{P}_{\sigma,\mathcal{N}}:B(\mathsf{H})\rightarrow B(\mathsf{H}^\prime)$
  $$
  \mathcal{P}_{\sigma, \mathcal{N}}(\cdot) \equiv \sigma^{1 / 2} \mathcal{N}^{\dagger}\left([\mathcal{N}(\sigma)]^{-1 / 2} \cdot [\mathcal{N}(\sigma)]^{-1 / 2}\right) \sigma^{1 / 2}
  $$
- 定义**旋转的Petz恢复映射**
  $$
  \mathcal{R}_{\sigma, \mathcal{N}}^{t}(Q) \equiv\left(\mathcal{U}_{\sigma,-t} \circ \mathcal{P}_{\sigma, \mathcal{N}} \circ \mathcal{U}_{\mathcal{N}(\sigma), t}\right)(Q)
  $$
  其中$\mathcal{U}_{\sigma, t}(M) \equiv \sigma^{i t} M \sigma^{-i t}$。

**定理：Petz恢复映射和量子纠错** (ng2010SimpleApproachApproximate)

- $P$是码空间的投影算符，$\mathcal{E}(\cdot)=\sum_i E_i\cdot E_i^\dagger$，有Knill-Laflamme条件成立，则任取码字$\rho$，
  $$
  \mathcal{P}_{P,\mathcal{E}}\circ \mathcal{E}(\rho)= \mathrm{tr}(\mathcal{E}(\rho )) \rho
  $$

## $[[5,1,3\|5,1,3]]$码的纠错性能数值模拟

数值计算参见：`[[ 5,1,3]] code纠错码的纠错性能.nb`。

### 稳定子生成元与纠错流程

$[]$纠错码$c:\mathsf{H}^c\rightarrow\mathsf{H}$将一个量子比特编码为5个，有4个稳定子生成元 (gottesman1998TheoryFaultTolerantQuantum, tab.2)，
$$
\begin{array}{l}
g_1= X\otimes Z\otimes Z\otimes X\otimes \mathbb{I} \\
g_2=\mathbb{I}\otimes X\otimes Z\otimes Z\otimes X \\
g_3=X\otimes \mathbb{I}\otimes X\otimes Z\otimes Z \\
g_4=Z\otimes X\otimes \mathbb{I}\otimes X\otimes Z \\
\end{array}
$$
5比特码可以横向实现泡利门、$H$门、$S$门[^11]。

纠错的主要流程如下
1. 将码字初始化为均匀叠加态$|\psi_L\rangle=(|0_L\rangle+|1_L\rangle)/\sqrt{2}$，记$\rho_0=|\psi_L\rangle\langle \psi_L|$
2. 码字的中的每一个比特在Jaynes-Cumings模型生成的噪声$\mathcal{E}$中演化一段时间成为一个被破坏的码字$\mathcal{E}(\rho)$。
3. 引入辅助比特，用容错的方式测量稳定子的值，4个稳定子的测量值$(g_1,g_2,g_3,g_4)$称为错误的症状。
4. 根据预设的错误模型和错误症状推断实际发生的错误，在JC模型产生的噪声中，比特数越少的错误发生概率越高，而5比特码恰好具有完美纠正单比特错误的特点，因此我们从症状的错误等价类中选出单比特的错误作为推断结果，即我们总是认为码字发生了单比特的错误。
5. 根据症状诊断结果作用恢复算符。
6. 回到第二步，循环若干次。

### 噪声模型

假设量子比特是与光场相互作用的二能级原子，每个比特的动力学演化满足主方程 (zeng2019quantum, (2.81))
$$
\frac{d \rho}{d t }=\frac{\Gamma}{2}\left(2 \sigma_{+} \rho \sigma_{- }-\sigma_{- } \sigma_{+} \rho-\rho \sigma_{- } \sigma_{+}\right)
$$
参数$\gamma=1-e^{-\Gamma t}$，$\sigma_+=(\sigma_x + i \sigma_y)/2$表示减少一个粒子，主方程的解是
$$
\rho(t)=\left(
\begin{array}{cc}
\frac{1}{2} (z-1) e^{-t\Gamma }+1 & \frac{1}{2} e^{-\frac{1}{2} \Gamma t} (x+i y) \\
\frac{1}{2} e^{-\frac{1}{2} \Gamma t} (x-i y) & -\frac{1}{2} (z-1) e^{-t \Gamma } \\
\end{array}
\right)
$$
其中$(x,y,z)$是$t=0$时刻的Bloch向量. 写成Kraus算符，有
$$
\rho(t)=E_{0} \rho_0 E_{0}^{\dagger}+E_{1} \rho_0 E_{1}^{\dagger}\equiv \mathcal{E}^{(1)}(\rho_0)
$$
其中，Kraus算符
$$
E_{0}=\left(\begin{array}{cc}1 & 0 \\ 0 & \sqrt{1-\gamma}\end{array}\right), \quad E_{1}=\left(\begin{array}{cc}0 & \sqrt{\gamma} \\ 0 & 0\end{array}\right)
$$
设单比特$\rho\in D(\mathsf{H})$上的量子信道$\mathcal{E}^{(1)}$按照$\mathcal{E}(t)(\rho^{\otimes 5 })=\mathcal{E}^{(1)}(\rho)^{\otimes 5}$拓展为多比特信道
$\mathcal{E}(t):D(\mathsf{H}^{\otimes 5 })\rightarrow D(\mathsf{H}^{\otimes 5 })$
对于一般的两个量子信道$\mathcal{C}_1$和$\mathcal{C}_2$，假设Kraus算符分别是$\{F_i\}_{i\leqslant m}$和$\{G_i\}_{i\leqslant n}$，则直积映射$\mathcal{C}_1 \otimes \mathcal{C}_2$的Kraus算符为$\{F_i\otimes G_j \}$，因此量子信道的直积仍然是量子信道。在第一轮噪声结束时，$\rho(t)=\mathcal{E}(t)(\rho_0)$。

[Image Placeholder: 稳定子生成元g1的容错测量电路 - image//2023-11-09-17-45-10.png]
[Image Placeholder: 所有4个稳定子生成元的容错测量电路 - image//2023-11-09-17-41-29.png]

### 症状提取与恢复

在第一轮噪声结束后，引入辅助比特，用容错的方式测量错误的症状$s=(g_1,g_2,g_3,g_4)$，以$g_1= X\otimes Z\otimes Z\otimes X\otimes \mathbb{I}$为例，辅助比特初始化为$|0\rangle$，当纠错码中的第一个比特为$\sigma_x$的$+1$本征态$|+\rangle$时，保持辅助比特不变，当第一个比特为$\sigma_x$的$-1$本征态$|-\rangle$时，翻转辅助比特，因此电路中作用在第一个比特和辅助比特(第六个)上的逻辑门是$H_1 \circ \mathrm{CNOT}_{1,6}\circ H_1$，对其他比特做类似的考虑，可以设计出测量$g_1$的电路。进而，对于每个稳定子都引入一个辅助比特，就得到了完整的症状测量电路[^12]。选取合适的时间和噪声强度使得$\gamma=0.15$，可以求得辅助比特的测量结果的概率分布，例如测量得到$(g_1,g_2,g_3,g_4)=(1,1,1,1)$的概率
$$
\Pr(|0000\rangle)=\mathrm{tr}\left(\prod_{i=1}^4\frac{1+g_i}{2}\mathcal{E}(\rho_0)\right)
$$
具体的概率分布如下图所示[^13]。

[Image Placeholder: 第一轮噪声过后稳定子测量的概率分布 - image//prplot.pdf]

测量稳定子之后，需要根据测量结果，即症状，推断实际发生的错误。通过暴力搜索可以得到以下的唯一一组恢复算符。

| 症状 | 恢复算符 | 症状 | 恢复算符 |
| :--- | :---: | :--- | :---: |
| $|0000\rangle$ | $\mathbb{I}$ | $|1000\rangle$ | $X_{2}$ |
| $|0001\rangle$ | $X_{1}$ | $|1001\rangle$ | $Z_{4}$ |
| $|0010\rangle$ | $Z_{3}$ | $|1010\rangle$ | $Z_{1}$ |
| $|0011\rangle$ | $X_{5}$ | $|1011\rangle$ | $Y_{1}$ |
| $|0100\rangle$ | $Z_{5}$ | $|1100\rangle$ | $X_{3}$ |
| $|0101\rangle$ | $Z_{2}$ | $|1101\rangle$ | $Y_{2}$ |
| $|0110\rangle$ | $X_{4}$ | $|1110\rangle$ | $Y_{3}$ |
| $|0111\rangle$ | $Y_{5}$ | $|1111\rangle$ | $Y_{4}$ |

循环上述的过程可以得到纠错码在周期性纠错内的纠错性能，如下图所示。

[Image Placeholder: 码的保真度 - image//rccodeword.pdf]
[Image Placeholder: 码的保真度 - image//cccodeword.pdf]

## 论文中的公式的证明

[Image Placeholder: 待整理：待证[[beny2011PerturbativeQuantumError\|beny2011PerturbativeQuantumError]],[[beny2010GeneralConditionsApproximate\|beny2010GeneralConditionsApproximate]],proj.p.35，数值验证：几种量子信道：....nb - image//2024-04-18-20-11-29.png]

# 松散的内容

- [[复杂系统\|复杂系统]]与量子纠错的联系还没有被任何人考虑过。或许先从热力学系统开始，然后进入[[复杂系统\|复杂系统]]。
- [[petz\|Petz]]的物理实现，是否可分？[[petz\|Petz]]能够被写成 $e^{Lt}$ 时序积分的形式？
- 有用的链接
  - [CodeTables.de](https://www.codetables.de/)
  - [Overview of Magma V2.27: Coding Theory](http://magma.maths.usyd.edu.au/magma/overview/2/27/20/#subsection_20_5)
  - CSS
    css码：Flag fault-tolerant error correction, measurement, and quantum computation for cyclic Calderbank-Shor-Steane codes

---
**脚注**

[^11]: 是否可以实现$\mathrm{CNOT}$，就像7比特码一样？
[^12]: 通过合理的设计电路，可以减少辅助的比特数[[chao2018twoextra\|chao2018twoextra]]。
[^13]: 这个图具有某种对称性。