---
{"dg-publish":true,"permalink":"/1 Stories of Bizzo's Life/5 量子科学和量子技术/33 量子因果结构/","tags":["不定因果与因果结构"]}
---


> [!quote] 
>  Young man, in mathematics you don’t understand things. You just get used to them.
>    ——John von Neumann
>   以后种种譬如往日死，从前种种譬如来日生。
{ #w52fx1}


    
> [!abstract] Contents
> - 过程矩阵

## 引入

参考[[ball2017HowQuantumTrickery\|ball2017HowQuantumTrickery]]。在日常生活的经验中，任何事件的发生都有确定的因果顺序，穿上鞋子之前我一定先穿上了袜子。即便在正统的量子力学中，我们也完整地继承了牛顿时空观，例如在纠缠粒子对的测量实验中，我们仍然假设$B$观察到的效应发生在$A$进行测量之后，$A$不可能对她测量之前的物理状态产生影响。然而人们发现量子力学可能比原来所认识到的更加奇怪，两个事件的发生可能可以没有确定的因果关系甚至没有确定的时间顺序，量子信道的不同发生顺序、演化方向可以被相干地叠加，分别对应量子开关和量子时间翻转[[stromberg2024ExperimentalSuperpositionQuantum\|stromberg2024ExperimentalSuperpositionQuantum]]，这两个违反因果顺序的现象都已经在实验上被实现了。在具有不定因果的实验情景下谈论哪件事情是原因、或者哪件事情发生在前是没有意义的。

因果关系本质上就是关于事物在时间和空间之间相互影响关系，所以新的因果理论有助于量子力学和相对论的融合。我们需要更加深入地思考和研究量子因果结构，构建更加完善和激进的因果理论来解释这些奇怪的现象。与此同时，操纵不定因果将帮助我们在加速量子计算、提高精密测量精度方面更进一步，不定因果关系在量子通信、反转量子动力学、量子热力学方面都有应用\footnote{前面所有这些应用，参考[[antesberger2024HigherOrderProcessMatrix\|antesberger2024HigherOrderProcessMatrix]]的引言部分。}。

探索不定因果结构之前、我们先要对经典和量子因果结构有一定的了解。首先需要辨析因果和关联这两个概念，在本章中，关联意味着因果，无因果意味着无关联，因为我们需要用因果关系来解释这些个关联。导致关联的因果可能是直接或非直接直接的，对两个事件的关联存在5中基本的因果解释{（[[allen2017QuantumCommonCauses\|allen2017QuantumCommonCauses]] Sec.II.A）}，这一因果解释被称为Reichenbach(莱辛巴赫)原理[[reichenbach1991DirectionTime\|reichenbach1991DirectionTime]]，这一原理是经典因果结果、经典因果推导的核心，被总结为定理{（[[allen2017QuantumCommonCauses\|allen2017QuantumCommonCauses]] Th.1）}。在量子理论中，这一原理将变得更加复杂，仍然以Bell检验为例，两个测量结果的相关性违反Bell不等式，不能用共同的原因来解释。用经典因果模型来解释Bell检验需要引入超光速等“微调”[[allen2017QuantumCommonCauses\|allen2017QuantumCommonCauses]]。量子因果模型参考[[allen2017QuantumCommonCauses,lorenz2020QuantumCausalStructure\|allen2017QuantumCommonCauses,lorenz2020QuantumCausalStructure]]等。

经过对不定因果过程的不断研究，产生了许多有用的物理概念，帮我们更精细地对不定因果现象进行分类和刻画
\begin{itemize}
    \item 固定因果顺序的过程。量子梳。各个观测者有预先确定的全序，时间轴上靠后的人不能向靠前的人通信。
    \item 因果可分过程。对两体过程来说，因果可分过程就是两种可能的顺序过程矩阵的经典线性叠加(可能超过两项)，已经证明可幺正拓展的两体过程都是因果可分的[[barrett2021CyclicQuantumCausal\|barrett2021CyclicQuantumCausal]]。对于多体过程，参见[[wechs2019DefinitionCharacterisationMultipartite\|wechs2019DefinitionCharacterisationMultipartite]]。
    \item 因果不可分过程。不是因果可分的过程。例如(三体（[[ognyanoreshkov2019TimedelocalizedQuantumSubsystems\|ognyanoreshkov2019TimedelocalizedQuantumSubsystems]] (10)）或四体版本)量子开关（量子开关可以被视为四节点幺正过程，因此它作为两节点过程是可幺正拓展的，进而是因果可分的，这与三体或者四题量子开关不可分之间并不矛盾）。
    \item 非因果过程。违反因果不等式的过程。当前的对于不定因果过程能否实现的争议主要集中在那些非因果的过程，有人提出了用时间非局域的过程来在实验上“实现”那些非因果的过程，已经证明存在三体非因果过程，能够用时间非局域子系统的方式来实现[[wechs2023ExistenceProcessesViolating\|wechs2023ExistenceProcessesViolating]]。**时间非局域子系统**(delocalised)：对于多个不同时刻的Hilbert空间的张量积$\mathsf{H}\equiv \bigotimes \mathsf{H}_{t_i}$，对$\mathsf{H}$选取新的张量积结构，如果新的张量积因子(子系统)没有确定的时间，则称其为时间非局域子系统。
    \item 可幺正拓展的过程，可以通过加入辅助系统，使得过程矩阵拓展为幺正信道的过程。这些过程被认为是能够在实验上实现的必要条件，因为它保持了量子操作的可逆性，也就是说，当你在每个插槽插入幺正信道的时候，可幺正拓展的过程会返回给你一个幺正信道[[wechs2023ExistenceProcessesViolating\|wechs2023ExistenceProcessesViolating]]。
    \item \includegraphics[width=0.6\textwidth]{image//2025-05-15-16-16-29.png}
\end{itemize}

部分定理和命题使用两种不同的蔡氏矩阵的定义，使得节点的排序发生一些变化，但实际上只要对每个Hilbert空间进行命名，其排序并不重要，不同的顺序之间只相差一个局域幺正变换（与symmetric monoidal category、braided monoidal category的关系？）。

## 高阶量子映射与过程矩阵
\myemphg{问题}：与量子张量网络的关系是什么？张量网络通常是指量子梳，具有确定因果顺序的(一种没有完全确定因果结构的约束，可以用投影算符刻画)，而过程矩阵通常不需要具有确定的因果结构。

通常使用[[链积\|链积]]用于缩并过程矩阵。
### 定义与等价刻画
> [!definition] [[量子超信道\|量子超信道]] (superchannel) 和[[过程矩阵\|过程矩阵]] (process matrix)
> \label{def:superchannelprocessmat}
>
> 设
> $$
> f:\Pi_{i=1}^nB(B(A_i^\mathrm{in}),B(A_i^\mathrm{out}))\rightarrow B(B(P),B(F)),\quad (\mathcal{E}_1,\ldots,\mathcal{E}_n)\mapsto \mathcal{M}
> $$
> 是多线性映射。  
> 
> 利用多线性映射和张量积上线性映射的自然一一对应关系（张量积的泛性质），得到线性映射
> $$
> f^{(0)}:\bigotimes_{i=1}^n B(B(A_i^\mathrm{in}),B(A_i^\mathrm{out}))\rightarrow B(B(P),B(F)),\quad 
> \mathcal{E}_1\otimes \ldots\otimes \mathcal{E}_n\mapsto \mathcal{M}
> $$
>
> 将 $f$ 视为蔡氏矩阵层面上的映射，得到
> $$
> f^{(1)}\equiv \mathsf{CJ} \circ f^{(0)} \circ \mathsf{CJ}^{-1} :
> B\!\left(\bigotimes_{i=1}^n A_i^{\text{out}} \otimes A_i^{\text{in*}}\right)\rightarrow B(F \otimes P^*), \quad
> \rho^{\mathcal{E}_1}\otimes \ldots\otimes \rho^{\mathcal{E}_n}\mapsto \rho^\mathcal{M}
> $$
>
> $f^{(1)}$ 的蔡氏矩阵为
> $$
> f^{(2)}= \mathsf{CJ}(f^{(1)}) \in B\!\left(F \otimes P^* \otimes \bigotimes_{i=1}^n A_i^{\text{out*}} \otimes A_i^{\text{in}}\right)
> $$
>
> 下列条件等价：
> 1. $f^{(0)}$ 是 **CCP** (completely completely positive)，即 $f^{(0)} \otimes \mathrm{id}$ 保持全正性。  
> 2. $f^{(1)}$ 是 **CP** (completely positive)，即 $f^{(1)}\otimes \mathrm{id}$ 是正的。  
> 3. $f^{(2)}$ 是 **P** (positive) 的。  
>
> 上述任意一点成立时，称 $f$ 是（不一定保迹的） **超信道** (superchannel)，称 $f^{(2)}$ 为 $f$ 的 **过程矩阵** (process matrix)。



> [!proof]
> - 两次使用蔡氏定理\ref{th:choistheorem}。


- 使用范畴论的语言，无论是量子态、量子信道还是超信道都可以被视为态射。
- 关于超信道的更多性质，参见[[Fundamental Limitations on the Recoverability of Quantum Processes\|文献]]和 [1808.02607](https://arxiv.org/pdf/1808.02607) 
-  [[量子超信道\|量子超信道]]中的定义添加了保保迹性，即保TP。

定义投影超信道。在考虑量子过程矩阵的情境下，下面的定义是常用的。
> [!definition] 算符系统上的投影{{\cite[Def.3.2.7
> - {hoffreumon2023CharacterizationHigherorderQuantum}}}]\label{def:projectchannelof}
>
>   设$>   \mathcal{P}_A \in B\left(B\left(\mathsf{H}^A\right), B\left(\mathsf{H}^A\right)\right)
>$，如果$\mathcal{P}_A$满足
>
$$
\begin{gathered}
\mathcal{P}_A \circ \mathcal{P}_A=\mathcal{P}_A ; \\
\mathcal{P}_A^\dagger=\mathcal{P}_A ; \\
\mathcal{P}_A \circ \dagger \circ \mathcal{P}_A=\dagger \circ \mathcal{P}_A ; \\
\mathcal{P}_A \circ \mathcal{D}_A=\mathcal{D}_A,
\end{gathered}
$$
>   则称其为**算符系统上的投影**，其中$\mathcal{D}_A$是系统$A$上的完全退极化信道。

> [!note]
> - \myemph{问题}： $\mathcal{P}_A$是投到(某个？)算符系统上的投影操作。一定是全正的吗？

> [!definition] 完全退极化信道
> - \label{def:completelydepolarizing}
>   设线性映射$\mathcal{D}_A(\rho)\in B(B(\mathsf{H}^A),B(\mathsf{H}^A))$，**退极化信道**定义为
> $$\mathcal{D}_A\left(\rho\right)\equiv {}_A(\rho)\equiv \frac{\mathbb{I}_A}{d_A} \operatorname{tr}\left(\rho\right)$$
>   有时将$\mathcal{D}_A(\cdot)$记为${}_A(\cdot)$，这个记号来自[[araujo2015WitnessingCausalNonseparability\|araujo2015WitnessingCausalNonseparability]]。

将超信道中的输出空间设为平凡的\footnote{又或者将$P$和$F$视为两个普通的节点}，即$P=F=\mathbb{C}$，就得到了过程矩阵的数学形式，可以认为一个量子过程由一些节点$\{A_i\}$构成，每个节点各有一个输入和输出空间，每个节点代表一个局域量子实验室[[araujo2015WitnessingCausalNonseparability\|araujo2015WitnessingCausalNonseparability]]，在数学上用一个仪器来表示，这些测量用仪器(定义\ref{def:instrument})表示。量子过程描述了发生在环境的、不受实验室控制的所有过程，它提供了从局部实验室对外部环境施加的干扰，也即测量结果，到概率分布的映射{（[[hoffreumon2023CharacterizationHigherorderQuantum\|hoffreumon2023CharacterizationHigherorderQuantum]] Sec.1.1）}。

在最典型的链式因果结构中，过程矩阵描述了从某个系统的初态出发，经历一连串量子节点和节点之间的量子测量的过程。量子过程矩阵给出了测量得到相应结果的概率，量子过程矩阵是量子态的推广，它将初态和节点之间的的信息包含在内，而概率公式是Born规则的推广。从这个角度看，过程矩阵是量子理论的高阶推广，更多关于量子态的高阶推广的内容参见{（[[hoffreumon2023CharacterizationHigherorderQuantum\|hoffreumon2023CharacterizationHigherorderQuantum]] Sec.3）}。这也说明了并非所有的超信道都是物理上可以实现的，合法的一个必要条件是满足概率归一化条件\footnote{对过程矩阵做概率的次归一化推广可以定义所谓的“概率过程矩阵”，参见[[wechs2021QuantumCircuitsClassical\|wechs2021QuantumCircuitsClassical]]。}。概率的归一化将量子过程限制到了正定矩阵空间的一个子空间上，回避了因果矛盾等问题，这启发了下面的定义。

> [!definition] 概率归一化的过程矩阵(算符){\cite[Def.3.7
> - {lorenz2020QuantumCausalStructure}}]\label{def:processmatrix}
>   设有一些节点$S=\{A_1,\ldots ,A_n\}$，和相应的Hilbert空间$A_i^\mathrm{in}\equiv \mathsf{H}_{A_i^\mathrm{in}}$，$A_i^\mathrm{out}\equiv\mathsf{H}_{A_i^\mathrm{out}}$。
>   设$\{\mathcal{E}^{k_{A_i}}: B\left( {A_i^{\text {in}}}\right) \rightarrow B\left(A_i^{ \text {out}}\right)\}$是节点$A_i$上的仪器(定义\ref{def:instrument})。
>   
>
> - 仪器的元素的转置的蔡氏矩阵为 $\mathcal{E}^{A_i}\equiv \sum_{k_{A_i}} \mathcal{E}^{k_{A_i}}$，$\tau_A^{k_A}\equiv \mathsf{CJ}(\mathcal{E}^{k_A})^\top=(\rho_{A^\mathrm{out}|A^{\mathrm{in}}}^{\mathcal{E}^{k_{A}}})^\top \in B({A^{\mathrm{out}*}}\otimes  {A^\mathrm{in}})$，类似地，仪器的转置的蔡氏矩阵为$\tau_A\equiv (\rho^{\mathcal{E}^A}_{A^\mathrm{out}|A^{\mathrm{in}}})^\top \in B\left( {A^{\mathrm{out}*}}\otimes  {A^\mathrm{in}}\right)$，
>
>   定义在节点上的**量子过程矩阵**是一个正定矩阵，
> $$
\sigma_{A_1 \ldots A_n} \in B\left(\bigotimes_{i=n}^1 A_i^{{ \text {out}}*} \otimes  {A_i^{\text {in}}}\right)
\equiv B\left(\bigotimes_{i=n}^1 A_i^{{ \text {o*i}}} \right)$$
>   且对任何给定的一族仪器$\{ \mathcal{E}^{A_i}\}$，满足概率归一化条件
> $$\sigma_{A_1 \ldots A_n}\star \bigotimes_{i= n}^1 \rho_{A_i^\mathrm{out}|A_i^{\mathrm{in}}}^{\mathcal{E}_A}\equiv \operatorname{tr}\left[\sigma_{A_1 \ldots A_n}\left(\tau_{A_n} \otimes \ldots \otimes \tau_{A_1}\right)\right]= 1$$
>   eq-eq-normalofprocessmatrix-1
> - 


> [!note]
> - 这里的约定 $\tau_A$ 的起点终点和 {（[[lorenz2020QuantumCausalStructure\|lorenz2020QuantumCausalStructure]] (3.6)）} 相反，我认为是他混淆了蔡氏矩阵的两种定义。  
>   实际上，当每个子系统都有恰当的标记的时候，顺序并不重要。通过加入合适的幺正变换，我们可以轻易地在不同的子系统排列顺序之间切换。  
>   顺序不重要这一点，恰好体现了 **不定因果顺序**。
>
> - 过程矩阵可以被视为 **高阶量子映射的蔡氏矩阵**。
>
> - **问题**：量子过程矩阵在何种意义下是全正的？  
>   除了作为信道 $\mathcal{P}:B(\bigotimes_i A_i^{\mathrm{out}} )\rightarrow B( \bigotimes_i A_i^{\mathrm{in}} )$？  
>   与 comb 的全正性进行比较？是否无论怎么划分空间、都能得到全正的映射？
>
> - **问题**：能否做进一步的推广，使得测量不是直积的形式？  
>   推广为拿两个过程做链积？  
>   这种推广已经被建立，被称为 **多轮过程矩阵** [[hoffreumon2021MultiroundProcessMatrix\|hoffreumon2021MultiroundProcessMatrix]]。  
>   多轮过程矩阵可以被视为特殊的过程矩阵，而过程矩阵也可以被视为特殊的多轮过程矩阵。  
>   更进一步的问题：如果观测者进行的多轮观测是所谓的经典控制的量子线路 QC-CC，多轮过程矩阵应该如何定义，又有怎样的等价刻画？
>
> - **问题**：过程矩阵谱分解可以得到 Kraus 算符。  
>   Kraus 算符受到的约束是怎样的？能否做类似定理 \ref{th:krausofcomb} 的推导？
>
> - 概率归一化的过程矩阵的定义体现了所谓的 **“无限制假设”** {（[[hoffreumon2023CharacterizationHigherorderQuantum\|hoffreumon2023CharacterizationHigherorderQuantum]] p.25）}（no-restriction）：  
>   一个过程矩阵是有效的，当且仅当对于试验者所有的干扰都给出合法的概率分布。  
>   与所谓的“鸭子测试”类似。

由于蔡氏矩阵存在两种不同的约定(参见定理\ref{th:cjinso}和命题\ref{prop:inverseofcj})，量子过程矩阵有两种不同的顺序的定义。另一种定义如下。设仪器的元素的转置的蔡氏矩阵为 $\mathcal{E}^{A_i}\equiv \sum_{k_{A_i}} \mathcal{E}^{k_{A_i}}$，$\tau_A^{k_A}\equiv \mathsf{CJ}(\mathcal{E}^{k_A})^\top= (\rho_{A^\mathrm{out}|A^{\mathrm{in}}}^{\mathcal{E}^{k_{A}}})^\top \in B( {A^\mathrm{in}} \otimes  {A^{\mathrm{out}*}})$，类似地，仪器的转置的蔡氏矩阵为$\tau_A\equiv (\rho^{\mathcal{E}^A}_{A^\mathrm{out}|A^{\mathrm{in}}})^\top \in B( {A^\mathrm{in}} \otimes  {A^{\mathrm{out}*}})$，

定义在节点上的**量子过程矩阵**是一个正定矩阵，

$$\sigma_{A_1 \ldots A_n}\star \bigotimes_{i= 1}^n \rho_{A_i^\mathrm{out}|A_i^{\mathrm{in}}}^{\mathcal{E}_A}\equiv \sigma_{A_1 \ldots A_n} \in B\left(\bigotimes_{i=1}^n A_i^{{\text {in}}} \otimes  {A_i^{\text {out}*}}\right)     \equiv B\left(\bigotimes_{i=1}^n A_i^{{ \text {io*}}} \right)$$
   且对任何给定的一族仪器$\{ \mathcal{E}^{A_i}\}$，满足概率归一化条件
 $$\operatorname{tr}\left[\sigma_{A_1 \ldots A_n}\left(\tau_{A_1} \otimes \ldots \otimes \tau_{A_n}\right)\right]= 1$$
  简记为$\mathrm{tr}(\sigma_S \tau_S)=1$。
  
---

概率关于测量结果，即仪器中的元素，是线性函数，利用CJ同构，概率是关于仪器的元素的蔡氏矩阵的线性函数。由于通常只考虑仪器之间的凸线性叠加，所以线性和反线性没有区别。

使用第二种约定，从过程矩阵得到测量结果出现的概率的公式(推广的Born规则)是
$$
P\left(k_{A_1}, \ldots, k_{A_n}\right)=Pr\left(  \tau_{A_1}^{k_{A_1}}, \ldots, \tau_{A_n}^{k_{A_n}}\right)=\operatorname{tr}\left[\sigma_{A_1 \ldots A_n}\left(\tau_{A_1}^{k_{A_1}} \otimes \cdots \otimes \tau_{A_n}^{k_{A_n}}\right)\right]
$$
过程矩阵的正定性保证了概率都是正的，反之，如果要求对于任何蔡氏矩阵，概率都是正的，那么过程矩阵也是正的(待证)。

进一步的研究发现、可能并不是所有的概率归一化的过程都是合法的，我们还需要可逆性，这被归结为可幺正拓展性。

> [!definition] 量子过程的可幺正拓展性 Def.5 - [[barrett2021CyclicQuantumCausal\|barrett2021CyclicQuantumCausal]]
>   称量子过程 $\sigma_{A_1 \ldots A_n}$ **可幺正拓展**当且仅当存在幺正过程 $\sigma_{A_1 \ldots A_n P F}=$ $\rho_{A_1 \ldots A_n F \mid A_1 \ldots A_n P}^{\mathcal{U}}$ 使得   $\sigma_{A_1 \ldots A_n}=$ $\operatorname{tr}_{F P}\left[\sigma_{A_1 \ldots A_n P F} \tau_P\right]$ ，存在某个 $\tau_P \in B\left(\mathsf{H}_{P^{\text {out}}}^*\right)$。称过程 $\sigma_{A_1 \ldots A_n P F}$ 与 $\sigma_{A_1 \ldots A_n}$的**幺正拓展**。

> [!note]
> - \myemph{问题}：幺正拓展和线路实现的关系是？对于一个一般的量子过程，即便找到了幺正拓展，我（们）一般也不知道如何用量子线路来实现它。

> [!theorem] 两节点归一化过程的投影等价刻画 
> - $\sigma \in B(A^\mathrm{i}\otimes A^\mathrm{o*}\otimes B^\mathrm{i}\otimes B^\mathrm{o*})$是一个满足归一化条件的过程矩阵当且仅当
> $$W \geqslant 0, \operatorname{tr} W=d_{A^\mathrm{o}} d_{B^\mathrm{o}}, \text { and } W=L_V(W)$$ 
>   其中
>$$\begin{aligned}
L_V(W)  & ={ }_{A^\mathrm{o}} W+{ }_{B^\mathrm{o}} W-{ }_{A^\mathrm{o} B^\mathrm{o}} W-{ }_{B^\mathrm{i} B^\mathrm{o}} W+{ }_{A^\mathrm{o} B^\mathrm{i} B^\mathrm{o}} W-{ }_{A^\mathrm{i} A^\mathrm{o}} W+{ }_{A^\mathrm{i} A^\mathrm{o} B^\mathrm{o}} W
\end{aligned}$$
>
>   eq-eq-2pointprocess
{ #bpkrmc}


> [!proof]
> - 参见{（[[araujo2015WitnessingCausalNonseparability\|araujo2015WitnessingCausalNonseparability]] (B.20)）}。

> [!note]
> - 三节点以及$n$节点在[[araujo2015WitnessingCausalNonseparability\|araujo2015WitnessingCausalNonseparability]]中有相似的证明。

- 实际上$W$对应了一个从$A^oB^o$到$A^i B^i$的信道，即存在信道$\mathcal{W}:B(A^oB^o)\to B(A^i B^i)$，使得 $$W = \mathcal{I}\otimes \mathcal{W}(|\mathbb{I}\rangle\langle\mathbb{I}|)$$
- 这实际上要求$L_V$对应的子空间比$P = \mathcal{I}- \mathcal{D}_{A^iB^i}$对应的空间更小，即 
$$L_VP=L_V$$
上式是一个简单的代数计算，详见：重新投影刻画.nb


对命题\ref{prop:inverseofcj}中的过程矩阵的例子的记号稍加改动，我们有下面的例子。

> [!example] 测量-演化-测量的量子过程矩阵
> \label{ex:quantumprocess2}
>
> 超映射为
> $$
> (\cdot)\circ \mathcal{C}\circ (\cdot):(\mathcal{E}^{A_1},\mathcal{E}^{A_2})\mapsto \mathcal{E}^{A_2}\circ \mathcal{C}\circ \mathcal{E}^{A_1},
> $$ 
根据张量积的[[泛性质\|泛性质]]，对于任何在两个向量空间 $V \times W$ 上双线性的映射
$$
B: V \times W \rightarrow U
$$
都唯一存在的线性映射
$$
\widetilde{B}: V \otimes W \rightarrow U
$$
使得 $\widetilde{B}(v \otimes w)=B(v, w)$ 并对任意线性组合扩张成立。因此，只要你确定
$$
B(\mathcal{A}, \mathcal{B})=\mathcal{A C B}
$$
对于每个 $\mathcal{A}$ 和 $\mathcal{B}$ 关于各自线性（固定 $\mathcal{C}$ ），就必然存在唯一的线性算子 $\mathcal{L}_{\mathcal{C}}$ 在代数张量积上满足
$$
\mathcal{L}_{\mathcal{C}}(\mathcal{A} \otimes \mathcal{B})=\mathcal{A C B},
$$
并线性扩展到任意的 $\sum_i \mathcal{A}_i \otimes \mathcal{B}_i$ 。因此上述超映射等价于
$$(\cdot)\circ \mathcal{C}\circ (\cdot): \mathcal{M} = \sum_i \mathcal{A}_i\otimes \mathcal{B}_i\mapsto \sum_i \mathcal{A}_i\mathcal{C} \mathcal{B}_i$$
可以通过蔡氏矩阵显式地将$\mathcal{L}_\mathcal{C}$求出来。
下面回到过程矩阵相关的讨论。注意 $A_1$ 先于 $A_2$。现在假设$\mathcal{C}$是外界的过程，$A_1$和 $A_2$ 是两个局域是现实，下面利用复合信道的蔡氏矩阵公式来推导过程矩阵的表达式。 同样地，由于蔡氏矩阵存在两种不同的定义，例子也有两种不同的版本。
**版本一**  
设
$$
B\!\left(A_1^{\text{in}}\right) \xrightarrow{\mathcal{E}^{A_1}} B\!\left(A_1^{\text{out}}\right) 
\xrightarrow{\mathcal{C}} B\!\left(A_2^{\text{in}}\right) 
\xrightarrow{\mathcal{E}^{A_2}} B\!\left(A_2^{\text{out}}\right),
$$
则概率
$$
P(k_{A_1},k_{A_2})
=\mathrm{tr}\left(\mathcal{E}^{k_{A_2}}\circ \mathcal{C}\circ \mathcal{E}^{k_{A_1}}(\rho_{A_1^{\mathrm{in}}})\right)
=\mathrm{tr}\left( \sigma_{A_1A_2}\, \tau_{A_2}^{k_{A_2}}\otimes  \tau_{A_1}^{k_{A_1}} \right),
$$
其中
$$
\sigma _{A_1A_2}
=\mathbb{I}_{A_2^{\mathrm{out}*}}\otimes \mathsf{C}\otimes \rho_{A_1^\mathrm{in}}
=\mathbb{I}_{A_2^{\mathrm{out}*}}\otimes \rho^\mathcal{C}_{A_2^\mathrm{in}|A_1^\mathrm{out}}\otimes \rho_{A_1^\mathrm{in}}
\in B\!\left(A_2^{\text{out}*}\otimes A_2^{\text{in}}\otimes A_1^{\text{out}*}\otimes A_1^{\text{in}}\right).
$$

略去 $\mathrm{in}$、$\mathrm{out}$、单位阵和角标 $\mathcal{C}$，简记为
$$
\sigma_{A_1A_2}=\rho_{A_2|A_1}\rho_{A_1}.
$$
eq-eq-simplestcausalmodel


**版本二**  
设
$$
B\!\left(A_1^{\text{in}}\right) \xrightarrow{\mathcal{E}^{A_1}} B\!\left(A_1^{\text{out}}\right) 
\xrightarrow{\mathcal{C}} B\!\left(A_2^{\text{in}}\right) 
\xrightarrow{\mathcal{E}^{A_2}} B\!\left(A_2^{\text{out}}\right),
$$
则概率
$$
P(k_{A_1},k_{A_2})
=\mathrm{tr}\left(\mathcal{E}^{k_{A_2}}\circ \mathcal{C}\circ \mathcal{E}^{k_{A_1}}(\rho_{A_2^{\mathrm{in}}})\right)
=\mathrm{tr}\left( \sigma_{A_1A_2}\, \tau_{A_1}^{k_{A_1}}\otimes  \tau_{A_2}^{k_{A_2}} \right),
$$
其中
$$
\sigma _{A_1A_2}
=\rho_{A_1^\mathrm{in}}\otimes  \mathsf{C}\otimes\mathbb{I}_{A_2^{\mathrm{out}*}}
=\rho_{A_1^\mathrm{in}}\otimes  \rho^\mathcal{C}_{A_2^\mathrm{in}|A_1^\mathrm{out}}\otimes\mathbb{I}_{A_2^{\mathrm{out}*}}
\in B\!\left(A_1^{\text{in}}\otimes A_1^{\text{out}*}\otimes A_2^{\text{in}}\otimes A_2^{\text{out}*}\right).
$$

略去 $\mathrm{in}$、$\mathrm{out}$、单位阵和角标 $\mathcal{C}$，简记为
$$
\sigma_{A_1A_2}=\rho_{A_1}\rho_{A_2|A_1}.
$$

注意：无论何种记号，父节点总是出现在竖线的右侧（先），子节点总是出现在竖线的左侧（后）。  显然，两个因子都是对易的。


> [!example] Bell检验的过程矩阵
> 将 Bell 检验视为一个两节点过程，$A$ 和 $B$ 共享的量子态记为 $\rho^{AB}$，在数学上我们要找到
> $\sigma_{AB}\in B\!\left(A^{\text{in}}\otimes A^{\text{out}*}\otimes B^{\text{in}}\otimes B^{\text{out}*}\right)$ 满足
>
> $$
> \mathrm{tr}\!\big(\mathcal{A}\otimes \mathcal{B}(\rho^{AB})\big)
> =\mathrm{tr}\!\big(\sigma_{AB}\,\tau_{A}\otimes \tau_B\big)
> $$
>
> 其中 $\mathcal{A}$ 和 $\mathcal{B}$ 是任意全正映射（不必保迹），$\tau_A$ 和 $\tau_B$ 是相应蔡氏矩阵的转置。这实际上是在构造一个高阶映射
>
> $$
> \mathcal{L}: B(A^{\mathrm{i*}}\!\otimes A^{\mathrm{o}})\otimes B(B^{\mathrm{i*}}\!\otimes B^{\mathrm{o}})
> \rightarrow \mathbb{C},\quad
> \rho^\mathcal{A}_{A^{\mathrm{out}}|A^{\mathrm{in}}}\otimes \rho^\mathcal{B}_{B^{\mathrm{out}}|B^{\mathrm{in}}}
> \mapsto \mathrm{tr}\!\left(\mathsf{CJ}^{-1}(\rho^\mathcal{A})\otimes \mathsf{CJ}^{-1}(\rho^\mathcal{B})(\rho^{AB})\right)
> $$
>
> 的蔡氏矩阵。根据蔡氏矩阵的定义，
>
> $$
> \begin{aligned}
> \rho^\mathcal{L}
> &= (\mathcal{L}\otimes \mathbb{I})\!\left(|\mathbb{I}\rangle\langle\mathbb{I}|\right) \\
> &= \mathrm{tr}_{A^\mathrm{o}B^\mathrm{o}}\!\left(\mathsf{CJ}^{-1}\!\left(|ij\rangle\langle kl|\right)\!\otimes\!
> \mathsf{CJ}^{-1}\!\left(|pq\rangle\langle mn|\right)(\rho^{AB})\right)\,|ijkl\rangle\langle pqmn| \\
> &= \mathrm{tr}_{A^\mathrm{o}B^\mathrm{o}}\!\left(\mathsf{CJ}^{-1}\!\left(|ijkl\rangle\langle pqmn|\right)(\rho^{AB})\right)\,|ijkl\rangle\langle pqmn| \\
> &= \mathrm{tr}\!\left(\mathrm{tr}_{A^{\mathrm{i*}}B^{\mathrm{i*}}}\!\left(|ijkl\rangle\langle pqmn|\,\rho^{AB\top}\right)\right)\,|ijkl\rangle\langle pqmn| \\
> &= \mathrm{tr}_{A^{\mathrm{i*}}B^{\mathrm{i*}}}\!\left(|ij\rangle\langle pq|\,\rho^{AB\top}\right)\,|ij\rangle\langle pq|_{A^\mathrm{i*}B^\mathrm{i*}}\otimes \mathbb{I}_{A^\mathrm{o*}B^\mathrm{o*}} \\
> &= \rho^{AB}\otimes \mathbb{I} \;=\; \sigma_{AB}.
> \end{aligned}
> $$
>
> 注意：$\rho^{AB}$ 的转置是作用在系统 $A^{\mathrm{i*}}B^{\mathrm{i*}}$ 上；推导中用到了 $\mathsf{CJ}^{-1}$ 保持张量积的性质。相同的方法可用于量子开关（\switch）的过程矩阵推导。
>
> 将 Bell 检验过程视为一个四节点幺正过程（幺正性待证）：过去 $P$ 制备量子态，$A$、$B$ 执行测量，$F$ 将量子态舍弃，也可做类似推导。


利用过程矩阵的关于偏迹的性质，可以将过程矩阵本身视为某个信道的蔡氏矩阵。在式\eqref{eq:normalofprocessmatrix}中取$\tau_{A}=\tau_{A^{\mathrm{out}*}}\otimes \mathbb{I}_{A^\mathrm{in}}\in B\left( {A^{\mathrm{out}*}}\otimes  {A^\mathrm{in}}\right)$，则式\eqref{eq:normalofprocessmatrix}成为
$$
\mathrm{tr}_{\{A_i^\mathrm{out*}\}}\left(\mathrm{tr}_{\{A_i^\mathrm{in}\}}(\sigma_{A_1\ldots A_n}) \tau_{A_1^{\mathrm{out}*}}\otimes \cdots \otimes\tau_{A_n^{\mathrm{out}*}}\right)=1
$$
由$\tau_{A_i^{\mathrm{out}*}}$的任意性可知
$$
\mathrm{tr}_{\{{A_i^\mathrm{in}\}}}(\sigma_{A_1\ldots A_n})= \mathbb{I}_{A_1^{\mathrm{out}*}}\otimes \cdots \otimes \mathbb{I}_{A_n^{\mathrm{out}*}}
$$
由于过程矩阵是正定$\sigma_S\equiv \sigma_{A_1\ldots A_n}$的，所以存在一个信道$\mathcal{P}:B(\bigotimes_i A_i^{\mathrm{out}} )\rightarrow B( \bigotimes_i A_i^{\mathrm{in}} )$与$\sigma_S$对应，根据命题\ref{prop:inverseofcj}，
$$
\mathcal{P}(\rho_{A_i^\mathrm{out}\ldots A_n^\mathrm{out}})=\mathrm{tr}_{\{A_i^\mathrm{out*}\}}\left(\sigma_S \rho_{A_i^\mathrm{out}\ldots A_n^\mathrm{out}}^\top \right)
$$
此时我们可以将过程矩阵记为
$$
\sigma_{A_1\ldots A_n}=\rho^\mathcal{P}_{A_1^\mathrm{in}\ldots A_n^\mathrm{in}|A_1^\mathrm{out}\ldots A_n^\mathrm{out}}
$$
eq-eq-choiofsomechannelprocess

根据蔡氏矩阵的定义(定理\ref{th:cjinso})，将过程矩阵视为某个信道的蔡氏矩阵给出了计算过程矩阵的方法。

## 无限层级的高阶量子映射
- [[高阶量子映射\|高阶量子映射]] 
	- [[2 项目笔记/量子模拟项目/高阶量子映射的模拟\|高阶量子映射的模拟]]
	- [[高阶量子映射的储存\|高阶量子映射的储存]] 

## 量子梳
- [[量子梳\|量子梳]] 
## 量子因果与通信结构

> [!definition] 幺正过程
> - 当量子过程矩阵对应的信道是幺正信道时，称量子过程为**幺正过程**。

> [!note]
> - 幺正信道的一个容易检验的充分性条件：秩为1，且构成信道，将输出trace掉之后构成输入空间上的单位阵。

> [!definition] 不能发送信息（不能通信）
> - \label{def:nosignalling} 对于两节点过程$\sigma_{AB}$，下列等价{（[[barrett2021CyclicQuantumCausal\|barrett2021CyclicQuantumCausal]] p.3）}
>
> - 对于任何$\tau_A$，概率分布$P(k_A)=\operatorname{tr}\left[\sigma_{A B}\left(\tau_A^{k_A} \otimes \tau_B\right)\right]$与$B$节点处的干扰无关，即与$\tau_B$的选择无关。
> - $\sigma_{A B}=\sigma_{A B^{\text {in}}} \otimes \mathbb{I}_{B^{\text{out*}}}$
>   此时称**$B$不能向$A$送信**，记作$B\npreceq A$。

有的作者定义关于全正映射CPM的发信结构的时候采用一些看上去更简单的定义，改变输入的信道观察是否能够得到同一个信道，从而判断某个口能否向另一个口输出信息，[[Embedding cyclic information-theoretic structures in acyclic spacetimes no-go results for indefinite causality\| embed ICO]] def 10。

> [!proof]
> - $(\impliedby)$利用$\mathrm{tr}_{B^\mathrm{out*}}\tau_B=\mathbb{I}_{B^\mathrm{in}}$可得。
>
>   $(\implies)$根据两节点[[过程矩阵\|过程矩阵]]的刻画{（[[oreshkov2012QuantumCorrelationsNo\|oreshkov2012QuantumCorrelationsNo]] Sup.）}，
> $$\begin{aligned}
W^{A_1 A_2 B_1 B_2} & =\frac{1}{d_{A_1} d_{B_1}}\left(\mathbb{I}+\sigma^{B \preceq  A}+\sigma^{A \preceq  B}+\sigma^{A \npreceq \nsucceq    B}\right), \\
\sigma^{B \preceq A} & \equiv \sum_{i j>0} c_{i j} \sigma_i^{A_1} \sigma_j^{B_2}+\sum_{i j k>0} d_{i j k} \sigma_i^{A_1} \sigma_j^{B_1} \sigma_k^{B_2}, \\
\sigma^{A \preceq B} & \equiv \sum_{i j>0} e_{i j} \sigma_i^{A_2} \sigma_j^{B_1}+\sum_{i j k>0} f_{i j k} \sigma_i^{A_1} \sigma_j^{A_2} \sigma_k^{B_1}, \\
\sigma^{A \npreceq \nsucceq   B} & \equiv \sum_{i>0} v_i \sigma_i^{A_1}+\sum_{i>0} x_i \sigma_i^{B_1}+\sum_{i j>0} g_{i j} \sigma_i^{A_1} \sigma_j^{B_1}, \\
\text { where } c_{i j}, & d_{i j k}, e_{i j}, f_{i j k}, g_{i j}, v_i, x_i \in \mathbb{R} .
\end{aligned}$$ 
>
>   eq-eq-chaoftwopointporcess
>
>   上式中的1和2分别对应$\mathrm{in}$和$\mathrm{out}$，$P(k_A)$与$\tau_B$无关意味着$\sigma^{B \preceq A}=0$。

> [!note]
> - $A$先于$B$发生时，$B$不能向$A$送信。反之，即便$A$先于$B$发生($A$是$B$的原因)也不意味着$A$能够影响$B$，一个事件对未来的影响可能完全被随机性掩盖掉{（[[barrett2021CyclicQuantumCausal\|barrett2021CyclicQuantumCausal]] (2)）}，这在经典情形中也可以被理解，函数的值完全可能和输入的值无关，例如经典比特$A$和$C$的奇偶性决定$B$，如果$C$是均匀的零一分布，但的取值是未知的，那么$B$的分布也是均匀的零一分布，与$A$的值无关，量子情形的例子参见命题\ref{prop:nosignalingtofuture}。
>
>   如果将两节点过程的$A_1B_2$trace掉，或者将$A_2B_1$trace掉，观察哪些项会留下就能发现两体过程会退化为剩下的两个节点之间的合法信道，即单体的过程，不定因果性将消失。

摘自[[A de Finetti theorem for quantum causal structures\|A de Finetti theorem for quantum causal structures]] 
在$n$体过程矩阵中，在站点之间施加额外的因果假设——特别是无信号假设——可以通过向过程矩阵添加线性约束来实现。例如，对双部过程（bipartite process）的站点 A、B 施加无信号约束等价于 [45]： $$W = (\operatorname{Tr}_{A_O B_O} W) \otimes \mathbb{1}^{A_O B_O}, \qquad (9)$$类似地，从 **B 到 A 的单向无信号**对应以下线性约束：  （在此类表达式中，张量因子的顺序已隐含调整，这是初学者通常会碰到的困惑：为什么不同的蔡氏矩阵的约定不会导致不同的过程矩阵表达式？）
$$W = (\operatorname{Tr}_{B_O} W) \otimes \mathbb{1}^{B_O}, \qquad (10)$$ $$\operatorname{Tr}_{B_I B_O} W = (\operatorname{Tr}_{A_O B_I B_O} W) \otimes \mathbb{1}^{A_O}. \qquad (11)$$
上面的式(10)与不能通信的定义相同，(11)式是额外的（多余的）？类似的约束刻画了任意因果顺序站点序列 A, B, C, ... 的单向无信号。因果顺序过程，也称为具有记忆的量子信道 [91]、量子策略 [92] 和量子梳 [93–95]，总是可以实现为连接这些站点的信道序列，可能还需要添加一个辅助系统（环境），从而在因果顺序固定且已知的典型实验室场景中捕获最一般的开放系统动力学 [56–58]。更复杂的假设，例如站点之间的任意偏序关系，可以通过组合无信号约束来获得 [37, 40]。

> [!definition] 幺正信道和幺正过程的因果结构
> Def.3,4barrett2021CyclicQuantumCausal \label{def:causalstrucunitary}
>   给定幺正信道 $\rho_{C D \mid A B}^{\mathcal{U}}$,记 $A \nrightarrow D$**$(A$ 不能影响 $D)$**，当且仅当，存在边缘信道 $\mathcal{M}$，使得
> $$\operatorname{tr}_C\left[\rho_{C D \mid A B}^{\mathcal{U}}\right]=\rho_{D \mid B}^{\mathcal{M}} \otimes \mathbb{I}_{A^*}$$
>   或等价地
> $$\mathrm{tr}_C \circ \mathcal{U}=  \mathcal{M}\circ  \mathrm{tr}_A$$
>   如果$A$ 能够影响$D$，即对于任何信道$\mathcal{M}$，都有$$\operatorname{tr}_C\left[\rho_{C D \mid A B}^{\mathcal{U}}\right]\neq \rho_{D \mid B}^{\mathcal{M}} \otimes \mathbb{I}_{A^*}$$
>   或等价地$$\mathrm{tr}_C \circ \mathcal{U}\neq   \mathcal{M}\circ  \mathrm{tr}_A$$
>   称则$A$ 是$D$的**直接原因**(direct cause)，对于给定的幺正信道 $\rho_{C_1 \ldots C_l \mid B_1 \ldots B_k}^{\mathcal{U}}$ 有 $k$ 个输入和$l$ 个输出子系统，其**因果结构**是节点的因果关系的几何，用一个以$\{C_l\}$和$\{B_k\}$为节点的有向无圈图(DAG)表示，当$B_i$是$C_j$的直接原因时，存在箭头$B_i\rightarrow C_j$。
>
>   基于幺正信道的子系统之间的因果关系，可以定义幺正过程的节点之间的因果关系。
>
>   给定幺正过程 $\sigma_{A_1 \ldots A_n}=\rho_{A_1 \ldots A_1 \mid A_n \ldots A_n}^{\mathcal{U}}$，记 $A_j \nrightarrow A_i$ (节点 $A_j$ 不影响节点 $A_i$ )，当且仅当在幺正信道$\mathcal{U}$中， $A_j^{\text {out}}$ 不影响 $A_i^{\text {in}}$  。如果 $A_j$ 能够影响 $A_i$，那么 $A_j$ 是 $A_i$的直接原因。 幺正过程的**因果结构**是是节点之间的因果关系的几何，用以$\{A_i\}$为节点的DAG表示，当$A_j$是$A_i$的节点时，存在箭头$A_j \rightarrow A_i$ 。

> [!proof]
> - $A$不能影响$D$的定义的等价性的证明。（待证）

> [!note]
> - 对于两节点的幺正过程，设过程矩阵为$\sigma_{AB}=\rho^\mathcal{U}_{AB|AB}$，则$B\nrightarrow A$等价于
>   $B^\mathrm{out*}\nrightarrow  A^\mathrm{in}$等价于$\mathrm{tr}_{B^\mathrm{in*}}\left(\sigma_{AB}\right)=\rho^\mathcal{M}_{A^\mathrm{in}|A^\mathrm{out}}\otimes \mathbb{I}_{B^\mathrm{out*}}$。而$B\npreceq A$定义为$\sigma_{AB}=\sigma_{AB^{\mathrm{in}}}\otimes \mathbb{I}_{B^\mathrm{out*}}$。两个定义是等价的，先证$\implies$，根据式\eqref{eq:chaoftwopointporcess}可知，$\sigma^{B\preceq A}=0$，根据定义\ref{def:nosignalling}，这就是$B \npreceq A$；再证$\impliedby$，只要求迹再证明系统$\mathrm{tr}_{B^\mathrm{in}}(\sigma_{AB^\mathrm{in}})$是合法信道即可，正定性显然，只要检验保迹性，实际上利用式\eqref{eq:chaoftwopointporcess}，有$\mathrm{tr}_{A^{\mathrm{in}}B^\mathrm{in}}(\sigma_{AB^\mathrm{in}})=\mathrm{tr}_{A^\mathrm{out*}B}(\sigma_{AB})/d_{B^\mathrm{out*}}=\mathbb{I}_{A^\mathrm{out*}}$

> [!definition] 推广的量子因果模型 Quantum causal model-generalized Def.1;(4) barrett2021CyclicQuantumCausal
>   使用蔡氏矩阵的第二种约定。 A QCM is given by:
>
>   (1) a causal structure represented by a directed graph $G$ with vertices corresponding to quantum nodes $A_1, \ldots, A_n$,
>
>   (2) for each $A_i$, a quantum channel $\rho_{A_i \mid P a\left(A_i\right)} \in B\left(\mathsf{H}_{A_i^{\text {in}}} \otimes \mathsf{H}_{P a\left(A_i\right)^{\text {out}}}^*\right)$, where $\operatorname{Pa}\left(A_i\right)$ denotes the set of parents of $A_i$ according to $G$, such that $\left[\rho_{A_i \mid P a\left(A_i\right)}, \rho_{A_j \mid P a\left(A_j\right)}\right]=0$ for all $i, j$ and such that $\sigma_{A_1 \ldots A_n}=$ $\prod_i \rho_{A_i \mid P a\left(A_i\right)}$ is a process operator over the quantum nodes $A_1, \ldots, A_n$.
>
>   称量子因果模型是**忠实的**(faithful)，如果对于任何信道$\rho_{A_i|Pa(A_j)}$，每个$A_j\in Pa(A_i)$都能对$A_i$发信，即
>
$$
\rho_{A_i \mid P a\left(A_i\right)} \neq \frac{1}{d_j} \operatorname{tr}_{A_j^{\text{out*}}}\left(\rho_{A_i \mid P a\left(A_i\right)}\right) \otimes \mathbb{I}_{A_j^{\text{out*}}},~\forall ~j
$$
>
>   等价地简记为
>
$$
\rho_{A_i \mid P a\left(A_i\right)} \neq {}_{A_j^{\text{out*}}}\left(\rho_{A_i \mid P a\left(A_i\right)}\right) ,~\forall ~j
$$

> [!note]
> - 推广是指从无圈图推广到圈图。
>
>   简单的量子因果模型例如\eqref{eq:simplestcausalmodel}。

 

> [!theorem] 因果结构意味着过程矩阵的分解{} （[[barrett2021CyclicQuantumCausal\|barrett2021CyclicQuantumCausal]] Th.1）
{ #th-th-decompoofcs}

>  给定幺正信道以及因果结构，存在分解
>$$\rho_{C_1 \ldots C_l \mid B_1 \ldots B_k}^{\mathcal{U}}=\prod_{i=1}^l \rho_{C_i \mid P a\left(C_i\right)}$$
>   其中任何两个因子都是对易的。

> [!theorem] 信道的蔡氏矩阵与其幺正变换的关系
{ #th-th-underlydinguniofchoi}

> - 使用蔡氏矩阵的第一种约定，设$U:B(A\otimes C\otimes D)\rightarrow B(B\otimes E\otimes F)$是信道$\mathcal{E}=\mathrm{tr}_F\circ \mathcal{U}\circ \left((\cdot)\otimes\rho_D\right)$的幺正变换，则
> $$\rho_{BE|AC}^\mathcal{E}=\mathrm{tr}_{D^*F}\left(\rho^\mathcal{U}_{BEF|ACD}(\rho_D)^\top\right)=\mathrm{tr}\left(\rho^\mathcal{U}_{BEF|ACD}\tau_D^\mathrm{id}\rho_D\right)=\overline{\mathrm{tr}}_D \mathrm{tr}_F\left(\rho^\mathcal{U}_{BEF|ACD}\rho_D\right)$$
>   其中$\overline{\mathrm{tr}}_D(\cdot)=\mathrm{tr}_{D^*D}(\tau_D^\mathrm{id}(\cdot))$，$\tau_A^{\mathrm{id}}\equiv \left(\rho _{D|D}^{\mathrm{id}}\right)^\top=\rho _{D^*|D^*}^{\mathrm{id}}=\sum_{i, j}|i\rangle_{D^*}\langle j| \otimes|i\rangle_D\langle j|$

> [!proof]
> - 在计算复合信道的蔡氏矩阵时，即便输入和输出空间有重叠，也要设为不同的空间，因此设
> $$B\left(A_1 \otimes C_1\right) \xrightarrow{( \cdot) \otimes \rho_D} B\left(A_2 \otimes C_2 \otimes D\right) \xrightarrow{\mathcal{U}} B\left(B_1 \otimes E_1 \otimes F\right) \xrightarrow{\mathrm{tr}_F} B\left(B_2 \otimes E_2\right)$$
>   根据链积的性质，又或者利用命题\ref{prop:compochannalchoi}，有
> $$
\begin{aligned}
& \rho_{B_{2}E_{2}|A_{1}C_{1}}^{\mathcal{E}} = \rho_{B_{1}E_{1}F|B_{2}E_{2}}^{\mathrm{tr}_{F}}\star \rho_{B_{1}E_{1}F|A_{2}C_{2}D}^{\mathcal{U}}\star \rho_{A_{2}C_{2}D|A_{1}C_{1}}^{(\cdot)\otimes\rho_{D}}  \\ & =\mathrm{{tr}}_{A_{2}^{*}C_{2}^{*}D^{*}B_{1}^{*}E_{1}^{*}F^{*}}\left(\left(\rho_{A_{2}C_{2}D|A_{1}C_{1}}^{(\cdot)\otimes\rho_{D}}\right)^{\top_{A_{2}C_{2}D}}\left(\rho_{B_{1}E_{1}F|A_{2}C_{2}D}^{U}\right)^{\top_{B_{1}E_{1}F}}\rho_{B_{1}E_{1}F|B_{2}E_{2}}^{\mathrm{tr}_{F}}\right)_{B_2E_2~B_1^*E_1^*F^*~A_2^*C_2^*D^*~A_1^*C_1^*}\\
& =\mathrm{{tr}}_{A_{2}^{*}C_{2}^{*}D^{*}B_{1}^{*}E_{1}^{*}F^{*}}\left(\left(|j\rangle_{A_{2}^{*}C_{2}^{*}}\langle i|\otimes\left(\rho_{D}\right)^{\top}\otimes|i\rangle_{A_{1}^{*}C_{1}^{*}}\langle j|\right)\left(\rho_{B_{1}E_{1}F|A_{2}C_{2}D}^{U}\right)^{\top_{B_{1}E_{1}F}}\left(|k\rangle_{B_{2}E_{2}}\langle l|\otimes|k\rangle_{B_{1}^{*}E_{1}^{*}}\langle l|\otimes\mathbb{{I}}_{F^{*}}\right)\right)\\
& =\mathrm{{tr}}_{A_{2}^{*}C_{2}^{*}D^{*}B_{1}^{*}E_{1}^{*}F^{*}}\left(\left(|j\rangle_{A_{2}^{*}C_{2}^{*}}\langle i|\otimes\left(\rho_{D}^{\top}\right)\otimes|i\rangle_{A_{1}^{*}C_{1}^{*}}\langle j|\right)\left(U|p\rangle_{A_{2}C_{2}}\langle m|\otimes|q\rangle_{D}\langle n|U^{\dagger}\right)^{\top}\otimes|q\rangle_{D^{*}}\langle n|\left(|k\rangle_{B_{2}E_{2}}\langle l|\otimes|k\rangle_{A_{1}^{*}C_{1}^{*}}\langle l|\otimes\mathbb{{I}}_{F^{*}}\right)\right)\\
& =\mathrm{{tr}}_{D^{*}B_{1}^{*}E_{1}^{*}F^{*}}\left(\left(\left(\rho_{D}\right)^{\top}\otimes|i\rangle_{A_{1}^{*}C_{1}^{*}}\langle j|\right)\left(U|p\rangle_{A_{2}C_{2}}\langle m|\otimes|q\rangle_{D}\langle n|U^{\dagger}\right)^{\top}\otimes|q\rangle_{D^{*}}\langle n|\left(|k\rangle_{B_{2}E_{2}}\langle l|\otimes|k\rangle_{A_{1}^{*}C_{1}^{*}}\langle l|\otimes\mathbb{{I}}_{F^{*}}\right)\right)\\
& =\mathrm{{tr}}_{D^{*}B_{1}^{*}E_{1}^{*}F^{*}}\left(_{B_{1}^{*}E_{1}^{*}}\langle|\left(U|p\rangle_{A_{2}C_{2}}\langle m|\otimes|q\rangle_{D}\langle n|U^{\dagger}\right)^{\top}|k\rangle_{B_{1}^{*}E_{1}^{*}}\otimes\rho_{D}^{\top}|q\rangle_{D^{*}}\langle n|\right)|k\rangle_{B_{2}E_{2}}\langle l|\otimes|k\rangle_{A_{1}^{*}C_{1}^{*}}\langle l|\\
& =\mathrm{{tr}}_{D^{*}F}\left(_{B_{1}E_{1}}\langle k|\left(U|p\rangle_{A_{2}C_{2}}\langle m|\otimes|q\rangle_{D}\langle n|U^{\dagger}\right)|l\rangle\otimes\rho_{D}^{\top}|q\rangle_{D^{*}}\langle n|\right)|k\rangle_{B_{2}E_{2}}\langle l|\otimes|k\rangle_{A_{1}^{*}C_{1}^{*}}\langle l|\\
& =\mathrm{{tr}}_{D^{*}F}\left(\rho_{B_{1}E_{1}F|A_{2}C_{2}D}^{U}\rho_{D}^{\top}\right)
\end{aligned} $$

> [!note]
> - 由于命题中的公式的角标设计非常合理，一定有更简单的证明方法。
>
>   实际上可以将$AC$和$BE$合成一个。将$U$推广到一般的信道这个命题也成立。

> [!proposition]
>  \label{prop:nosignalingtofuture}
>   $A,A^\prime$和$B$都是单比特系统，$\mathcal{E}$是控制比特在左侧的控制非门。求图({（[[barrett2021CyclicQuantumCausal\|barrett2021CyclicQuantumCausal]] fig.1）})中节点$AB$的过程矩阵$\sigma_{AB}$。
>
![2025-01-02-22-50-38.png](/img/user/2025-01-02-22-50-38.png)

> [!proof]
> - 设输入为直积态$\rho=\rho^A\otimes \rho^{A^\prime}$。使用第二种约定，利用定理\ref{th:underlydinguniofchoi}求得从$A^\mathrm{out}$到$B^\mathrm{in}$的信道的蔡氏矩阵，再利用例\ref{ex:quantumprocess2}可得
>
$$
\begin{aligned}
\sigma_{AB}&=\rho_{A^\mathrm{in}}\otimes \rho_{B^\mathrm{in}F|A^\mathrm{out}A^\prime}^\mathrm{CNOT}\otimes \mathbb{I}_{B^{\mathrm{out}*}}\\
& =\rho_{A^\mathrm{in}}\otimes \mathrm{tr}_{A^{\prime*} F}\left(\rho^{\mathrm{CNOT}_{A^\mathrm{out}\rightarrow A^\prime}}_{B^\mathrm{in}F|A^\mathrm{out}A^{\prime}}\rho_{A^\prime}^\top \right)\otimes \mathbb{I}_{B^{\mathrm{out}*}}\\
& =\rho_{A^\mathrm{in}}\otimes \mathrm{tr}_{A^\prime F}\left(\sum |i_1i_2\rangle_{A^{\mathrm{out}*}A^{\prime*}}\langle k_1k_2|\otimes |i_1,i_1 +i_2\rangle_{FB^\mathrm{in}}\langle k_1,k_1 + k_2 |\rho_{A^\prime}^\top\right)\otimes \mathbb{I}_{B^\mathrm{in}}\otimes \mathbb{I}_{B^{\mathrm{out}*}}\\
& =\rho_{A^\mathrm{in}}\otimes \mathrm{tr}_{A^\prime}\left(\sum |k_1i_2\rangle_{A^{\mathrm{out}*}A^{\prime*}}\langle k_1k_2|\otimes|k_1 +i_2\rangle\langle k_1 + k_2| \rho_{A^\prime}^\top\right)\otimes \mathbb{I}_{B^\mathrm{in}}\otimes \mathbb{I}_{B^{\mathrm{out}*}}
\end{aligned}
$$
> [!note]
> - 根据结果可以做出以下分析。显然$B$不能向$A$发信。当$\rho_{A^\prime}$是最大混态的时候，$\sigma_{AB}=\rho_\mathrm{in}\otimes \mathbb{I}_{A^{\mathrm{out}*}B^\mathrm{in}B^{\mathrm{out}*}}$中出现因子$\mathbb{I}_{A^{\mathrm{out}*}}$，$A$不能影响$B$($A$不能向$B$发信)，这是显然的，因为无论$A^\mathrm{out}$输出什么比特，控制非门在输入最大混态的情况下都会输出最大混态，信息被随机性掩盖了。当$\rho_{A^\prime}=|0\rangle\langle 0|$时$A$可以向$B$发信。
## N-体不定因果过程矩阵
- [[Universal bounds in Quantum Metrology Across All Causal Structures\|Universal bounds in Quantum Metrology Across All Causal Structures]] 
-  $$S\succeq 0, \quad \mathcal{Q}_\mathsf{Gen}(S) = 0 , \quad \mathrm{tr}S = d^N,$$
-   $$\mathcal{Q}_\mathsf{Gen} = \bigotimes_{i= 1}^N(\mathcal{I} - \mathcal{D}_{T_i^\mathrm{o}} + \mathcal{D}_{T_i^\mathrm{i}T_i^\mathrm{o}}) - \mathcal{D}_{T_\mathrm{tot}^\mathrm{i}T_\mathrm{tot}^\mathrm{o}}.$$
## 过程矩阵的因果(不)可分性
参考[[ognyanoreshkov2016CausalCausallySeparable\|ognyanoreshkov2016CausalCausallySeparable]],[[wechs2019DefinitionCharacterisationMultipartite\|wechs2019DefinitionCharacterisationMultipartite]],[[araujo2015WitnessingCausalNonseparability\|araujo2015WitnessingCausalNonseparability]]。
## 不定因果模型

不定因果可以被等价地描述为因果结构中存在圈图。
## 量子开关
参见[[量子开关\|量子开关]]
## Lugano(AF-BW)过程
Lugano过程矩阵（[[barrett2021CyclicQuantumCausal\|barrett2021CyclicQuantumCausal]] (8)）
$$
\begin{aligned}
    &\sigma_{A B C}^{\mathrm{AF}}=\rho_{A \mid B C} \rho_{B \mid C A} \rho_{C \mid A B}\\
    &\rho_{A \mid B C}=\sum_{b, c=0,1}|\neg b \wedge c\rangle\left\langle\left.\neg b \wedge c\right|_{A^{\text {in }}} \otimes \mid b, c\right\rangle\left\langle b,\left.c\right|_{\left(B^{\text {out }} C^{\text {out }}\right)^*},\right.\\
        & \rho_{B \mid C A}=\sum_{c, a=0,1}|\neg c \wedge a\rangle\left\langle\left.\neg c \wedge a\right|_{B^{\mathrm{in}}} \otimes \mid c, a\right\rangle\left\langle c,\left.a\right|_{\left(C^{\mathrm{out}} A^{\mathrm{out}}\right)^*},\right. \\
        & \rho_{C \mid A B}=\sum_{a,b=0,1}|\neg a \wedge b\rangle\left\langle\left.\neg a \wedge b\right|_{C^{\text {in }}} \otimes \mid a, b\right\rangle\left\langle a,\left.b\right|_{\left(A^{\mathrm{out}} B^{\mathrm{out}}\right)^*} .\right.
    \end{aligned}
$$
可幺正拓展
$$
\sigma_{A B C F P}^{\mathrm{BW}}=\rho_{A B C F \mid A B C P}^U,
$$
$$
\begin{aligned}
& U:|a, b, c\rangle_{A^{\text {out }} B^{\text {out }} C^{\text {out }}} \otimes|l, m, n\rangle_{\lambda_A \lambda_B \lambda_C} \\
& \mapsto|l \oplus(\neg b \wedge c), m \oplus(\neg c \wedge a), n \oplus(\neg a \wedge b)\rangle_{A^{\text {in }} B^{\text {in }} C^{\text {in }}} \\
& \quad \otimes|a, b, c\rangle_{F^{\text {in }}} .
\end{aligned}
$$
trace掉$F$并在初态输入$|000\rangle_{\lambda_{ABC}}$可以得到原来的AF过程。考虑其他的初态是否也会得到不一样的违反因果不等式的过程？
[[N体Lugano过程\|N体Lugano过程]] 
初态为$|000\rangle_{\lambda}$ 时

|  a  |  b  |  c  | $A^{\text{in}}$ | $B^{\text{in}}$ | $C^{\text{in}}$ | $F^{\text{in}}$ |
| :-: | :-: | :-: | :-------------: | :-------------: | :-------------: | :-------------: |
|  0  |  0  |  0  |        0        |        0        |        0        |       000       |
|  0  |  0  |  1  |        1        |        0        |        0        |       001       |
|  0  |  1  |  0  |        0        |        0        |        1        |       010       |
|  0  |  1  |  1  |        0        |        0        |        1        |       011       |
|  1  |  0  |  0  |        0        |        1        |        0        |       100       |
|  1  |  0  |  1  |        1        |        0        |        0        |       101       |
|  1  |  1  |  0  |        0        |        1        |        0        |       110       |
|  1  |  1  |  1  |        0        |        0        |        0        |       111       |
关于Lugano过程相关的计算参见：Lugano过程.nb
## 由量子系统控制因果顺序的量子线路 QC-QC
- [[QC-QC\|QC-QC]]
## 多轮不定因果序量子过程

### 多轮过程矩阵 
参考{[[hoffreumon2021MultiroundProcessMatrix\|hoffreumon2021MultiroundProcessMatrix]],[[hoffreumonProcessesIndefiniteCausal\|hoffreumonProcessesIndefiniteCausal]],[[perinotti2017CausalStructuresClassification\|perinotti2017CausalStructuresClassification]],[[wilson2021CausalityHigherOrder\|wilson2021CausalityHigherOrder]],[[bisio2019TheoreticalFrameworkHigherorder\|bisio2019TheoreticalFrameworkHigherorder]],[[castro-ruiz2018DynamicsQuantumCausal\|castro-ruiz2018DynamicsQuantumCausal]],[[renner2017TimePhysics\|renner2017TimePhysics]]}。多轮过程矩阵(MPM)用于描述多个有确定因果顺序的观测者与环境的相互作用，这个模型可以用于多个量子梳的精密测量模型。

模仿归一化过程矩阵的定义，我们不预先假定各个comb之间存在因果关系，只要求这些comb和过程矩阵结合在一起以后满足一定的概率归一化条件，则有下面的定义。
> [!definition] 多轮过程矩阵
> - \label{def:multiroundporcessmat}
>   $W^{AB\cdots}$是多轮过程矩阵，如果
>
$$
\begin{aligned}
&W^{A B \cdots} \geq 0\\
&\operatorname{tr}\left[W^{A B \ldots} \cdot\left(M^A \otimes M^B \cdots\right)\right]=1
\end{aligned}
$$
>
>   任取量子梳$M^A,M^B,\ldots$。

> [!note]
> - 根据线性性可以看出， 归一化条件等价于$W$在comb的任意仿射组合上归一化。

用投影方法可以给出多轮过程矩阵的等价刻画。
> [!theorem] 多轮过程矩阵的投影刻画{} （[[hoffreumon2021MultiroundProcessMatrix\|hoffreumon2021MultiroundProcessMatrix]] Th.1）
> - 设梳$n_X$个齿的$\sigma_X$对应的投影算符为$\mathcal{P}_{n_X}^X$，则输入和输出平凡的正定矩阵$W\equiv W^{X_1\cdots X_N}$是合法的
>
$$
\mathcal{P} \equiv \bigotimes_{X \in \mathfrak{N}} \mathcal{P}_{n_X}^X
$$
>
>
>   ($\cdots$)

> [!note]
> - 对这个定理中的梳取特殊情况，可以得到\eqref{eq:2pointprocess}。> [!abstract] Contents
> - 无

不定因果过程，尤其是量子开关，在经典以及量子传输任务中被视为一种特殊的资源。应用层面的策略设计通常以经典信道容量(由信道的Holevo信息量定义)、量子信道容量[[chiribella2021IndefiniteCausalOrder\|chiribella2021IndefiniteCausalOrder]](由信道的量子相干信息定义)以及保真度为优化目标，而更基础的策略则专注于定义不定因果版本的上述三个目标本身。我还未清楚如果要考虑一般的不定因果过程对量子信息传输的增益需要加入什么样的约束限制，尤其是对辅助空间和控制-受控系统纠缠之间的约束。

## 关联
- [[对不定因果序过程随机数值抽样的方法\|对不定因果序过程随机数值抽样的方法]] 
# 松散的内容
- [[2 项目笔记/不定因果/项目：不定因果×量子纠错\|项目：不定因果×量子纠错]]
- [[2 项目笔记/不定因果/项目：不定因果×量子通信\|项目：不定因果×量子通信]]
	- [[1 Stories of Bizzo's Life/5 量子科学和量子技术/不定因果/不定因果与量子通信综述\|不定因果与量子通信综述]]
- [[1 Stories of Bizzo's Life/5 量子科学和量子技术/不定因果/不定因果新方向分析\|不定因果新方向分析]]
- [[2 项目笔记/不定因果/不定因果与量子计算\|不定因果与量子计算]]
- [[2 项目笔记/不定因果/项目：不定因果基础理论研究\|项目：不定因果基础理论研究]]
- [[项目：不定因果×量子精密测量\|项目：不定因果×量子精密测量]]
- 不定因果的时间尺度是多少？是否越长的不定顺序越难以实现？是否有m级甚至km级的量子开关？