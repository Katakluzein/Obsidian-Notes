---
{"dg-publish":true,"permalink":"/1 Stories of Bizzo's Life/5 量子科学和量子技术/量子信道/","tags":["量子信息","开放量子系统","问题"]}
---


主条目:[[1 Stories of Bizzo's Life/5 量子科学和量子技术/31 开放量子系统\|开放量子系统]]，[[1 Stories of Bizzo's Life/5 量子科学和量子技术/28 量子信息\|量子信息]]
### 保厄米、正、全正映射

**定义：保厄米性 (Hermiticity-preserving) / 保-dagger 映射**

如果 `*` 表示厄米共轭（Hermitian conjugate），那么一个映射 $\phi$ 保持厄米性等价于以下条件：
$$
\phi(X)^* = \phi(X^*)
$$

**定义：全正映射 (Completely Positive Map)** (Paulsen, 2002, Chap. 3)

- 设 $\mathfrak{A}$ 和 $\mathfrak{B}$ 是两个 $C^*$-代数。一个线性子空间 $\mathcal{S} \subseteq \mathfrak{A}$ 如果是一个**算子系统 (operator system)**，则意味着 $\mathcal{S}$ 是 $\mathfrak{A}$ 的一个包含单位元 $1$ 的自伴（即对-dagger 运算封闭）子空间。
- 设 $\phi: \mathcal{S} \rightarrow \mathfrak{B}$ 是一个线性映射。如果对于所有正元（positive element） $a \in \mathcal{S}$，$\phi(a)$ 也是正的，那么我们称 $\phi$ 是**正（positive）**或**保正（positive-preserving）**的。
- 我们用 $M_n(\mathfrak{B})$ 表示元素取自 $\mathfrak{B}$ 的 $n \times n$ 矩阵所构成的 $C^*$-代数。我们可以定义如下映射：
  $$
  \phi_{n}: M_{n}(\mathcal{S}) \rightarrow M_{n}(\mathfrak{B}), \quad (a_{ij}) \mapsto \phi_{n}((a_{ij})) = (\phi(a_{ij}))
  $$
  如果 $\phi_n$ 是正映射，我们称 $\phi$ 是 **$n$-正 ($n$-positive)** 或 **$n$-保正 ($n$-positive-preserving)** 的。如果 $\phi$ 对所有的 $n$ 都是 $n$-正的，我们就称 $\phi$ 是**全正 (completely positive)** 或**全保正 (completely positive-preserving)** 的。
- 如果 $\sup_{n} \|\phi_n\|$ 是有限的，我们称 $\phi$ 是**全有界 (completely bounded)** 的，并定义其范数为：
  $$
  \|\phi\|_{\mathrm{cb}} = \sup_{n} \|\phi_n\| .
  $$

**笔记**

- **问题**：正映射 (positive map) 是否有像全正映射一样，不需要遍历所有维度 $n$ 就能使用的简单判据？或许可以参考文章(hou2015NewCriterionSpecial)。

  全正映射的迹一定是正的，但正映射的迹不一定是正的。参见[这个 Stack Exchange 帖子](https://quantumcomputing.stackexchange.com/questions/38054/is-the-trace-of-a-positive-map-always-positive)。对于线性[[1 Stories of Bizzo's Life/1 数学基础/泛函\|泛函]]（linear functional）来说，全正和正是等价的（见 Paulsen, 2002, 命题3.8）。

- **问题**：是否存在物理上可以实现的、正但非全正的映射？

$\mathfrak{A} \otimes M_n(\mathbb{C}) \rightarrow M_n(\mathfrak{A}), \sum_{ij}A_{ij}\otimes E_{ij} \mapsto (A_{ij})$是${}^*$-同构，通常直接记作$(A_{ij})=\sum_{ij}A_{ij}\otimes E_{ij}$，其中$E_{ij}$是matrix unit。因此有全正的等价定义：$\phi$是$n$-正的$\Leftrightarrow \phi\otimes \mathbb{I}_{n\times n}$是正的，其中$\mathbb{I}_{n\times n}$是$n$阶单位矩阵。必要性：设$\phi$是$n$-正的，任取正的$x=\sum_{ij}A_{ij}\otimes E_{ij} \in \mathfrak{A}\otimes M_n(\mathbb{C})$，有$(\phi(A_{ij}))=\sum_{ij}\phi(A_{ij})\otimes E_{ij}=(\phi\otimes \mathbb{I})(\sum_{ij}A_{ij}\otimes E_{ij})$是正的，即$\phi\otimes \mathbb{I}$是正的。充分性类似。

$\pi:\mathcal{A}\rightarrow \mathcal{B}$是${}^*$-同态，则由
$$
\pi\left(A^{*} A\right)=\pi\left(A^{*}\right) \pi(A)=\pi(A)^{*} \pi(A) \geq_{\mathfrak{B}} 0
$$
可知，$\pi$是正的，因此保厄米且保矩阵乘法的映射都是正的。根据同态的定义(Moretti, 2017, Def.2.24)可知，$\pi(\mathbb{I})=\mathbb{I}$，$\|\pi\|\leqslant 1$，根据Russo-Dye定理可知，$\pi$是收缩的。

$\pi$是[[全正\|全正]]的，即$\pi_n:M_n(\mathfrak{A})\rightarrow M_n(\mathfrak{B})$是正的。

根据引理(Paulsen, 2002, Lm.3.13)，任取$P=B^{*} B \in M_n(\mathfrak{A})$，都有
$$
P=R_{1}^{*} R_{1}+\cdots+R_{n}^{*} R_{n}
$$
其中$R_k$是$B$将除了第$k$行以外的其他元素置零所得的矩阵。只有一行非零的矩阵$R$满足
$$
R^{*} R=\left(a_{i}^{*} a_{j}\right)
$$
只要对于任意的$a_i,a_j\in \mathfrak{A}$证明$\pi_n((a_i^*a_j))$是正的，这一结论被用于证明Stinespring扩张定理的逆命题。
$$
\begin{aligned} \pi_{n}\left(\left(a_{i}^{*} a_{j}\right)\right) & =\left(\pi\left(a_{i}^{*} a_{j}\right)\right) \\ & =\left(\pi\left(a_{i}\right)^{*} \pi\left(a_{j}\right)\right) \\ & =\left(\begin{array}{c}\pi\left(a_{1}\right) \cdots \pi\left(a_{n}\right) \\ 0\end{array}\right)^*\left(\begin{array}{c}\pi\left(a_{1}\right) \cdots \pi\left(a_{n}\right) \\ 0\end{array}\right)\end{aligned}
$$

**定理：Russo-Dye**

- 设$\Phi:M_n(\mathbb{C})\rightarrow M_k(\mathbb{C})$，是正映射，则$\|\Phi\|=\|\Phi(\mathbb{I})\|$，在$M_{n,k}(\mathbb{C})$上使用$\infty$-范数。

**证明**

- 参见(bhatia2009PositiveDefiniteMatrices, Th.2.3.7)

**笔记**

- 如果$\Phi$还是unital的，那么$\|\Phi\|=1$，即对任意$X\in M_n(\mathbb{C})$，有$\|\Phi(X)\|\leqslant\|X\|$，这时候我们说正映射具有收缩性。注意收缩映射都是连续的。

**定理：正的充分性条件**

- 设$\mathcal{S}$是$M_n(\mathbb{C})$中的算符系统(operator system)，$\Phi:\mathcal{S}\rightarrow M_k(\mathbb{C})$是unital映射且$\|\Phi\|=1$，则$\Phi$是正的。

**证明**

- 参见(bhatia2009PositiveDefiniteMatrices, Th.2.6.7)

**笔记**

- 结合上述两个定理可知，unital映射是正的当且仅当$\|\Phi\|=1$。

**定理：保迹保厄米映射的正性的充要条件**

- 设$\Phi:B(\mathsf{H})\rightarrow B(\mathsf{H})$是保迹、保厄米的线性映射，则$\Phi$是正的当且仅当对任何厄米阵$X$，都有
$$
\|\Phi(X)\|_1\leqslant \|X\|_1
$$

**证明**

- (正$\Rightarrow$ 收缩 )设厄米阵$X=A-B$，其中$A$和$B$都是正的，且$AB=0$。$|X|=A+B$，$\|X\|_1=\mathrm{tr}|X|=\mathrm{tr}(A+B)$，$\|\Phi(X)\|_1\leqslant \mathrm{tr}|\Phi(A)|+\mathrm{tr}|\Phi(B)|=\mathrm{tr}(A+B)=\|X\|_1$。
- (收缩$\Rightarrow$ 正 ) 设$X\geqslant 0$，则有
  $$
  \mathrm{tr}(X)=\mathrm{tr}(\Phi(X))\leqslant \mathrm{tr}|\Phi(X)|\leqslant \mathrm{tr}|X|=\mathrm{tr}(X)
  $$
  因此
  $$
  \mathrm{tr}(\Phi(X))= \mathrm{tr}|\Phi(X)|
  $$
  这意味着$\Phi(X)\geqslant 0$。

**笔记**

- 定理中的厄米阵可以换成一般的矩阵吗？显然充分性成立，但正性是否能推得对任意的$X$都有$\|\Phi(X)\|_1\leqslant \|X\|_1$？
- 从这个定理可以立即推论量子信道不增加迹距离，或者说迹距离关于量子信道是单调的。
- 注意收缩性不是严格的，可能取得等号。

综合上面的两个定理可以看出，正性在某种意义下就是收缩性。

**定义：不可约正映射** (lardizabal2022MeanHittingTime)

- 设$\Phi: M_n \rightarrow M_n$是正的，$P$是正交投影算符，如果
  $$
  \Phi\left(P M_n P\right) \subset P M_n P
  $$
  蕴含$P=0$或$P=\mathbb{I}$，则称$\Phi$是**不可约**的。

**引理** (Paulsen, 2002, Lm.3.13)

- $\mathfrak{A}$是$C^*$-代数，任取$P=B^{*} B \in M_n(\mathfrak{A})$，都有
  $$
  P=R_{1}^{*} R_{1}+\cdots+R_{n}^{*} R_{n}
  $$
  其中$R_k$是$B$将除了第$k$行以外的其他元素置零所得的矩阵。

证明参见图片 [Image: 2024-03-10-17-34-51 1.png]

**技巧**

利用上述引理，将全正性的证明约化为$(\pi(a_i^*a_j))$的正性的证明。这个技巧在Choi (Paulsen, 2002, Th.3.14) 的证明中也发挥了作用。

好的，这是对 Stinespring 扩张定理的翻译和整理。

**定理：Stinespring 扩张定理 (Stinespring’s Dilation Theorem)** (参见 Paulsen, 2002, Th. 4.1)

设 $\mathfrak{A}$ 是一个含幺元的 $C^*$-代数，并设 $\phi: \mathfrak{A} \rightarrow \mathfrak{B}(\mathsf{H})$ 是一个全正映射 (completely positive map)，其中 $\mathfrak{B}(\mathsf{H})$ 表示希尔伯特空间 $\mathsf{H}$ 上的有界算子代数。

那么，必然存在一个希尔伯特空间 $\mathsf{K}$，一个含幺元的 `*`-同态 $\pi: \mathfrak{A} \rightarrow B(\mathsf{K})$，以及一个有界算子 $V: \mathsf{H} \rightarrow \mathsf{K}$，它们满足 $\|\phi(1)\| = \|V\|^2$，并且对于所有 $a \in \mathfrak{A}$，有：
$$
\phi(a) = V^{*} \pi(a) V
$$
反之，给定一个希尔伯特空间 $\mathsf{K}$，一个含幺元的 `*`-同态 $\pi: \mathfrak{A} \rightarrow B(\mathsf{K})$，以及一个有界算子 $V:\mathsf{H} \rightarrow \mathsf{K}$，则由 $\phi(a) = V^{*} \pi(a) V$ 定义的映射 $\phi: \mathfrak{A} \rightarrow \mathfrak{B}(\mathsf{H})$ 必然是全正的。

由 $(\pi, V, \mathsf{K})$ 构成的三元组被称为 $\phi$ 的一个 **Stinespring 表示 (Stinespring representation)**。

**证明**

- 在$\mathfrak{A}\otimes \mathsf{H}$上定义一个Hermite对称的共轭双线性函数 (Footnote: 与内积相比差了什么？正定性？)
  $$
  \langle a \otimes x, b \otimes y\rangle=\left\langle\phi\left(b^{*} a\right) x, y\right\rangle_{\mathsf{H}}=\langle x,\phi(a^*b)y\rangle_{\mathsf{H}}
  $$
- Hermite对称性：
  $$
  \langle b \otimes y, a\otimes x\rangle=\left\langle\varphi\left(a^{*} b\right) y, x\right\rangle_{\mathsf{H}}=\overline{\left\langle x, \varphi\left(a^{*} b\right) y\right\rangle_{\mathsf{H}}}=\overline{\langle a \otimes x, b \otimes y\rangle_\mathsf{H}}
  $$
  按数学家的约定，第一分量线性第二分量共轭线性。根据
  $$
  \left\langle\sum_{j=1}^{n} a_{j} \otimes x_{j}, \sum_{i=1}^{n} a_{i} \otimes x_{i}\right\rangle=\left\langle\phi_{n}\left(\left(a_{i}^{*} a_{j}\right)\right)\left(\begin{array}{c}x_{1} \\ \vdots \\ x_{n}\end{array}\right),\left(\begin{array}{c}x_{1} \\ \vdots \\ x_{n}\end{array}\right)\right\rangle_{\mathsf{H}^{(n)}} \geq 0
  $$
  可知，$\phi$是**全正**的蕴含了$\langle\cdot, \cdot \rangle$是半正定的。其中$\langle, \rangle_{\mathsf{H}^{(n)}}$是$\mathsf{H}^{(n)}$上自然的内积。
- 根据半正定厄米对称的双线性形式的Cauchy-Schwartz[[不等式\|不等式]]
  $$
  \mathcal{N}=\{u \in \mathfrak{A} \otimes \mathsf{H} \mid\langle u, u\rangle=0\}\subset\mathfrak{A}\otimes \mathsf{H}
  $$
  是$\mathfrak{A}\otimes \mathsf{H}$的子空间。设$u,v\in \mathcal{N}$，则
  $$
  0 \leqslant\langle u+v, u+v\rangle=\langle u, v\rangle+\langle v, u\rangle \leqslant 2|\langle u, v\rangle| \leqslant 2 \sqrt{(u, u\rangle\langle v, v)}=0
  $$
  进而，
  $$
  \langle u+\mathcal{N}, v+\mathcal{N}\rangle:=\langle u, v\rangle
  $$
  是商空间$(\mathfrak{A}\otimes \mathsf{H})/ \mathcal{N}$的内积，商空间在某种意义下消除了简并。$(\mathfrak{A}\otimes \mathsf{H})/ \mathcal{N}$经过完备化得到的Hilbert空间记为$\mathsf{K}$，内积记为$\langle,\rangle_\mathsf{K}$。
- 给定$a\in \mathfrak{A}$，定义$\pi(a): \mathfrak{A} \otimes \mathsf{H} \rightarrow \mathfrak{A} \otimes \mathsf{H}$，满足
  $$
  \pi(a)\left(b \otimes x \right)= \left(a b\right) \otimes x
  $$
  在以$\mathfrak{A}$中的元素构成的$n$阶方阵的$C^*$-代数$M_n(\mathfrak{A})$的正元素构成的集合$M_n(\mathfrak{A})^+$中有
  $$
  \left(a_{i}^{*} a^{*} a a_{j}\right) \leq\left\|a^{*} a\right\| \cdot\left(a_{i}^{*} a_{j}\right)
  $$
  这是因为
  $$
  \begin{aligned} & \left\|a^* a\right\| \cdot\left(a_{i}^* a_{j}\right)-\left(a_{i}^* a^* a a_{j}\right) \\ = & a_{i}^*\left(\left\|a^* a\right\|-a^* a\right) a_{j} \\ =& \left(\begin{array}{cccc}a_{1}^* & 0 & \cdots & 0 \\ \vdots & \vdots &\ddots & \vdots \\ a_{n}^* & 0 & \cdots & 0\end{array}\right)\mathrm{diag}(\|a^*a\|-a^*a)\left(\begin{array}{cccc}a_{1} & a_{2} & \cdots & a_{n} \\ 0 & 0 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & 0\end{array}\right)\\ =& \left(\sqrt{\left\|a^* a\right\|-a^* a}\left(\begin{array}{cccc}a_{1} & a_{2} & \cdots & a_{n} \\ 0 & 0 & \cdots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \cdots & 0\end{array}\right)\right)^*\left(\sqrt{\| a^* a \|-a^* a}\left(\begin{array}{cccc}a_{1} & a_{2} & \cdots & a_{n} \\ 0 & 0 & \cdots & 0 \\ \vdots & \vdots & \cdots & \vdots \\ 0 & 0 & \cdots & 0\end{array}\right)\right) \end{aligned}
  $$
- 考虑
  $$
  \begin{aligned} & \left\langle\pi(a)\left(\sum_{j} a_{j} \otimes x_{j}\right), \pi(a)\left(\sum_{i} a_{i} \otimes x_{i}\right)\right\rangle \\ = & \sum_{i, j}\left\langle\varphi\left(a_{i}^{*} a^{*} a a_{j}\right) x_{j}, x_{i}\right\rangle_{H} \leqslant\left\|a^{*} a\right\| \sum_{i j}\left\langle\varphi\left(a_{i}^{*} a_{j}\right) x_{j}, x_{i}\right\rangle_{H} \\ = & \|a\|^{2} \cdot\left\langle\sum_{j} a_{j} \otimes x_{j}, \sum_{i} a_{i} \otimes x_{i}\right\rangle\end{aligned}
  $$
  因此
  $$
  \pi(a)(N) \subseteq N
  $$
  $\pi(a)$诱导了良定义的映射$\pi(a):(\mathfrak{A} \otimes \mathsf{H})/\mathcal{N}\rightarrow (\mathfrak{A} \otimes \mathsf{H})/\mathcal{N},~u+\mathcal{N}\mapsto \pi(a)(u)+\mathcal{N}$
  由于$\|\pi(a)\| \leq\|a\|$，因此$\pi(a)$有界，将其拓展到完备化的$\mathsf{K}$上。
- 可以验证$\pi: \mathfrak{A} \rightarrow B(\mathsf{K})$是unital的*-同态。$\pi(1)=1$，
  $$
  \begin{aligned} & \left\langle\alpha \otimes x+\mathcal{N}, \pi(a)^{*}(\beta \otimes y+\mathcal{N})\right\rangle_{\mathsf{K}} \\ = & \langle\pi(a)(\alpha \otimes x+\mathcal{N}), \beta \otimes y+\mathcal{N}\rangle_{\mathsf{K}} \\ = & \langle a \alpha \otimes x+\mathcal{N}, \beta \otimes y+\mathcal{N}\rangle_{\mathsf{K}} \\ = & \left\langle\alpha x+\mathcal{N}, a^* \beta \otimes y+\mathcal{N}\right\rangle_{\mathsf{K}} \\ = & \left\langle\alpha x+\mathcal{N}, \pi\left(a^*\right) \beta \otimes y+\mathcal{N}\right\rangle_{\mathsf{K}}\end{aligned}
  $$
- 定义$V:\mathsf{H}\rightarrow \mathsf{K},x\mapsto 1 \otimes x+\mathcal{N}$，由
  $$
  \|V x\|^{2}=\langle 1 \otimes x, 1 \otimes x\rangle=\langle\phi(1) x, x\rangle_{\mathsf{H}} \leq\|\phi(1)\| \cdot\|x\|^{2}
  $$
  可知，$V$是有界的，实际上
  $$
  \|V\|^{2}=\sup \left\{\langle\phi(1) x, x\rangle_{\mathsf{H}}:\|x\| \leq 1\right\}=\|\phi(1)\|
  $$
- 对任意的$x,y\in \mathsf{H}$，有
  $$
  \left\langle V^{*} \pi(a) V x, y\right\rangle_{\mathsf{H}}=\langle\pi(a) 1 \otimes x, 1 \otimes y\rangle_{\mathsf{K}}=\langle\phi(a) x, y\rangle_{\mathsf{H}}
  $$
  故
  $$
  V^{*} \pi(a) V=\phi(a)
  $$
- 逆命题：任何$*$-同态都是全正的，这在已经知道的情况下是显然的。

**笔记**

- 定理中的信道是海森堡表象中的，即$\phi$实际上作用在effect上而不是密度算符上。
- 定理本身没有对$V$是否为等距做出约束。当$\phi$是unital，即$\phi^\dagger$保迹时，$V$是等距算符(isometry)，因此$\mathsf{H}= V \mathsf{H}$可以视为$\mathsf{K}$的子空间。设$T\in B(\mathsf{K})$，则算符$V^\dagger T|_{B(\mathsf{H})}$被称为$T$到$\mathsf{H}$上的压缩(compression)(Paulsen, 2002, Th.4.1)。做分解$\mathsf{K}=\mathsf{H}\oplus \mathsf{H}^\perp$，将$T$视为2阶块状矩阵，则$T$到$\mathsf{H}$上的压缩就是左上角的块。unital全正算符的Stinespring膨胀可以表述为：$B(\mathsf{H})$上的全正算符都是某个包含$\mathsf{H}$的空间$\mathsf{K}$上的$*$-同态到$\mathsf{H}$上的压缩。
- 设$\mathsf{K}_1$是$\pi(\mathfrak{A})V \mathsf{H}$的闭线性展开(linear span)，即$\mathsf{K}_1=\overline{\mathrm{span}\{ \pi(\mathfrak{A})V \mathsf{H} \}}$，则$\mathsf{K}_1$是$\pi$的不变子空间，即$\pi(\mathfrak{A}) \mathsf{K}_1 \subset \mathsf{K}_1$。另外由于$\pi$是unital同态，所以$V \mathsf{H}\subset \mathsf{K}_1$，定义$\pi_1(a)\equiv \pi(a)|_{\mathsf{K}_1}$，则有$\phi(a)=V^* \pi_1(a) V$，作为新的Stinespring表示$\left(\pi_1, V, \mathsf{K}_1\right)$满足$\mathsf{K}_1=\overline{\mathrm{span}\{ \pi_1(\mathfrak{A})V \mathsf{H} \}}$，满足这个额外条件的Stinespring表示被称为**最小Stinespring表示**。 在相差一个幺正变换的意义下，最小Stinespring表示是唯一的。
- 利用unital \*-同态的性质，可以从Stinespring表示得到Kraus算符和表示，设$\mathfrak{A}$是矩阵代数$B(\mathsf{H}_1)\equiv M_n(\mathbb{C})$，$\phi:B(\mathsf{H}_1)=\mathfrak{A}\rightarrow B(\mathsf{H}_2)=M_k(\mathbb{C})$，则$\pi(\mathfrak{A})$是一个因子(是吗？是否需要排除$\pi(\mathfrak{A})=\mathbb{I}$的特殊情形？)，在幺正等价的意义下，存在$C^*$-代数的分解$\pi(\mathfrak{A})= \mathbb{I}_l \otimes \mathfrak{A} \in B(\mathsf{K})$（为什么？），空间的分解$\mathsf{K}=\bigoplus_{i=1}^l \mathbb{C}_i^n,~l\leqslant nk$，且满足$P_i\pi(a)P_i=a$，即$\pi$在子代数$P_i \mathfrak{A} P_i$上的限制是恒等表示。定义$V_i=P_iV$可得
  $$
  \phi(a)=\sum_{i=1}^{l}\left(V^* P_i\right)\left(P_i \pi(a) P_i\right)\left(P_i V\right)=\sum_{i=1}^{l} V_i^* a V_i
  $$
  其中已经将每个$\mathbb{C}_i^n$视为同一个。写成矩阵形式有
  $$
  \begin{aligned}
  \varphi(a) & =\sum_i V^\dagger P_i \pi(a) P_i V \\
  & =\left(V_1^\dagger \cdots \cdot, V_l^\dagger\right)\left(\begin{array}{lll}
  a & & \\
  & \ddots & \\
  & & a
  \end{array}\right)\left(\begin{array}{c}
  V_1 \\
  \vdots \\
  V_l
  \end{array}\right)
  \end{aligned}
  $$
  Kraus算符和的幺正自由度是一种特殊的Stinespring幺正自由度，取最简单的unital $*$-同态，将$l$个输入矩阵放在对角线上制作成块对角阵，$\pi(a)=\mathbb{I}_l\otimes a=\mathrm{diag}(a,\ldots,a)\in M_{nl}(\mathbb{C})$，设Kraus算符的幺正变换为$W=UV$，其中$U=(u_{ij})\otimes \mathbb{I}_n$
  $$
  \left(\begin{array}{c}
  W_1 \\
  \vdots \\
  W_l
  \end{array}\right)=\left(\begin{array}{ccc}
  u_{11} \mathbb{I}_n & & u_{1l} \mathbb{I}_n\\
  & \ddots & \\
  u_{l1} \mathbb{I}_n & & u_{ll} \mathbb{I}_n
  \end{array}\right)_{nl\times nl}\left(\begin{array}{c}
  V_1 \\
  \vdots \\
  V_l
  \end{array}\right)_{n l \times k}
  $$
  这种$U$的特殊性在于，变换前后的$*$-同态是相同的，即$\pi^\prime\equiv U\pi U^\dagger=\pi$，由此可知
  $$
  \phi(a)=V^\dagger \pi^\prime(a)V=W^\dagger \pi(a)W
  $$
- **问题**：如果取最简单unital *-同态，是否能够利用公式$\phi(a)=V^\dagger \pi(a)V$制作一个新的[[Quantum Fisher Information\|Fisher信息量]]公式？公式中要包含关于$V$的最小化。
- **问题**：Stinespring表示和系统-环境耦合表示的关系是什么？ (Encyclopedia of Mathematical Physics, 2006, p.474)
  设$\mathsf{K}=\mathsf{A}\otimes \mathsf{H}_1$，则$V:\mathsf{H}_2\rightarrow \mathsf{A}\otimes \mathsf{H}_1$，引入额外的辅助空间$\mathsf{A}^\prime$将$V$拓展为幺正变换$U:\mathsf{A}^\prime \otimes \mathsf{H}_2\rightarrow \mathsf{A} \otimes \mathsf{H}_1$，$\mathrm{dim} \mathsf{A}^\prime=\frac{\mathrm{dim}\mathsf{A}\otimes \mathsf{H}_1}{\mathrm{dim}\mathsf{H}_2}=nl/k$(对$l$有约束，需要保证维度是整数)。 计算$\phi$的共轭$\phi^\dagger$，设$a$和$\rho$都是厄米的，
  $$
  \langle \phi(a),\rho\rangle=\mathrm{tr}_{\mathsf{H}_2}\left(V^\dagger (\mathbb{I}_l\otimes a) V\rho\right)
  =\mathrm{tr}_\mathsf{K}\left((\mathbb{I}_l\otimes a) V\rho V^\dagger\right)=\mathrm{tr}_{\mathsf{H}_1}\left(a \mathrm{tr}_\mathsf{A}(V\rho V^\dagger)\right)
  =\mathrm{tr}_{\mathsf{H}_1}\left(a~ \mathrm{tr}_\mathsf{A}\left(U |\psi\rangle \langle \psi |\otimes \rho U^\dagger \right)\right)
  =\langle a,\phi^\dagger (\rho)\rangle
  $$
  根据上式可知
  $$
  \phi^\dagger(\rho)=\mathrm{tr}_\mathsf{A}\left(U |\psi\rangle \langle \psi |_\mathsf{A^\prime}\otimes \rho_{\mathsf{H}_2} U^\dagger \right)
  $$
  这就是系统环境耦合形式的信道表示方式。

好的，这是您笔记的第二部分。我将继续严格按照您的要求，只进行格式转换，不修改任何内容。

---

### 量子信道的定义与基本性质

在开放系统中，量子态的时间演化不满足薛定谔方程，为了在保持量子态的物理含义和态生活的空间的数学结构的情况下，尽可能一般地讨论量子态的动力学过程或者通信过程，人们提出了量子信道和量子操作的概念。

**定义：Quantum Channel and Quantum Operation**

- 保迹的全正的线性映射$\mathcal{E}:B(\mathsf{H}_1)\rightarrow B(\mathsf{H}_2)$称为(薛定谔表象的)**量子信道**(quantum channel)，
- 如果条件放宽为迹小于等于1，那么称该映射为**量子操作**(quantum operation) (nielsen2001quantum, Sec.8.2.4)。

**笔记**

- 为什么在定义这个概念的时候要求迹不能大于1？
  量子操作可纠错的必要条件定理 (Scherer2019, Th.7.22) 是
  $$
  \operatorname{tr}(\mathcal{E}(\rho))=\text{const.}=\kappa_{\mathcal{E}} \in \quad \forall \rho \in D\left(\mathsf{H}^c\right)
  $$
  其中，$\mathsf{H}^c$是码空间。

- 根据内积定义量子信道的厄米共轭，$\langle Y, \mathcal{E}(X)\rangle =\left\langle \mathcal{E}^{\text{}}(Y), X\right\rangle$
  $$
  \mathcal{E}^{\text{}}(\cdot)=\sum_{k=1}^{N} E_{k}^{\text{}} \cdot E_{k}
  $$

- Channel的凸线性组合、直积、复合都仍然是Channel。

- 量子信道的三种等价刻画：
  (文字描述替换Tikz图)
  **公理化定义** <=> **Kraus算符和表示** <=> **系统环境耦合表示**

- 带有物理动机的公理(公理化定义)
  - **线性的动机**：[[1 Stories of Bizzo's Life/5 量子科学和量子技术/19 量子力学 泛函分析\|量子力学]]大多数时候都是线性的。
  - **保迹(保持态的归一化)的动机**：幺正变换是保持迹的，如果量子信道是以概率$p_i$发生幺正变换$U_i$，那么概率的归一化要求总效果$\rho \mapsto \mathcal{E}(\rho)=\sum{p_i}U_i\rho U_i^\text{}$是保迹的。
  - **次归一化的动机**：1、量子信道中如果存在某些我们未知的过程，使得量子态通过信道后进入了更大的希尔伯特空间，但我们仍用较小的Hilbert空间来表述它，就会使得态不再是归一的。2、考虑次归一化的量子态在有时候也是有用的，
  - [Image Placeholder: image//2024-03-10-16-16-34.png]
  - **正的动机**：我们希望信道输出的态仍然是正的，这一点实际上保证了任何事件发生的概率大于等于零，经过归一化之后仍然可以被视为量子态。诚然，如果两个子系统初始时存在纠缠，通过某些信道、再trace掉其中一个子系统之后剩下的部分不再是正的（举例？），此时可以说进行系统和热库划分已经失去了物理意义，
  - **全正的动机**：全正性允许我们对系统的大小进行任意拓展。例如，初始时系统同宇宙中的其他部分处于纠缠态，经历$\mathcal{E}\otimes \mathrm{id}$之后仍然保持为量子态。
  - Kraus的算符和表示
  - 与环境耦合的系统

  其中，后面两种表示可以视为Steinspring膨胀定理的推论。

### 蔡氏矩阵和过程矩阵

有了量子信道和操作的定义之后，开始讨论其首要性质。

**引理：蔡氏定理(Choi)**

- $\mathfrak{B}$是$C^*$-代数，$\mathcal{E}:M_n\rightarrow \mathfrak{B}$是线性映射，下列命题等价
  1. $\mathcal{E}$全正。
  2. $\mathcal{E}$是$n$-正的。
  3. $\left(\mathcal{E}\left(E_{i, j}\right)\right)_{i, j=1}^{n}$ 在 $M_{n}(\mathfrak{B})$中是正的。

**证明**

- $(1)\Rightarrow(2)$由定义。
- $(2)\Rightarrow(3)$只要证$(E_{ij})$是正的，
  $$
  \begin{aligned} & \left(x_{1}^\text{}, \ldots, x_{n}^\text{}\right)\left(\begin{array}{ccc}E_{11} & \cdots & E_{1 n} \\ \vdots & & \vdots \\ E_{n 1} & & E_{n n}\end{array}\right)\left(\begin{array}{c}x_{1} \\ \vdots \\ x_{n}\end{array}\right) \\ = & \sum_{i j} x_{i}^\text{} E_{i j} x_{j}=\sum_{i j} x_{i}^\text{}\left(\begin{array}{c}0 \\ \vdots \\ x_{j j} \\ \vdots\end{array}\right) \rightarrow i^{t h} \text { row } \\ = & \sum_{i j} \bar{x}_{i i} x_{j j}=\sum_{i j} \bar{y}_{i} y_{j} \\ = & \overline{\left(\sum y_{i}\right)}\left(\sum y_{j}\right) \geqslant 0\end{aligned}
  $$
- $(3)\Rightarrow(1)$只要证明$\mathfrak{B}=B(\mathsf{H})$的情形，设$|x_{1}\rangle, \ldots, |x_{k}\rangle\in \mathsf{H}$，$B_{1}, \ldots, B_{k}\in M_n$ ，根据引理(Paulsen, 2002, Lm.3.13)，只要证明
  $$
  \sum_{i, j}\left\langle\mathcal{E}\left(B_{i}^{*} B_{j}\right) x_{j}| x_{i}\right\rangle\geqslant 0
  $$
  将矩阵$B_l$展开，$B_{l}=\sum_{r, s=1}^{n} b_{r, s, \ell} E_{r, s}$，设$y_{t, r}=\sum_{j=1}^{k} b_{r, t, j} x_{j}$，则有
  $$
  \begin{aligned} \sum_{i, j}\left\langle\mathcal{E}\left(B_{i}^{*} B_{j}\right) x_{j}\middle\vert x_{i}\right\rangle & =\sum_{r=1}^{n} \sum_{s, t=1}^{n}\left\langle\mathcal{E}\left(E_{s, t}\right)\left(\sum_{i, j} \bar{b}_{r, s, i} b_{r, t, j} x_{j}\right)| x_{i}\right\rangle \\ & =\sum_{r=1}^{n} \sum_{s, t}\left\langle\mathcal{E}\left(E_{s, t}\right) y_{t, r}| y_{s, r}\right\rangle \geqslant 0 \end{aligned}
  $$
  最后一步利用了$(\mathcal{E}(E_{st}))$是正的。

实际上，证明中使用的$(E_{ij})$是一个最大纠缠态，上述定理有推论。

**推论**
$$
\mathcal{E}\text{全正}\Leftrightarrow (\mathcal{E} \otimes \mathbb{I})(|I\rangle\langle I|) \text{是正的}
$$

**证明**

- 设存在映射$\mathcal{E}:B(\mathsf{H}_A)\rightarrow B(\mathsf{H}_B)$，$\mathrm{dim} ~\mathsf{H}_A=d_A$，$\{|i\rangle\}$是$\mathsf{H}_A$上的一组ONB，取未归一化的最大纠缠态 $|I\rangle = \sum_{i=1}^{d_A} | i,i \rangle$，
  $$
  \begin{aligned} & (\mathcal{E} \otimes \mathbb{I})(|I\rangle\langle I|) \\ = & (\mathcal{E} \otimes \mathbb{I})\left(\sum_{i j}|i\rangle\langle j| \otimes|i\rangle\langle j|\right) \\ = & (\mathcal{E} \otimes \mathbb{I})\left(\sum_{i j} E_{i j} \otimes E_{i j}\right) \\ = & \left(\mathcal{E}\left(E_{i j}\right)\right) \end{aligned}
  $$

**笔记**

- 通过这个推论可以容易地检验转置操作虽然是线性、保迹、正的，却不是全正的。

使用Choi-Jamiolkowski同构可以可以使把量子信道从抽象的映射变成具体的矩阵，便于我们调动关于具体矩阵的性质和定理。设$\rho\in D(\mathsf{H})$是$d$阶密度矩阵，量子信道$\mathcal{E}: B(\mathsf{H}^A) \rightarrow B(\mathsf{H}^B)$，以$\mathcal{E}$为元素的集合与$B(\mathsf{H}^B\otimes\mathsf{H}^{A*})$同构，按照以下方式构造一个具体的同构。设$\mathrm{dim}\mathsf{H}^A=d$，$\mathrm{dim}\mathsf{H}^B=d^\prime$，$\{|e_i\rangle_A\}$，$\{|e_i\rangle_{A^*}\}$和$\{|e_i^\prime\rangle_B\}$分别是$\mathsf{H}^A$，$\mathsf{H}^{A*}$和$\mathsf{H}^B$的一组ONB。称约化后得到最大混态（即正比于单位算符的态）的量子态为**最大纠缠态**(maximally entangled)，任意取定(未归一化的)最大纠缠态，
$$
|I\rangle=\sum_{i=1}^{d}|e_i\rangle_A| e_i\rangle_{A^*}
$$

**定理：Choi-Jamiolkowski(CJ)同构**

- 设线性映射$\mathcal{E}: B(\mathsf{H}^A) \rightarrow B(\mathsf{H}^B)$，则线性映射
  $$
  \mathsf{CJ}: \mathcal{E}\mapsto\rho_{B|A}^\mathcal{E}\equiv \mathsf{E}\equiv (\mathcal{E} \otimes \mathbb{I})(|I\rangle\langle I|) \in B(\mathsf{H}^B\otimes\mathsf{H}^{A*}),~ |I\rangle=\sum_{i=1}^{d}|e_i\rangle_A| e_i\rangle_{A^*}
  $$
  或者
  $$
  \mathsf{CJ}: \mathcal{E}\mapsto\rho_{B|A}^\mathcal{E}\equiv \mathsf{E}\equiv (\mathbb{I} \otimes\mathcal{E} )(|I\rangle\langle I|) \in B(\mathsf{H}^{A*}\otimes\mathsf{H}^B),~|I\rangle=\sum_{i=1}^{d}|e_i\rangle_{A^*}| e_i\rangle_{A}
  $$
  是线性同构，且
  $$
  \mathsf{CJ}:\mathsf{Chn}(D(\mathsf{H}^A),D(\mathsf{H}^B))\rightarrow \mathsf{Choi}(\mathsf{H}^B\otimes \mathsf{H}^{A*})\equiv \{\mathsf{E}\in B(\mathsf{H}^B\otimes \mathsf{H}^{A*}) \mid \mathsf{E}\geq 0,~\mathrm{tr}_B(\mathsf{E})=\mathbb{I}_{A^*} \}
  $$
  是信道的集合和满足保迹条件的态空间这两个凸空间之间的线性同构， 即$\mathcal{E}$是信道当且仅当$\mathsf{E}$是一个**蔡氏矩阵**，称$\mathsf{E}$是$\mathcal{E}$的蔡氏矩阵，又称**Choi-Jamiolkowski同构**。

**证明**

- 同构只要证明逆射存在。推论已证，$\mathcal{E}$全正当且仅当$\mathsf{E}$半正定。$\mathcal{E}$保迹当且仅当$\mathrm{tr}_B(\mathsf{E})=\mathbb{I}_{A^*}$。

关于蔡氏同构的满射的证明，参见([[Fundamental Limitations on the Recoverability of Quantum Processes\|Fundamental Limitations on the Recoverability of Quantum Processes]], 式(12))。如果将定义蔡氏同构中的最大纠缠态改为约化满秩态，会得到另一个不一样的映射，它仍然是一个同构（[[Fundamental Limitations on the Recoverability of Quantum Processes\|Fundamental Limitations on the Recoverability of Quantum Processes]], 式(28)）。这会导致不一样的蔡氏矩阵，文献中还考虑了他们之间的关系。

**笔记**

- 有时候也使用定义$\mathsf{E}=(\mathcal{E} \otimes \mathbb{I})(|I\rangle\langle I|)/d$，不要随意切换！

**定义：蔡氏矩阵**

- 设矩阵$\mathsf{E}:B(\mathsf{H}^B\otimes\mathsf{H}^{A*})$满足，$\mathsf{E}\geqslant 0$以及$\mathrm{tr}_B(\mathsf{E})=\mathbb{I}_{A^*}$，则称$\mathsf{E}$为**蔡氏矩阵**。

**示例：~蔡氏矩阵**

- 求迹信道的蔡氏矩阵$\mathrm{tr}:\mathsf{H}\rightarrow \mathbb{C}$，$\rho^\mathrm{tr}_{\mathbb{C}|\mathsf{H}}=\mathrm{tr}\otimes \mathrm{id}(|I\rangle\langle I|)=\mathbb{I}_{\mathsf{H}^*}$
- 将任何复数映到给定的态$\rho_0:\mathbb{C}\rightarrow \mathsf{H},~z\mapsto\rho_0$，$\rho^{\rho_0}_{\mathsf{H}|\mathbb{C}}=\rho_0\otimes \mathrm{id}(|I\rangle\langle I|)=\rho_0\otimes 1_{\mathbb{C}^*}=\rho_0$

凸空间之间的同构不是唯一的，对于任意的局域幺正变换$U_B\otimes U_A$，
$$
\mathsf{CJ}^\prime:\mathcal{E}\mapsto U_B\otimes U_A \mathsf{E} U_B^\dagger \otimes U_A^\dagger
$$
也是同构。显然有$\mathsf{CJ}^\prime(\mathsf{Chn})\subset \mathsf{Choi}$，只要检验$\mathsf{CJ}^{\prime{-1}}(\mathsf{Choi})\subset \mathsf{Chn}$，以及$\mathsf{CJ}^{\prime{-1}}:\mathsf{F}\mapsto \mathrm{tr}_{A^*}\left(U_{BA}^\dagger \mathsf{F} U_{BA}(\cdot)^\top\right)$是$\mathsf{CJ}^\prime$的逆即可，经过计算
$$
\mathsf{CJ}^\prime\circ \mathsf{CJ}^{\prime{-1}}(\mathsf{F})=U_{BA}\mathrm{tr}_{A^*}\left(U_{BA}^\dagger \mathsf{F} U_{BA}(\cdot)^\top\right)\otimes \mathrm{id}(|I\rangle\langle I |)U_{BA}^\dagger =\mathsf{F}
$$
利用上式，对于任何$\mathsf{F}\in \mathsf{Choi}$，有
$$
\mathrm{tr}_B(\mathsf{CJ}\circ \mathsf{CJ}^{\prime -1}(\mathsf{F}))=\mathrm{tr}_B(U_{BA}^\dagger \mathsf{F} U_{BA})=\mathrm{tr}_B(U_{BA}^\dagger \sum X_i\otimes Y_i B_{BA})=U_A^\dagger \sum \mathrm{tr}(X_i)Y_i U_A^\dagger = U_A^\dagger \mathbb{I}_{A^*} U_A=\mathbb{I}_{A^*}
$$
因此，$\mathsf{CJ}^{\prime -1}(\mathsf{F})$具有保迹性，全正性显然，故$\mathsf{CJ}^{\prime -1}(\mathsf{F}) \in \mathsf{Chn}$。

$\mathsf{Choi}$和$\mathsf{Chn}$之间的任何同构都都可以写成标准的$\mathsf{CJ}$复上$\mathsf{Choi}$上的自同构，而半正定矩阵锥上的最一般的自同构是幺正、反幺正变换(或者额外加上一个转置)。因此只需要证明$\mathsf{Choi}$上的保迹条件等价于幺正变换的局域性即可，这就是下面的定理。

**定理：蔡氏矩阵的唯一性**

- 设$U\in B(\mathsf{H}^B\otimes \mathsf{H}^{A*})$是幺正变换，则$T=\{\mathsf{E}\in B(\mathsf{H}^B\otimes \mathsf{H}^{A*})\mid \mathrm{tr}_B(\mathsf{E})=\mathbb{I}_{A^*} \}$, 则
  $$
  U T U^\dagger = T \implies U=U_1\otimes U_2
  $$

**证明**

- 设$\sigma_i^A$和$\sigma_i^B$是两个系统上的无迹厄米算符基底，则$T$中的一般的算符可以写成 (oreshkov2012QuantumCorrelationsNo, S8)
  $$
  T=\frac{I}{d_{B}}\left(\mathbb{I}+\sum_{i>0} a_i \sigma_i^{B}+\sum_{i j>0} t_{i j} \sigma_i^{A} \sigma_j^{B}\right)
  $$
  $$
  T^\perp = \mathrm{span}_\mathbb{R}\{ \sigma_i^A \}
  $$
  而$UTU^\dagger$等价于$U T^\perp U_\dagger$，根据引理，后者蕴含$U$是局域的。

**命题：Choi-Jamiolkowski(CJ)同构的逆** (Encyclopedia2006, p.475; milz2021, (95))

任取正定矩阵$\mathsf{E}\in B(\mathsf{H}^B\otimes\mathsf{H}^{A*})$，CJ同构的逆映射为
$$
\begin{aligned}
\mathsf{E}\mapsto \mathcal{E}(\cdot) = & \mathrm{tr}_{A^*A }\left(\mathsf{E}\tau_A^{\mathrm{id}}(\cdot) \right)\\ = &\mathrm{tr}_{{A^*}}\left(\mathsf{E}(\cdot)^\top\right)\\
=& \sum_{i j} \operatorname{tr}\left(\mathsf{E}\left( |e_{i}^{\prime} \rangle_B \langle e_{j}^{\prime} | \otimes(\cdot)^{\top}\right)\right) |e_{j}^{\prime} \rangle_B\langle e_{i}^{\prime} |
\end{aligned}
$$
其中$\mathcal{E}:B(\mathsf{H}^A)\rightarrow B(\mathsf{H}^B)$，$\tau_A^{\mathrm{id}}\equiv \left(\rho _{A|A}^{\mathrm{id}}\right)^\top=\rho _{A^*|A^*}^{\mathrm{id}}=\sum_{i, j}|i\rangle_{A^*}\langle j| \otimes|i\rangle_A\langle j|$。未充满整个系统的算符自动用单位算符填充满整个系统。第一个等号右边的$\mathrm{tr}$内的三个系统的排列顺序是$BA^*A$。

在蔡氏矩阵的另一个约定下， 任取正定矩阵$\mathsf{E}\in B(\mathsf{H}^{A*}\otimes\mathsf{H}^B)$，CJ同构的逆映射为
$$
\begin{aligned}
\mathsf{E}\mapsto \mathcal{E}(\cdot) = & \mathrm{tr}_{A^*A }\left(\mathsf{E}\tau_A^{\mathrm{id}}(\cdot) \right)\\ = &\mathrm{tr}_{{A^*}}\left(\mathsf{E}(\cdot)^\top\right)\\
=& \sum_{i j} \operatorname{tr}\left(\mathsf{E}\left((\cdot)^{\top}\otimes |e_{i}^{\prime} \rangle_B \langle e_{j}^{\prime} | \right)\right) |e_{j}^{\prime} \rangle_B\langle e_{i}^{\prime} |
\end{aligned}
$$
其中$\mathcal{E}:B(\mathsf{H}^A)\rightarrow B(\mathsf{H}^B)$，$\tau_A^{\mathrm{id}}\equiv \left(\rho _{A|A}^{\mathrm{id}}\right)^\top=\rho _{A^*|A^*}^{\mathrm{id}}=\sum_{i, j}|i\rangle_{A}\langle j| \otimes|i\rangle_{A^*}\langle j|$。未充满整个系统的算符自动用单位算符填充满整个系统。第一个等号右边的$\mathrm{tr}$内的三个系统的排列顺序是$AA^*B$。

**证明**

- 先证明第一个等号
  $$
  \begin{aligned}
  & \operatorname{tr}_{A^* A}\left(\rho_{B | A}^{\mathcal{E}} \tau_A^{\mathrm{id}} \rho_A\right) \\
  = & \left.\left.\left.\operatorname{tr}_{A^* A}\left((\mathcal{E}( | i\rangle_A\langle i|\right) \otimes|i\rangle_{A^*}\langle j| \otimes \mathbb{I}_A\right)\left(\mathbb{I}_B \otimes | k\right\rangle_{A^*}\langle l| \otimes|k\rangle_A\langle l|\right)\left(\mathbb{I}_A \otimes \mathbb{I}_{A^*} \otimes \rho_A\right)\right) \\
  = & \operatorname{tr}_{A^* A}\left(\left(\mathcal{E}\left(|i\rangle_A\langle k |\right) \otimes|i\rangle_{A^*}\langle l| \otimes|k\rangle\langle l| \rho_A\right)\right. \\
  = & \mathcal{E}(|i\rangle\langle k|)\langle i| \rho_A|k\rangle \\
  = & \mathcal{E}\left(\rho_A\right)
  \end{aligned}
  $$
- 再补充中间步骤，将右边三个式子串起来
  $$
  \begin{aligned}
  & \operatorname{tr}_{A^* A}\left(\rho_{B | A}^{\mathcal{E}} \tau_A^{\mathrm{id}} \rho_A\right) \\
  & \left.\left.=\operatorname{tr}_{A^* A}\left((\mathcal{E}( | i\rangle_A\langle j|\right) \otimes|i\rangle_{A^*}\langle j| \otimes \mathbb{I}_A\right)\left(\mathbb{I}_B \otimes|k\rangle_{A^*}\langle l| \otimes|k\rangle_A\langle l|\right)\left(\mathbb{I}_B \otimes \mathbb{I}_{A^*} \otimes \rho_A\right)\right) \\
  & \left.=\operatorname{tr}_{A^* A}\left(\rho_{B | A}^{\mathcal{E}} \otimes \mathbb{I}_A\left(\mathbb{I}_B \otimes | k\right\rangle_{A^*}\langle l| \otimes|k\rangle_A\langle 1|\right)\left(\mathbb{I}_B \otimes \mathbb{I}_{A^*} \otimes \rho_A\right)\right) \\
  & \left.=\operatorname{tr}_{A^*}\left(\rho_{B | A}^{\mathcal{E}}\left(\mathbb{I}_B |k\right\rangle_{A ^*}\langle l|\right)\langle l| \rho_A|k\rangle\right) \\
  & =\operatorname{tr}_{A^*}\left(\rho_{B | A}^{\mathcal{E}}\left(\mathbb{I}_B \otimes \rho_A^T\right)\right) \\
  & \sum_{i j} \operatorname{tr}\left(\rho_{B | A}^{\mathcal{E}}\left( |i^{\prime} \rangle_B \langle j^{\prime} | \otimes(\cdot)^{\top}\right)\right) |j^{\prime} \rangle_B\langle i^{\prime} |
  \end{aligned}
  $$
- 上面只对蔡氏矩阵的第一个约定进行了证明，在另一个约定下的证明是类似的。

**笔记**

- 转置是关于基底$\{e_i\}$做的，逆映射给出了一个信道的显式表达式，实际上当我们使用对偶基时，不需要指明转置是关于哪个基做的，算符的转置是良定义的，即与基变换对易的。
- 对偶基的使用是合理的，这是因为转置被定义为$\rho_A^\top: \mathsf{H}^{A*}\rightarrow \mathsf{H}^{A*}$，转置且与$B$直积后的$\rho^A$与$\mathsf{E}$形状保持一致。
- 注意到性质$\mathrm{tr}_2((\mathbb{I}_1\otimes B)( C\otimes D))=\mathrm{tr}_2((C\otimes D)(\mathbb{I}_1 \otimes B) )$，所以有些步骤中$\mathsf{E}$的位置是可以变动的。
- 两个不同的形式实际上利用了$\tau^\mathrm{id}$可以实现部分转置的性质，
  设$\mathsf{M}\in B(\mathsf{H}_2\otimes \mathsf{H}_1^*)$，$\mathsf{M}=\sum m_{ijkl}|i\rangle_2\langle j|\otimes |k\rangle_{1^*}\langle l|$
  则
  $$
  \mathrm{tr}_2\left(\tau_2^\mathrm{id}\mathsf{M}\right)=\sum \mathrm{tr}_2(|p\rangle_{2^*}\langle q|\otimes|p\rangle_{2}\langle q|m_{ijkl}|i\rangle_2\langle j|\otimes |k\rangle_{1^*}\langle l|)=\sum m_{ijkl} |j\rangle_{2^*}\langle i|\otimes |k\rangle_{1^*}\langle l| =\mathsf{M}^{\top_2}
  $$
- 利用公式，可以重新计算出蔡氏矩阵，
  $$
  \begin{aligned} & (\mathcal{E} \otimes \mathbb{I})|I \rangle\langle I| \\ = & (\mathcal{E} \otimes \mathbb{I})\left(\sum\left|e_{k}\right\rangle\left\langle e_{l}|\otimes| e_{k}\right\rangle\left\langle e_{l}\right|\right) \\ = & \sum \operatorname{tr}\left(\mathsf{E}\left( |e_{i}^{\prime} \rangle \langle e_{j}^{\prime}|\otimes| e_{l} \rangle \langle e_{k} |\right)\right)\left|e_{j}^{\prime}\right\rangle\left\langle e_{i}^{\prime}|\otimes| e_{k}\right\rangle\left\langle e_{l}\right| \\ = & ~\mathsf{E}\end{aligned}
  $$

**命题：用蔡氏矩阵刻画保迹性和unitality**

- 映射$\mathcal{E}$保迹当且仅当$\mathrm{tr}(\mathcal{E}(|i\rangle\langle j|))\otimes|i\rangle\langle j|=\delta_{ij}|i\rangle\langle j|=\mathbb{I}_{A^*}$，或等价地$\mathrm{tr}_B(\mathsf{E})=\mathbb{I}_{A^*}$。
- 另外我们还可以用超线性映射来刻画这个保迹条件，设
  $$
  \mathcal{P}: B\left(\mathsf{H}^{B} \otimes \mathsf{H}^{A*}\right) \rightarrow B\left(\mathsf{H}^{B} \otimes \mathsf{H}^{A*}\right),~\mathcal{P}\mathsf{E} =(1-{}_B+{}_{BA^*})\mathsf{E}
  $$
  其中${}_i \mathsf{E}=\mathrm{tr}_i(\mathsf{E})\otimes \mathbb{I}_i/d_i$是子系统$i$的完全退极化信道，可以证明$\mathcal{P}$是一个算符系统上的正交投影，则
  $$
  \mathrm{tr}_B(\mathsf{E})=\mathbb{I}_{A^*}\Leftrightarrow \mathrm{tr}(\mathsf{E})=d_A\text{ 且 } \mathrm{tr}_B(\mathsf{E})=\mathrm{tr}(\mathsf{E})\otimes \mathbb{I}_{A*}/d_A\Leftrightarrow \mathrm{tr}(\mathsf{E})=d_A\text{ 且 } \mathcal{P}\mathsf{E}=\mathsf{E}
  $$
- 映射$\mathcal{E}$是unital的当且仅当$\mathrm{tr}_{A^*}(\mathsf{E})=\mathbb{I}_B$

**证明**

- 保迹条件的投影算符刻画的证明参见 (hoffreumon2021MultiroundProcessMatrix, Apd.2), (hoffreumon2023CharacterizationHigherorderQuantum, (3.10))

**笔记**

- 综合该命题和推论，可得信道的蔡氏矩阵刻画。

设$\varrho_j$是$D(\mathsf{H})$的一组基(不必正定)，$\vartheta_j$是其对偶基，满足$\mathrm{tr}(\vartheta^\dagger_i \varrho_j)=\delta_{ij}$，则有蔡氏矩阵分解公式
$$
\mathsf{E}= \sum_j \mathcal{E}(\varrho_j)\otimes \vartheta_j ^* \in B(\mathsf{H}^B \otimes \mathsf{H}^{A*})
$$
直接将上述分解式代入可得
$$
\begin{aligned}
\mathrm{tr}_2\left((\mathbb{I}_1\otimes (\cdot)^\top)\mathsf{E}\right)=\mathrm{tr}_2\left((\mathbb{I}\otimes \rho^\top) \sum_j \mathcal{E}(\varrho_j)\otimes \vartheta_j^*\right)=\sum \mathcal{E}(\varrho_j)\mathrm{tr}(\rho^\top \vartheta_j^*)=\sum \mathcal{E}(\varrho_j)\mathrm{tr}(\rho\vartheta_j^\dagger)=\mathcal{E}(\rho)
\end{aligned}
$$
这证明了分解式的正确性。

蔡氏矩阵的本征值和本征态是什么，有没有简单的表达式？

可以用 Kraus 算符的双矢量形式表达蔡氏矩阵，设$\mathcal{E}(\rho)=\sum E_{i}\rho E_{i}^{\dagger}$，双矢量化的Kraus算符为
$$
\left|E_k\right\rangle=\sum \left\langle i\left|E_k\right| j\right\rangle|i\rangle_B|j\rangle_{A^*} \in \mathsf{H}^B\otimes \mathsf{H}^{A^*}
$$
$$
\begin{aligned}
\langle E_k | & =\sum \langle i|\langle j|\overline{ \langle |E_k | j \rangle} \\
& =\sum \langle i|\langle j| \langle j |E_k^{\dagger} | i \rangle
\end{aligned}
$$
蔡氏矩阵
$$
\begin{aligned}\mathsf{E}=\mathcal{E}\otimes \mathbb{I}(|I\rangle\langle I|) &=\sum E_{k}|i\rangle \langle j|E_{k}^{\dagger}\otimes|i\rangle \langle j|\\ &=\sum|l\rangle \langle l|E_{k}|i\rangle \langle j|E_{k}^{\dagger}|m\rangle\langle m|\otimes|i\rangle \langle j|\\ &=\sum\langle l|E_{k}|i\rangle |\ell\rangle |i\rangle \langle m|\langle j|\langle j|E_{k}^{\dagger}|m\rangle \\ &=\sum|E_{k}\rangle \langle E_{k}|\in B(\mathsf{H}^B\otimes \mathsf{H}^{A^*})
\end{aligned}
$$

**命题：复合信道的蔡氏矩阵** (chiribella2009TheoreticalFrameworkQuantum; milz2021, (187))

设量子信道$B\left(\mathsf{H}_1\right) \xrightarrow{\mathcal{M}} B\left(\mathsf{H}_2\right) \xrightarrow{\mathcal{K}} B\left(\mathsf{H}_3\right) \xrightarrow{\mathcal{H}} B\left(\mathsf{H}_4\right)$，信道$\mathcal{M}$和$\mathcal{K}$的蔡氏矩阵分别为$\mathsf{M}$和$\mathsf{K}$，则信道$\mathcal{KM}$的蔡氏矩阵
$$
\mathsf{K}\star\mathsf{M} =\mathrm{tr}_{2^*}\left((\mathbb{I}_3\otimes \mathsf{M}^{\top_2} )(\mathsf{K}\otimes \mathbb{I}_1)\right) =\mathrm{tr}_{2^*}(\mathsf{M}^{\top_2}\mathsf{K})=\mathrm{tr}_{2^*,2}\left(\mathsf{K}\tau_2^\mathrm{id}\mathsf{M}\right)
$$
其中$\mathsf{K}\star \mathsf{M}\in B(\mathsf{H}_3\otimes \mathsf{H}_1^*)$，$\tau_2^{\mathrm{id}}:=\sum_{i, j}|i\rangle_{2^*}\langle j| \otimes|i\rangle_2\langle j| = |\mathbb{I}\rangle\langle \mathbb{I}|_{2^*2}$。

稍作推广，信道$\mathcal{HKM}$的蔡氏矩阵是
$$
\mathrm{tr}_{{2^*,3^*}}\left(\left(\mathbb{I}_4 \otimes \mathbb{I}_{3^*} \otimes \mathsf{M}^{\top_2}\right)\left(\mathbb{I}_4 \otimes \mathsf{K}^{\top_3} \otimes \mathbb{I}_{1^*}\right)\left(\mathsf{H} \otimes \mathbb{I}_{2^*} \otimes \mathbb{I}_{1^*}\right)\right)=\mathrm{tr}_{2^*,3^*}(\mathsf{M}^{\top_2}\mathsf{K}^{\top_3}\mathsf{H} )=\mathrm{tr}_{2^*,2,3^*,3}(\mathsf{H}\tau_C^{\mathrm{id}}\mathsf{K}\tau_B^\mathrm{id}\mathsf{M})
$$
偏迹内的系统分别是$43^*2^*1^*$和$43^*32^*21^*$

在蔡氏矩阵的另一种约定下：
设量子信道$B\left(\mathsf{H}_1\right) \xrightarrow{\mathcal{M}} B\left(\mathsf{H}_2\right) \xrightarrow{\mathcal{K}} B\left(\mathsf{H}_3\right) \xrightarrow{\mathcal{H}} B\left(\mathsf{H}_4\right)$，信道$\mathcal{M}$和$\mathcal{K}$的蔡氏矩阵分别为$\mathsf{M}$和$\mathsf{K}$，则信道$\mathcal{KM}$的蔡氏矩阵
$$
\mathsf{K}\star\mathsf{M} =\mathrm{tr}_{2^*}\left((\mathsf{M}^{\top_2} \otimes \mathbb{I}_3)(\mathbb{I}_1 \otimes\mathsf{K} )\right) =\mathrm{tr}_{2^*}(\mathsf{M}^{\top_2}\mathsf{K})=\mathrm{tr}_{2^*,2}\left(\mathsf{K}\tau_2^\mathrm{id}\mathsf{M}\right)
$$
其中$\mathsf{K}\star \mathsf{M}\in B(\mathsf{H}_1^*\otimes \mathsf{H}_3)$，$\tau_2^{\mathrm{id}}:=\sum_{i, j}|i\rangle_{2}\langle j| \otimes|i\rangle_{2^*}\langle j| = |\mathbb{I}\rangle\langle \mathbb{I}|_{2^*2}$。

稍作推广，信道$\mathcal{HKM}$的蔡氏矩阵是
$$
\mathrm{tr}_{{2^*,3^*}}\left(\left(\mathsf{M}^{\top_2}\otimes \mathbb{I}_{3^*} \otimes \mathbb{I}_4 \right)\left(\mathbb{I}_{1^*} \otimes \mathsf{K}^{\top_3} \otimes \mathbb{I}_4\right)\left(\mathbb{I}_{1^*} \otimes \mathbb{I}_{2^*} \otimes \mathsf{H} \right)\right)=\mathrm{tr}_{2^*,3^*}(\mathsf{M}^{\top_2}\mathsf{K}^{\top_3}\mathsf{H} )=\mathrm{tr}_{2^*,2,3^*,3}(\mathsf{H}\tau_C^{\mathrm{id}}\mathsf{K}\tau_B^\mathrm{id}\mathsf{M})
$$
偏迹内的系统分别是$1^*2^*3^*4$和$1^*22^*33^*4$

**证明**
$$
\begin{aligned}
\mathcal{K} \circ \mathcal{M}(\rho) & =\operatorname{tr}_2\left(\left(\mathbb{I}_{H_3} \otimes\left(\operatorname{tr}_{H_1}\left(\left(\mathbb{I}_{H_2} \otimes \rho^{\top}\right) \mathsf{M}\right)\right)^{\top}\right) \mathsf{K}\right) \\
& =\operatorname{tr}_{2}\left(\mathbb{I}_3 \otimes \operatorname{tr}_1\left(\left(\mathbb{I}_2 \otimes \rho^{\top}\right) \mathsf{M}^{T_2}\right) \mathsf{K}\right) \\
& =\operatorname{tr}_{12}\left(\left(\mathbb{I}_3 \otimes \mathbb{I}_2 \otimes \rho^{\top}\right)\left(\mathbb{I}_3 \otimes \mathsf{M}^{T_2}\right)\left(\mathsf{K} \otimes \mathbb{I}_1\right)\right) \\
& =\operatorname{tr}_1\left(\mathbb{I}_3 \otimes \rho^{\top} \operatorname{tr}_2\left(\mathbb{I}_3 \otimes \mathsf{M}^{T_2}\right)\left(\mathsf{K} \otimes \mathbb{I}_1\right)\right) \\
\mathcal{K} \mathcal{M}(\rho) & =\operatorname{tr}_1\left(\left(\mathbb{I}_3 \otimes \rho^{\top}\right) \mathsf{K} \star \mathsf{M}\right)
\end{aligned}
$$
利用另一个公式可得
$$
\begin{aligned}
\mathcal{K}\circ \mathcal{M}(\rho_A)& =\mathrm{tr}_{B^*BA^*A}(\mathsf{K}\tau_B^{\mathrm{id}}\mathsf{M}\tau_A^\mathrm{id}\rho_A)\\
& =\mathrm{tr}_{A A^*}\left(\mathsf{K}\star \mathsf{M} \tau_A^\mathrm{id}\rho_A\right)
\end{aligned}
$$
其中$A=1,B=2$
类似地，当三个信道复合时，
$$
\begin{aligned}
\mathcal{H}\circ \mathcal{K} \circ \mathcal{M}(\rho) & = \operatorname{tr}_{3}\left(I_{4}\otimes \left(\operatorname{tr}_{2}\left(I_{3} \otimes\left(\operatorname{tr}_{1}\left(\left(I_{2} \otimes \rho^{\top}\right) \mathsf{M}\right)\right)^{\top}\right) \mathsf{K}\right)^{\top} \mathsf{H}\right) \\
& =\operatorname{tr}_3\left(I_4 \otimes\left(\operatorname{tr}_2\left(\left(I_3 \otimes \operatorname{tr}_1\left(\left(I_2 \otimes \rho^{\top}\right) \mathsf{M}^{T_2}\right)\right) \mathsf{K}\right)^{\top} \mathsf{H}\right)\right) \\
& =\operatorname{tr}_3(I_4 \otimes \operatorname{tr}_2((I_3 \otimes \operatorname{tr}_1((I_2 \otimes \rho^{\top}) \mathsf{M}^{T_2})) \mathsf{K}^{T_3} \mathsf{H})) \\
& =\operatorname{tr}_{1,2,3} \left(\left(I_4 \otimes I_3 \otimes I_2 \otimes \rho^{\top}\right)\left(I_4 \otimes I_3 \otimes \mathsf{M}^{T_2}\right)\left(I_4 \otimes \mathsf{K}^{T_3} \otimes I_1\right)\left(\mathsf{H} \otimes I_2 \otimes I_1\right)\right) \\
& =\operatorname{tr}_1\left(\left(I_4 \otimes \rho^{\top}\right) \operatorname{tr}_{{2,3}}\left(\left(I_4 \otimes I_3 \otimes \mathsf{M}^{T_2}\right)\left(I_4 \otimes \mathsf{K}^{T_3} \otimes I_1\right)\left(\mathsf{H} \otimes I_2 \otimes I_1\right)\right)\right)
\end{aligned}
$$
上面只对蔡氏矩阵的第一个约定进行了证明，在另一个约定下的证明是类似的。

**笔记**

- 数值验证参见：`验证和蔡氏矩阵、过程矩阵有关的公式.nb`
- 注意我们总是可以任意交换偏迹内的算符的顺序，因为非平凡的重叠最终都trace掉了。

遵循类似的推导，如果我们总是将偏迹外面的转置完整地作用到最内层括号，而不是将其视为部分转置，可以得到$P\left(\mathcal{M}_i^A, \mathcal{M}_j^B\right)=\operatorname{tr}\left[\mathcal{M}_i^A \circ \mathcal{C} \circ \mathcal{M}_j^B\left(\rho^{B_1}\right)\right]$对应的过程矩阵 (oreshkov2012QuantumCorrelationsNo, (5)) 为
$$
W^{A_2 A_1 B_2 B_1} = \mathbb{I}_4\otimes \mathsf{C}^\top \otimes \rho^\top
$$
过程矩阵满足
$$
P\left(\mathcal{M}_i^A, \mathcal{M}_j^B\right) =\mathrm{tr}\left( W^{A_2 A_1 B_2 B_1} \mathsf{M}^A\otimes \mathsf{M}^B\right)
$$
过程矩阵与论文中的形式稍有不同，可能是记号差别，我的推导已经经过数值验证。

如果使用相反的蔡氏矩阵的约定$\mathsf{E}=\mathbb{I}\otimes \mathcal{E}(|I\rangle \langle I|)$，那么
$$
\operatorname{tr}\left[\mathcal{M}_i^A \circ \mathcal{C} \circ \mathcal{M}_j^B\left(\rho^{B_1}\right)\right]=\mathrm{tr}\left( \rho^\top \otimes \mathsf{C}^\top\otimes \mathbb{I}_4 \mathsf{M}^B\otimes \mathsf{M}^A\right)
$$
与另一种约定的顺序刚好相反。

更一般的过程矩阵定义参见...

[Image Placeholder: 待整理：蔡氏矩阵和信道的双矢量化只差矩阵元素的重排 proj.p.71 - image//2024-07-01-12-14-42.png]

蔡氏矩阵可以进行概率性的信道传态，
$$
\begin{aligned}&\langle \mathbb{I} |_{23} \mathcal{E} \otimes \mathcal{I} (|\mathbb{I}\rangle\langle\mathbb{I}|)_{12} \otimes \rho_3 |\mathbb{I}\rangle_{23} \\
= &\mathcal{I}_1 \otimes \langle i|_2 \langle i|_3 | \mathcal{E}(|j\rangle\langle k|) \otimes |j\rangle\langle k|_2 \otimes \rho \otimes \mathcal{I}_1 \otimes |l\rangle\langle l|_3 \rangle \\
= &\mathcal{E}(|i\rangle\langle k|) \delta_{ij} \delta_{kl} \langle i|\rho|l \rangle \\
= &\mathcal{E}(|j\rangle\langle k|) \langle j|\rho|l \rangle \\
=& \mathcal{E}(\rho)\end{aligned}
$$
好的，我完全理解。为了确保绝对的忠实性，我将继续严格地只进行格式转换，不进行任何内容的删减或改写。

这是您笔记的第三部分，也是最后一部分。

---

### 量子信道的Kraus算符形式与系统-环境耦合形式

**定理：量子信道的Choi-Kraus算符和表示** (beck2020localization, Th.1.17)

- 设$\mathsf{H}_A$和$\mathsf{H}_B$是Hilbert空间，$\rho_A\in D(\mathsf{H}_A)$ 是$\mathsf{H}_A$ 上的密度算符，映射$\mathcal{E}:B(\mathsf{H}_A)\rightarrow B(\mathsf{H}_B)$是量子信道的当且仅当存在一组Kraus算符$E_i:\mathsf{H}_A\rightarrow \mathsf{H}_B$，满足
  $$
  \mathcal{E}(\rho_A)=\sum_{i=1}^{r}E_i\rho_AE_i^\text{}
  $$
  且
  $$
  \sum_{i=1}^{r}E_i^\text{} E_i=\mathbb{I}_A
  $$
  其中$r\leqslant \mathrm{dim}(\mathsf{H}_A)\mathrm{dim}(\mathsf{H}_B)$。

- $\mathcal{E}$是量子操作当且仅当归一化条件改为
  $$
  \sum_{i=1}^{r}E_i^\text{} E_i\leqslant \mathbb{I}_A
  $$

**证明**

- (全正性$\Rightarrow$算符和形式)利用蔡氏定理。任取$|\psi\rangle=c_k|k\rangle \in \mathsf{H}_A$，$\{|i\rangle\}$是$\mathsf{H}_A$上的一组ONB，$\rho \in |\psi\rangle \langle \psi|$
  $$
  \begin{aligned} \mathcal{E}(\rho) & =\mathcal{E}(|\psi\rangle\langle\psi|) =\sum_{k l} c_{k} \overline{c_{l}} \mathcal{E}(|k\rangle\langle l|) =\langle\bar{\psi}|(\mathcal{E} \otimes \mathbb{I})(|k\rangle\langle l|\otimes| k\rangle\langle l|)| \bar{\psi}\rangle \\ & =\langle\bar{\psi}|(\mathcal{E} \otimes \mathbb{I})(|I\rangle\langle I|)| \bar{\psi}\rangle d_{A}^{2} =\left\langle\psi \mid\left(\sum_{k} p_{k}\left|\varphi_{k}\right\rangle\left\langle\varphi_{k}\right|\right) \psi\right\rangle d_{A}^{2} =\sum R_{k}|\psi\rangle\langle\psi| R_{k}^\text{} \\ & R_{k}|l\rangle \equiv \sqrt{p_{k}} d_{A}\left\langle l \mid \varphi_{k}\right\rangle \\ \Rightarrow & R_{k}|\psi\rangle=\sqrt{p_{k}} d_{A}\left\langle\bar{\psi} \mid \varphi_{k}\right\rangle\end{aligned}
  $$
- (全正性$\Leftarrow$算符和形式)
  $$
  \mathcal{E}\otimes \mathrm{id}(|I\rangle\langle I|)=\sum_k E_k \otimes \mathbb{I}|I\rangle\langle I| E_k^{\dagger} \otimes \mathbb{I} \geq 0 .
  $$
  其中$|I\rangle =\sum |ii\rangle$是未归一化的最大纠缠态。

**笔记**

- Kraus算符分解可以被限制到给定的密度算符$\rho$的支集上，有更好看的分解形式 (tyson2010TwosidedBoundsMinimumerror, Def.41)。
- 另一个证明参见Stinespring表示到Kraus表示的推导。

***
**MyBox**

量子信道$\mathcal{E}$存在“$\rho$-Kraus 分解”，取$\rho$为最大混态，该分解实际上要求Kraus算符具有正交归一性 (tyson2010TwosidedBoundsMinimumerror, (140))
$$
\mathcal{E}(\cdot)=\sum p_i F_i\cdot F_i^\dagger
$$
其中$F_i$满足$\mathrm{tr}\left(F_k^\dagger F_l\right)=n\delta_{kl}$，计算该分解的具体方法是(…)。
***

Kraus算符有一定的规范自由度，用一个幺正算符中的元素对Kraus算符做线性组合，得到的Kraus算符对应相同的量子信道。

**命题：算符和表示的幺正自由度**

- 设 $\mathcal{E}:B(\mathsf{H}_1)\rightarrow B(\mathsf{H}_2)$是线性映射，满足$\mathcal{E}(\cdot)=\sum_{i=1}^n E_i\cdot E_i^\dagger$，则下列等价
  1. $\mathcal{E}(\cdot)=\sum_{i=1}^n F_i\cdot F_i^\dagger$
  2. 存在$n\times n$的幺正矩阵$(u_{ij})$，满足$E_{i}=\sum_{j} u_{i j} F_{j}$

**证明**

- (2)$\Rightarrow$(1)易得。
- (1)$\Rightarrow$(2)
  根据双矢量公式，有
  $$
  \sum_{i=1}^{n} E_{i} \otimes E_{i}^{*}=\sum_{i=1}^{n} F_{i} \otimes F_{i}^{*}
  $$
  在矩阵空间中找到一组ONB$\{K_i\}$。设$E_{i}=\sum_{j} e_{i j} K_{j}, F_{i}=\sum_{j} f_{i j} K_{j}$，
  $$
  \begin{aligned}&\sum_{i=1}^n E_{i} \otimes E_{i}^{*}=\sum F_{i} \otimes F_{i}^{*} \\ \Rightarrow & \sum e_{i j} e_{i p}^{*} K_{j} \otimes K_{p}^{*}=\sum f_{i j} f_{i p}^{*} K_{j} \otimes K_{p}^{*}\end{aligned}
  $$
  设$E=(e_{ij})$，$F=(f_{ij})$，则有
  $$
  E^\dagger E=F^\dagger F
  $$
  根据极分解$E=U_1|E|$，$F=U_2|F|=U_2|E|$ ，可知存在幺正矩阵满足$E=U F$，即存在$n\times n$的幺正矩阵$(u_{ij})$，满足$E_{i}=\sum_{j} u_{i j} F_{j}$。

**笔记**

- 回忆：两个系综构成相同的混态$\Leftrightarrow$这两组系综之间只相差幺正变换。
- 如果两个量子操作成正比(可以证明比例系数和输入的量子态无关)，那么他们的Kraus算符可以相互线性表示(待证)。但反之不然，即便Kraus算符能够线性表示，也不意味着信道成正比，例如不同参数对应着不同的退极化信道。

**命题：算符和表示的最小尺寸**

- 设$\rho\in D(\mathsf{H})$是$d$维Hilbert空间上的密度算符，量子信道~$\mathcal{E}$有Kraus算符和表示
  $$
  \mathcal{E}(\rho)=\sum_{k=1}^{M} E_{k} \rho E_{k}^{\text{}}
  $$
  设矩阵$(W_{j k}) \equiv \left(\operatorname{tr}\left(E_{j}^{\text{}} E_{k}\right)\right)\in \mathbb{C}^{M\times M}$，$\mathrm{rank}(W)=r$，则$M$是Hermite矩阵，$r\leqslant d^2$且$\mathcal{E}$的任意算符和表示的Kraus算符的个数至少有$r$个。

**证明**

- 利用trace相关性质可以证明$W$的Hermite性
  $$
  \overline{W_{kj}}=\overline{\operatorname{tr}\left(E_{k}^{\text{}} E_{j}\right)}=\operatorname{tr}\left(E_{j}^{\text{}} E_{k}\right)=W_{j k}
  $$
- 设$\{e_k\}$是$\rho$生活的空间$D(\mathsf{H})$的一组ONB，将每个Kraus算符关于这组基做分解，有
  $$
  E_{j}=\sum_{k=1}^{d^{2}} \alpha_{j k} e_{k}, j=1,2, \cdots, M
  $$
- 利用ONB的正交归一性，可以将矩阵$W$写成
  $$
  \begin{aligned} W_{ jk} & =\sum_{p,l=1}^{d^{2}}\operatorname{tr}\left(\overline{\alpha_{jp}} e_{p}^{\text{}} \alpha_{k l} e_{l}\right) \\ & =\sum_{p=1}^{d^{2}} \overline{\alpha_{j p}}\alpha_{k p}\end{aligned}
  $$
- 设矩阵[^1]$A=(\alpha_{ij})$，则
  $$
  W=\overline{A}A^\intercal
  $$
  因此，
  $$
  r=\mathrm{rank}(W)=\mathrm{rank}(\overline{A}A^\intercal)=\mathrm{rank}(AA^\text{})=\mathrm{rank}(A)\leqslant d^2
  $$
  其中，不等号是由于$A$的列数为$d^2$，最后一个等号可以用奇异值分解或者讨论方程$AX=0$的解空间的维度来证明，下面使用第二种方法，只要证明关于$X$的方程$AX=0$和$A^\text{} AX=0$同解即可，从$A^\text{} AX=0$可知$(AX)^\text{} AX=0$，因此$AX=0$，两个方程的解空间相同。
- 由于$W$是Hermite矩阵，因此存在$M$阶幺正矩阵$U$使$W$对角化，设
  $$
  UWU^\text{} =\mathrm{diag}(\lambda_1,\ldots,\lambda_r,0,\ldots,0),\quad \lambda_i\geqslant 0,i=1,\ldots,r
  $$
- 根据矩阵$U$定义一组等价的Kraus算符，
  $$
  F_{i}=\sum_{j=1}^{M} \overline{u_{i j}} E_{j}
  $$
- 根据$W$的定义式，有
  $$
  \sum_{j k=1}^{M} u_{i j} W_{j k} \overline{u_{l k}}=\operatorname{tr}\left(u_{i j} E_{j}^{\text{}} \overline{u_{l k}} E_{k}\right)=\operatorname{tr}\left(F_{i}^{\text{}} F_{l}\right),\quad i,l=1,\ldots,M
  $$
- 根据内积$\langle A,B\rangle=\mathrm{tr}(A^\text{} B )$的正定性可知，$\{F_i\}_{i=1,\ldots,M}$中的前$r$个非零，第$r+1$至第$M$个为零。由反证法可知，不可能存在项数更少的Kraus算符和表示。

**笔记**

- 本例使用的是幺正相似对角化而不是复合同对角化。
- 通常称$W$的秩$r$为量子信道~$\mathcal{E}$的**秩** (Fujiwara2008)，也称为**蔡氏秩** (watrous2018TheoryQuantumInformationa, p.78) 或**Kraus秩** (wolf2008DividingQuantumChannels, kraus1983CoexistentEffectsObservables)。显然，信道的秩等于蔡氏矩阵的秩：
  $$
  \begin{aligned}
  & \sum \mathcal{E}\otimes \mathbb{I}(|I\rangle\langle I|) \\
  = & \sum E_i \otimes \mathbb{I}|I\rangle\langle I| E_i^{\dagger} \otimes \mathbb{I} \\
  = & \sum \alpha_i\left|\psi_i\right\rangle\left\langle\psi_i\right|
  \end{aligned}
  $$
  $$
  \begin{aligned}
  \left\langle\psi_i \mid \psi_j\right\rangle & =\left\langle I\left|E_i^{\dagger} E_j\right| I\right\rangle =\operatorname{tr}\left(E_i^{\dagger} E_j\right) =\alpha_i \delta_{i j}
  \end{aligned}
  $$
  其中$|I\rangle = \sum_{i=1}^d|i, i\rangle$
- 这样定义的秩和$\mathcal{E}$作为线性映射的秩是什么关系呢？考虑一个幺正变换对应的信道，$\mathcal{E}(\cdot)=U\cdot U^\dagger$，它的量子信道秩为1（实际上，对于$\mathcal{E}:B(\mathsf{H})\rightarrow B(\mathsf{H})$，信道秩为1当且仅当信道是幺正的。），而作为线性映射是满秩的。取一组特殊的ONB~$\{e_i\}$，满足$(e_i)_{i_1,i_2}=1$，矩阵指标$(i_1,i_2)$与基向量指标$i$之间存在一一对应关系$i=(i_1-1)d+i_2$，$e_i$的其余元素为零。例如当$d=2$时，有
  $$
  e_1=\left(
  \begin{array}{cc}
  1 & 0 \\
  0 & 0 \\
  \end{array}
  \right),~e_2=\left(
  \begin{array}{cc}
  0 & 1 \\
  0 & 0 \\
  \end{array}
  \right),~e_3=\left(
  \begin{array}{cc}
  0 & 0 \\
  1 & 0 \\
  \end{array}
  \right),~e_4=\left(
  \begin{array}{cc}
  0 & 0 \\
  0 & 1 \\
  \end{array}
  \right)
  $$
- 这组ONB满足[^2]
  $$
  \operatorname{tr}\left(e_{l}^{\text{}} e_{p} e_{i} e_{q}^{\text{}}\right)=\delta_{l_1p_1}\delta_{i_1p_2}\delta_{l_2q_1}\delta_{i_2q_2}
  $$
- 设$\mathcal{E}$在$\{e_i\}$下的矩阵为$\widetilde{\mathcal{E}}$，即
  $$
  \left(\mathcal{E}\left(e_{1}\right), \ldots, \quad \mathcal{E}\left(e_{d^{2}}\right)\right)=\left(e_{1}, \cdots, e_{d^{2}}\right) \widetilde{\mathcal{E}}
  $$
  则有
  $$
  \widetilde{\mathcal{E}}_{l i}=\sum_{k} \operatorname{tr}\left(e_{l}^\text{} E_{k} e_{i} E_{k}^{\text{}}\right)=\sum_{k, p, q} \alpha_{k p} \overline{\alpha_{k q}} \operatorname{tr}\left(e_{l}^{\text{}} e_{p} e_{i} e_{q}^{\text{}}\right)=\sum_k \alpha_{k,(l_1-1)d+i_1}\overline{\alpha}_{k,(l_2-1) d+i_2}\equiv \sum_k \alpha_{k,f(l,i)}\overline{\alpha}_{k,g(l,i)}
  $$
- 上式的右侧不能简单地写成两个矩阵的乘积，显然，在一般情况下。
  $$
  \mathrm{rank}(\mathcal{\widetilde{E}})\neq \mathrm{rank}(A^\intercal \overline{A})=\mathrm{rank}(\overline{A}A^\intercal)=r
  $$
- 进而，我们不可能找到一组ONB，使得 $\operatorname{tr}\left(e_{l}^{\text{}} e_{p} e_{i} e_{q}^{\text{}}\right)=\delta_{lp}\delta_{iq}$成立[^3]，否则对于任意的$\mathcal{E}$，都有$\mathrm{rank}(\widetilde{\mathcal{E}})=r$成立。

**命题：量子操作的性质**

- 设$\mathcal{K}:D(\mathsf{H})\rightarrow D_\leq(\mathsf{H})$是量子操作，$\{K_i\}_{i=0,\ldots, m}$是相应的Kraus算符，那么对任意的$0<\kappa\leq 1$，有
  $$
  \sum_{l=1}^{m} K_{l}^{\text{}} K_{l} \leq \kappa \mathbb{I} \quad \Leftrightarrow \quad \operatorname{tr}(\mathcal{K}(\rho)) \leq \kappa \quad \forall \rho \in D(\mathsf{H})
  $$
  以及
  $$
  \sum_{l=1}^{m} K_{l}^{\text{}} K_{l} =\kappa \mathbb{I} \quad \Leftrightarrow \quad \operatorname{tr}(\mathcal{K}(\rho)) = \kappa \quad \forall \rho \in D(\mathsf{H})
  $$

**证明**

- 首先注意到$\mathcal{K}(\rho)$和$\sum_{l=1}^{m} K_{l}^{\text{}} K_{l}$是正定的。
- (必要性) $\sum_{l=1}^{m} K_{l}^{\text{}} K_{l} \leq \kappa \mathbb{I}$意味着$\sum_{l=1}^{m} K_{l}^{\text{}} K_{l}$的最大本征值小于等于$\kappa$，利用谱分解，有
  $$
  \begin{aligned} & \operatorname{tr}\left(\sum_{l=1}^{m} K_{l} \rho K_{l}^\text{}\right)=\operatorname{tr}\left(\sum_{l} K_{l}^\text{} K_{l} \rho\right) \\ = & \operatorname{tr}\left(\sum_{a} \lambda_{a}\left|e_{a}\right\rangle\left\langle e_{a}\right| \rho\right) \leqslant \kappa \sum \operatorname{tr}\left(\left|e_{a}\right\rangle\left\langle e_{a}\right| \rho\right)=\kappa \end{aligned}
  $$
- 取等号时，
  $$
  \operatorname{tr}\left(\sum_{l=1}^{m} K_{l} \rho K_{l}^\text{}\right)=\operatorname{tr}\left(\sum_{l} K_{l}^\text{} K_{l} \rho\right)=\kappa
  $$
- (充分性) 类似。

**笔记**

- 实际上是正算符的性质。
- 实际上没有用到$\kappa$小于等于1的性质？

**定理：Kraus算符形式与系统环境耦合形式的等价性** (Scherer2019, Th.3.24)

- $\mathcal{K}:B(\mathsf{H_1})\rightarrow B(\mathsf{H_1})$是线性映射，$\rho_1\in D(\mathsf{H_1})$则任取$0<\kappa\leqslant 1$，下列等价
  1. 存在Hilbert空间$\mathsf{H}_2$，线性变换$V\in B(\mathsf{H_1}\otimes \mathsf{H_2})$和量子态$\rho_2\in D( \mathsf{H_2})$，使得
     $$
     V^\dagger V\leqslant \kappa \mathbb{I}
     $$
     $$
     \mathcal{K}(\rho_1)=\mathrm{tr}_2(V\rho_1\otimes \rho_2 V^\dagger)
     $$
  2. 存在一组Kraus算符$K_l\in B(\mathsf{H_1})$，满足
     $$
     \sum_{l=1}^{m} K_l^\dagger K_l\leqslant \kappa \mathbb{I}
     $$
     $$
     \mathcal{K}(\rho_1)=\sum_{l=1}^{m}K_l\rho_1K_l^\dagger
     $$
  3. 存在线性变换$W:B(\mathsf{H}_1,\mathsf{H_1}\otimes \mathsf{H_2})$，使得
     $$
     W^\dagger W\leqslant \kappa \mathbb{I}
     $$
     $$
     \mathcal{K}(\rho_1)=\mathrm{tr}_2(W\rho_1 W^\dagger)
     $$
- 另外
  $$
  W^\dagger W=\kappa \mathbb{I}\Leftrightarrow V^\dagger V=\kappa \mathbb{I}\Leftrightarrow \sum_{l=1}^{m}K_l^\dagger K_l=\kappa \mathbb{I}
  $$

**证明**

- 只证明$\kappa=1$的情形，推广到$\kappa \ne 1$是容易的。另外，推广到$\mathcal{K}:B(\mathsf{H}_1)\rightarrow B(\mathsf{H}_3)$，$V:\mathsf{H}_1\otimes \mathsf{H}_2 \rightarrow \mathsf{H}_3\otimes \mathsf{H}_4$也是容易的。
- (1)$\Rightarrow$(2)
  $$
  \begin{aligned} \rho_{2} & =\sum q_{i}\left|f_{i}\right\rangle\left\langle f_{i}\right| \\ \mathcal{K}\left(\rho_{1}\right) & =\sum_{k {i}}\left\langle h_{k}\left|V\left(\rho_{1} \otimes\left. q_{i}\right| f_{i}\right\rangle\left\langle f_{i}\right|\right) V^\dagger \mid h_{k}\right\rangle \\ & =\sum_{l} K_{l} \rho_1 K_{l}^\dagger \\ K_{l} & =\sqrt{q_{i}}\left\langle h_{k}|V| f_{i}\right\rangle, l=(k, i) \\ \sum_{l} K_{l}^\dagger K_{l} & =\sum_{i k} q_{i}\left\langle f_{i}\left|V^\dagger\right| h_{k}\right\rangle\left\langle h_{k}|V| f_{i}\right\rangle \\ & =\sum_{i} q_{i}\left\langle f_{i}\left|V^\dagger V\right| f_{i}\right\rangle \\ & \leqslant \sum_{i} q_{i}\left\langle f_{i} \mid f_{i}\right\rangle \mathbb{I}_{1} \\ & =\mathbb{I}_{1}\end{aligned}
  $$
- (2)$\Rightarrow$(1)设$\mathcal{K}\left(\rho_{1}\right)=\sum_{l} K_{l} \rho_{1}K_{l}^{\dagger}$，定义映射
  $$
  \begin{aligned} \iota : H_{1} & \rightarrow H_{1} \otimes H_{2} \\ |\varphi\rangle & \mapsto |\varphi\rangle\left|f_{1}\right\rangle\end{aligned}
  $$
  $$
  \begin{aligned} &\tilde{V}:\iota \left(H_{1}\right) \rightarrow H_{1} \otimes H_{2} \\ &|\psi\rangle\left|f_{1}\right\rangle \mapsto \sum_{l=1}^{m} K_{l}|\psi\rangle\left|f_{l}\right\rangle \\& \tilde{V}=\sum_{l} K_{l} \otimes\left|f_{l}\right\rangle\left\langle f_{1}\right|\end{aligned}
  $$
- (1)$\Leftrightarrow$(3)显然。

**笔记**

- 系统环境耦合形式的量子信道表明，任何量子信道都可以通过一个直积系统上的幺正变换来实现，为量子信道提供了一种物理上的实现方式。然而这种表示信道方式的缺点是辅助系统的初态$\rho_2$和幺正变换$V$都具有较大的自由度。最小表示在不计环境的幺正变换的意义下是唯一的 (kretschmann2006InformationDisturbanceTradeoffContinuity, (12))。
- 实际上$V$有一个显式解 (lei2024DilationDiscriminationUhlmanns)。
- 如果没有直积态的条件就不能写成Kraus算符和的形式、也不能被视为量子信道。
- 从原信道到对偶信道的系统环境耦合表示 (serafini2017QuantumContinuousVariablesa, (5.61))：
  $$
  \Phi(\hat{A})=\operatorname{Tr}_2\left[\hat{S}^{\dagger} \hat{A} \otimes|0\rangle\langle 0| \hat{S}\right],
  $$
  $$
  \begin{aligned}
  \operatorname{Tr}_1\left[\hat{A} \Phi^*(\hat{B})\right] & =\operatorname{Tr}_1[\Phi(\hat{A}) \hat{B}]=\operatorname{Tr}_{1,2}\left[\hat{S}^{\dagger}(\hat{A} \otimes|0\rangle\langle 0|) \hat{S}(\hat{B} \otimes \hat{\mathbb{I}})\right] \\
  & =\operatorname{Tr}_1\left[\hat{A} \operatorname{Tr}_2\left[(\hat{\mathbb{I}} \otimes|0\rangle\langle 0|) \hat{S}(\hat{B} \otimes \hat{\mathbb{I}}) \hat{S}^{\dagger}\right]\right],
  \end{aligned}
  $$
  上式中的$\hat{A}$是任意的，因此有对偶信道的系统环境耦合表示
  $$
  \Phi^*(\hat{B})=\operatorname{Tr}_2\left[(\hat{\mathbb{I}} \otimes|0\rangle\langle 0|) \hat{S}(\hat{B} \otimes \hat{\mathbb{I}}) \hat{S}^{\dagger}\right] .
  $$

**示例：量子信道和量子操作**

- **幺正演化**: $\mathcal{E}(\rho)=U \rho U^{\text{}}$、**测量**: $\mathcal{E}_{m}(\rho)=M_{m} \rho M_{m}^{\text{}}$
- **Unruh信道**: (banerjee2017CharacterizationUnruhChannel)。
- **比特翻转、相位反转、比特相位翻转、恒等信道和退极化(depolarizing)、相位阻尼(退相位dephasing)、振幅阻尼(AD)** [^4]、自发辐射(Kraus算符将激发态打到基态)。恒等信道的蔡氏矩阵是最大纠缠态本身、完全退极化信道的蔡氏矩阵正比于单位阵。
- **迹和偏迹**。
- $\mathcal{E}$ 是**unital 信道** $\Leftrightarrow~\mathcal{E}(\mathbb{I})=\mathbb{I}$$\Leftrightarrow \mathcal{E}^\dagger$是量子信道(保迹)。$\mathcal{L}(X)=0,~\forall X\iff \mathcal{L}^\dagger(\mathbb{I})=0$。
- **反例**：部分转置
  $$
  2|I\rangle\langle I|=2\left(E_{i j}\right)=\left(\begin{array}{ll}\left(\begin{array}{ll}1 & 0 \\ 0 & 0\end{array}\right) & \left(\begin{array}{ll}0 & 1 \\ 0 & 0\end{array}\right) \\ \left(\begin{array}{ll}0 & 0 \\ 1 & 0\end{array}\right) & \left(\begin{array}{ll}0 & 0 \\ 0 & 1\end{array}\right)\end{array}\right) \xrightarrow{I \otimes (\cdot )^{\top}}\left(\begin{array}{l}\left(\begin{array}{ll}1 & 0 \\ 0 & 0\end{array}\right)\left(\begin{array}{ll}0 & 0 \\ 1 & 0\end{array}\right) \\ \left(\begin{array}{ll}0 & 1 \\ 0 & 0\end{array}\right)\left(\begin{array}{ll}0 & 0 \\ 0 & 1\end{array}\right)\end{array}\right)
  $$
  其他著名的反例，参见[SE帖](https://quantumcomputing.stackexchange.com/questions/38054/is-the-trace-of-a-positive-map-always-positive)。利用转置的例子，可以说明，即便$\mathcal{E}\otimes \mathcal{F}$是正的，也不能说明$\mathcal{E}$或$\mathcal{F}$中的任何一个是全正的。
- [煎饼信道](https://quantumcomputing.stackexchange.com/questions/38194/for-how-many-different-times-do-i-have-to-know-that-etl-is-a-quantum-channe)。
- [unital信道不必是随机幺正的](https://quantumcomputing.stackexchange.com/questions/34342/can-a-unital-channel-not-be-mixed-unitary)。
- 一些[常见例子](https://physics.stackexchange.com/questions/291810/canonical-examples-of-quantum-channels/291811#291811)。
- **“弃旧换新”信道**。可以构造一个量子信道，将所有的态都映射到某一指定的纯态，
  $$
  \mathcal{E}(\rho)=\sum_{n}|\phi\rangle\left\langle\psi_{n}|\rho| \psi_{n}\right\rangle\langle\phi|=\operatorname{tr}(\rho)| \phi\rangle\langle\phi|
  $$
  因此该量子信道不是单射，不具有可逆性。再比如求迹也是一个不可逆的量子信道。另外，即便对于可逆的量子信道，量子信道的逆也未必是量子信道，实际上，利用Wigner定理[^5]可以证明，量子信道的逆是量子信道当且仅当它是幺正的 (rivas2012book, Th.3.4.1, Prop.12.13)。

[Image Placeholder: 待整理：单比特的量子信道是Bloch球上的仿射变换 - image//algebra1.pdf]

### 利用过程层析计算量子信道的Kraus算符

态、过程层析：可以通过获得一组信息完备的POVM的概率分布来确定量子态或者量子信道 (milz2021, (86))（待补充）。

利用对量子信道的的过程层析可以确定任意给定的初态对应的末态，下面的方法给出了层析后计算Kraus算符的方法。
设$\mathcal{E}(\rho)=\sum_{k=1}^{M} E_{k} \rho E_{k}^{\text{}}$是量子信道，在Kraus算符生活的空间中取一组固定的参考ONB记为$\{\widetilde{E}_i\}$，又设$\{r_i\}$是量子态$\rho$生活的空间$D(\mathsf{H})$的一组ONB，Hilbert空间的维度$\mathrm{dim}(\mathsf{H})=d$。将Kraus算符做展开$E_{i}=\sum_{j} \alpha_{i j} \widetilde{E}_{j}$可得
$$
\begin{aligned} \mathcal{E}\left(r_{l}\right) & =\sum_{i j k} \alpha_{i j} \overline{\alpha_{i k}} \tilde{E}_{j} \gamma_{l} \tilde{E}_{k}^{\text{}} \\ & \equiv \sum_{i j k p} \alpha_{i j} \overline{\alpha_{i k}}\beta_{j l k p} r_{p}\end{aligned}
$$
其中，$\beta_{j l k p}=\operatorname{tr}\left(r_p^\dagger \tilde{E}_{j} r_{l} \tilde{E}_{k}^{\text{}}\right)$。另一方面，$\mathcal{E}$可以用量子过程层析的方法得到，视为已知量，可以直接做展开
$$
\mathcal{E}\left(r_{l}\right)=\lambda_{l p} r_{p},\quad \lambda_{l p}=\operatorname{tr}\left(r_p^\dagger \mathcal{E}\left(r_{l}\right)\right)
$$
比较两个展开式可知，
$$
\lambda_{l p}=\sum_{j k} \beta_{j l k p} \chi_{j k}
$$
我们的目标是求解$\chi$，压平矩阵和张量后可以得到我们更加熟悉的形式。
4阶的$n\times n\times n\times n$数组$A$经过压平操作$\mathrm{Ft}$成为$n^2\times n^2$矩阵$\mathrm{Ft}(A)$的规则是
$$
\mathrm{Ft}(A)_{(i-1)n+k,(j-1)n+l}=A_{ijkl}
$$
由此可得与之前等价的压平后的方程
$$
\lambda_{m}^{\Finv }=\sum_{n} \beta_{m n}^{\Finv} \chi_{n}^{\Finv }
$$
其中，$m={(l-1)d^2+p},n=(j-1)d^2+k,$~$\lambda_{(l-1)d^2+p}^{\Finv }=\lambda_{lp},~\beta_{(l-1)d^2+p,(j-1)d^2+k }^{\Finv}=\beta_{jlkp}$。向量$\lambda_{m}^{\Finv }$和$\chi_{n}^{\Finv }$是矩阵压平的结果，而$\beta_{m n}^{\Finv}$是张量张量转置[^6]$\beta_{jlkp}\rightarrow \tilde{\beta}_{jlkp}=(2,1,4,3)\circ \beta_{jlkp}=\beta_{ljpk}$和数组压平的结果，即
$$
\beta_{(l-1)d^2+p,(j-1)d^2+k }^{\Finv }=\mathrm{Ft}(\tilde{\beta})_{(l-1)d^2+p,(j-1)d^2+k }=\tilde{\beta}_{ljpk} =\beta_{jlkp}
$$
上式已经过检验。最后，求解线性方程组，并对$\chi$做对角化，就可以求得$\mathcal{E}$的Kraus算符。上式的验证，利用上述过程的算例参见文档[^7]。实际上，利用蔡氏矩阵与Kraus算符的关系式可以更简单地从蔡氏矩阵求解Kraus算符，幅值衰减的例子参见相同的文档。

### 量子信道的谱性质

谱分解类似，由于保厄米性，本征谱关于实数轴对称性，另外可以证明正且(保迹或unital)蕴含本征值都生活在单位圆盘上，即$|\lambda|\leq 1$，除了这两点以外就没有其他约束了 (wolf2012QuantumChannelsOperations, chap.6)。

**命题 6.2** (wolfQuantumChannelsOperations)
[[1 Stories of Bizzo's Life/5 量子科学和量子技术/量子信道\|量子信道]]的模为1的本征值(边缘谱)都有平凡的Jordan块(代数重数等于几何重数)。

### 量子信道的不动点

每个保迹正映射，尤其是信道$\Phi$都有一个密度算符$\pi$作为不动点，即满足$\Phi(\pi)=\pi$ (证明详见 watrous2018TheoryQuantumInformationa, Sec.4.2.2)，如果$\Phi$还是不可约的，那么任何不动点都正比于$\pi$ (lardizabal2022MeanHittingTime)。没法直接利用赋范空间和度量空间的不动点定理 (Moretti2017, Th.2.111) 来证明(不动点的唯一存在性)是因为保迹正映射关于trace norm不是严格收缩的，而赋范空间中的不动点定理中要求严格收缩。

在Markov动力学下的不动点的唯一存在性的证明，参见 (yoshida2024UniquenessSteadyStates)

### 量子信道范式的局限性

$$
\mathcal{E}(\rho)=\left\{\begin{array}{ll}\operatorname{tr}_{2}(\rho \otimes|0\rangle\langle 0 |)=\rho & \text { 若 ~} n_{z}=\operatorname{tr}(\rho Z)<0 \\ \operatorname{tr}_{2}(X \rho X \otimes |1\rangle\langle 1 |)=X \rho X & \text { 若 ~} n_{z}>0\end{array}\right.
$$

### 量子信道的其他性质

**定义：$\pi_{1,2}$协变[[1 Stories of Bizzo's Life/5 量子科学和量子技术/量子信道\|量子信道]]**

- 考虑群 $G$ 和它的两个(投影)幺正表示 $\pi_{1}, \pi_{2}$，表示空间记为$\mathsf{H}_{1}$ and $\mathsf{H}_{2}$ ，量子信道 $\mathcal{E}: {B}\left( \mathsf{H}_{1}\right) \rightarrow {B}\left( \mathsf{H}_{2}\right)$ 称为**关于$\pi_{1,2}$协变的信道**(covariant with respect to $\pi_{1,2}$)或者**协变信道**，如果$\mathcal{E}$是等变映射(又称interwiner)，即
  $$
  \mathcal{E}\left[\pi_{1}(U) A \pi_{1}(U)^{*}\right]=\pi_{2}(U) \mathcal{E}[A] \pi_{2}(U)^{*} \quad
  \forall A \in {B}\left( \mathsf{H}_{1}\right), \forall U \in G
  $$
- 如果两个表示都是不可约的，则称信道为**不可约协变信道** (mozrzymas2017StructureIrreduciblyCovariant)。

**笔记**

- 根据协变量子信道的定义，可以构造关于编码信道协变的[[1 Stories of Bizzo's Life/5 量子科学和量子技术/29 量子纠错\|量子纠错]]码，称为协变量子纠错码。
- 用范畴的语言，设$\mathsf{C}=\mathsf{B}G$，$D=\mathsf{Vect}$，则函子范畴[^8]$[\mathsf{C},\mathsf{D}]$是以$G$的伴随表示为对象，以协变量子信道为态射的范畴。$\tilde{\pi}_{1,2}:\star \mapsto V_{1,2},~g\mapsto \pi_{1,2}(g) (\cdot )\pi_{1,2}(g)^*$是两个函子($[\mathsf{C},\mathsf{D}]$中的对象)，协变信道$\mathcal{E}$是$\pi_{1,2}$之间的自然变换，即满足$\mathcal{E}\circ \tilde{\pi}_1= \tilde{\pi}_2\circ\mathcal{E}$。

*例子*：

- $G=U(d)$，$\pi_{1}(U)=\pi_{2}(U)=U\in U(d)$，退极化信道
  $$
  \mathcal{E}(\rho)=(1- p) \rho+p \operatorname{tr}(\rho) \mathbb{I}/d
  $$
  是协变的，其中$0\leqslant p\leqslant \frac{d^2}{d^2-1}$保证了退极化信道是全正的。

**定义：互补信道 (complementary)** (holevo2012QuantumChannelsTheir)

- 等距算符（视为编码）$V:\mathsf{H}_A\rightarrow \mathsf{H}_B\otimes \mathsf{H}_E$,$V_k:\mathsf{H}_A\rightarrow \mathsf{H}_B$
  $$
  \Phi(\rho)=\operatorname{Tr}_{E} V \rho V^{\dagger}, \quad {\Phi}^{\complement}(\rho)=\operatorname{Tr}_{B} V \rho V^{\dagger}
  $$
  $$
  \Phi[\rho]=\sum_{k=1}^{d_{E}} V_{k} \rho V_{k}^{\dagger}, \quad {\Phi}^{\complement}[\rho]=\sum_{k, \ell=1}^{d_{E}}\left|e_{E}^{k}\right\rangle\left\langle e_{E}^{\ell}\right| \operatorname{Tr}\left[V_{k} \rho V_{\ell}^{\dagger} \right]
  $$
- ${\mathrm{id}}^{\complement}=\rho_0 \mathrm{tr}$，即恒等信道的互补信道是求迹。反之不然，设$\Phi(\rho)$是幺正信道$\Phi(\rho)=U\rho U^\dagger$，设环境是1维的，则$\Phi^\complement(\rho)=\mathrm{tr}(\rho)$。 互补信道借用了集合论中的补集符号。
- 互补信道的定义和描述量子信道时使用的扩张的空间有关，并不完全由信道确定。
- 例子参考[SE帖](https://quantumcomputing.stackexchange.com/questions/5794/what-is-the-complementary-map-of-a-channel-with-given-kraus-decomposition)。

**定理：利用互补信道刻画纠缠保真度** (beny2010GeneralConditionsApproximate, Th.1)

- 设$\mathcal{M}:D(\mathsf{H}_1)\rightarrow D(\mathsf{H}_1)$，$\mathcal{N}:D(\mathsf{H}_1)\rightarrow D(\mathsf{H}_2)$，$\mathcal{R}:D(\mathsf{H}_2)\rightarrow D(\mathsf{H}_1)$是量子信道，则
  $$
  \max _{\mathcal{R}} F_\mathrm{min}(\mathcal{R N}, \mathcal{M})=\max _{\mathcal{R}^{\prime}} F_\mathrm{min}\left(\widehat{\mathcal{N}}, \mathcal{R}^{\prime} \widehat{\mathcal{M}}\right),
  $$
  其中$F_\mathrm{min}$是信道的纠缠保真度。

**证明**

- [Image Placeholder: image//2024-06-28-15-36-22.png]

**命题：投影Kraus算符蕴含投影信道**

- 设信道$\mathcal{E}:B(\mathsf{H})\rightarrow B(\mathsf{H})$的Kraus算符满足$\{P_i\}$满足$P_iP_j=\delta_{ij}P_i$，
  则
  $$
  \mathcal{E}^2=\mathcal{E}.
  $$

**证明**

- 设$\mathcal{E}(\cdot)=\sum_i P_i\cdot P_i^\dagger$，则
  $$
  \mathcal{E}^2(\rho)=\sum P_jP_i\rho P_i^\dagger P_j^\dagger=\sum P_i \rho P_i^\dagger =\mathcal{E}(\rho)
  $$

**笔记**

- 逆命题是不成立的，如果错误充满了整个空间，恢复信道作用一次回到码空间，第二次作用没有任何效果所以它是投影的，且恢复信道的Kraus算符（应该）不可能只是投影算符。

**定理：Holevo界**

- Alice依据经典概率分布$p_x$和系综$\rho_x$制备了量子态$\rho=\sum p_x \rho_x$，Bob对Alice制备的态进行POVM测量，得到概率分布$p_y=\mathrm{tr}(E_y\rho)$，则对于任意测量，条件熵，即$Y$可获取的信息，小于等于Holevo界
  $$
  H(X|Y)\leqslant \chi
  $$
  其中$\chi =S\left(\sum p_x \rho_x^B\right)-\sum_x p_x S\left(\rho_x^B\right)$。

**证明**

- 参见[维基百科](https://en.wikipedia.org/wiki/Holevo's_theorem)

**定义：单次$\epsilon$-误码率的纠缠辅助的经典容量**

- $$
  C_{\mathrm{EA}}^{\varepsilon}(\mathcal{N}):=\sup _{(\mathcal{M}, \Psi, \varepsilon, \mathcal{D})}\left\{\log _2|\mathcal{M}|: p_{\mathrm{err}}^*((\Psi, \mathcal{E}, \mathcal{D}) ; \mathcal{N}) \leq \varepsilon\right\}=\sup _{\substack{\mathcal{M} \subset \mathbb{N}\text{有限} \\ \Psi, \mathcal{E}, \mathcal{D}, p_{\mathrm{err}}^* \leq \varepsilon}} \log _2|\mathcal{M}|
  $$
  其中$p^*_{\mathrm{err}}$是所有经典消息的最大错误率。

**定义：可达码率和信道容量**

- 一个码率是**可达的**(achievable)，如果任取$0<\varepsilon\leq 1$，$\delta>0$，存在$n$和一个$\left(n, 2^{n(R-\delta)}, \varepsilon\right)$协议。
- 信道的可达码率的上确界被称为**纠缠辅助经典通信的信道容量** (khatri2020PrinciplesQuantumCommunication, Def.11.12)
  $$
  C_{\mathrm{EA}}(\mathcal{N}):=\sup \{R: R \text { is an achievable rate for } \mathcal{N}\} .
  $$

**定理：纠缠辅助的信道容量就是信道的互信息** (khatri2020PrinciplesQuantumCommunication, Th.11.16)

- $$
  C_{\mathrm{EA}}(\mathcal{N})=I(\mathcal{N})
  $$

# 松散的内容
- 保持纯度的量子信道 [quantum operation - What channels preserve the purity of all pure inputs? - Quantum Computing Stack Exchange](https://quantumcomputing.stackexchange.com/questions/26361/what-channels-preserve-the-purity-of-all-pure-inputs)
- 幺正信道简介 [unitary quantum channel in nLab (ncatlab.org)](https://ncatlab.org/nlab/show/unitary+quantum+channel)
- 高阶幺正信道是否允许信道层面的Kraus信道和表示？#问题


## unital 和 次unital 信道的性质
### 1. 证明：幺正通道的输入和输出维度相同 ($d_A = d_B$)

**定义**：一个量子通道 $\mathcal{N}$ 是 **幺正的 (unital)**，如果它保持单位算子不变，即：
$$
\mathcal{N}(\mathbb{I}_A) = \mathbb{I}_B
$$

**证明**：
1.  我们从幺正通道的定义开始： $\mathcal{N}(\mathbb{I}_A) = \mathbb{I}_B$。
2.  对这个等式的两边取迹（trace）：
    $$
    \text{tr}(\mathcal{N}(\mathbb{I}_A)) = \text{tr}(\mathbb{I}_B)
    $$
3.  根据量子通道的定义，它必须是 **保迹的 (trace-preserving)**。这意味着对于任何输入算子 $X$，都有 $\text{tr}(\mathcal{N}(X)) = \text{tr}(X)$。我们将这个性质应用到等式的左边：
    $$
    \text{tr}(\mathcal{N}(\mathbb{I}_A)) = \text{tr}(\mathbb{I}_A)
    $$
4.  将第2步和第3步的结果结合起来，我们得到：
    $$
    \text{tr}(\mathbb{I}_A) = \text{tr}(\mathbb{I}_B)
    $$
5.  将迹用维度替换，我们最终得到：
    $$
    d_A = d_B
    $$
**结论**：因此，任何幺正量子通道的输入维度必须等于其输出维度。

### 2. 证明：亚幺正通道的输出维度大于或等于输入维度 ($d_B \ge d_A$)

**定义**：一个量子通道 $\mathcal{N}$ 是 **亚幺正的 (subunital)**，如果：
$$
\mathcal{N}(\mathbb{I}_A) \le \mathbb{I}_B
$$
在算子理论中，不等式 $X \le Y$ 意味着算子 $Y - X$ 是一个正半定算子 (positive semidefinite operator)。所以，这里的定义等价于：
$$
\mathbb{I}_B - \mathcal{N}(\mathbb{I}_A) \ge 0
$$
其中 $\ge 0$ 表示是正半定的。

**证明**：
1.  我们从亚幺正通道的定义开始： $\mathbb{I}_B - \mathcal{N}(\mathbb{I}_A)$ 是一个正半定算子。
2.  正半定算子的一个基本性质是它的迹是非负的。因此，我们对这个算子取迹：
    $$
    \text{tr}(\mathbb{I}_B - \mathcal{N}(\mathbb{I}_A)) \ge 0
    $$
3.  利用迹的线性性质，我们可以将其分解为：
    $$
    \text{tr}(\mathbb{I}_B) - \text{tr}(\mathcal{N}(\mathbb{I}_A)) \ge 0
    $$
4.  同样，由于 $\mathcal{N}$ 是一个保迹的量子通道，我们有 $\text{tr}(\mathcal{N}(\mathbb{I}_A)) = \text{tr}(\mathbb{I}_A)$。将其代入不等式：
    $$
    \text{tr}(\mathbb{I}_B) - \text{tr}(\mathbb{I}_A) \ge 0
    $$
5.  最后，将迹用维度替换，我们得到：
    $$
    d_B - d_A \ge 0
    $$
    这等价于：
    $$
    d_B \ge d_A
    $$
**结论**：因此，任何亚幺正量子通道的输出维度必须大于或等于其输入维度。

