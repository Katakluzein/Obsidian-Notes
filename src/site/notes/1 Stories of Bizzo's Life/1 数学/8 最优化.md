---
{"dg-publish":true,"permalink":"/1 Stories of Bizzo's Life/1 数学/8 最优化/","tags":["最优化"]}
---



> [!quote]  
> In fact any experiment that measures a quantum effect is one in which the quantum effect is aligned with the behavior of some heavy, macroscopicobject; that's how we measure it. 
> ——Murray Gell-Mann 
{ #onwyfr}


> [!quote] 

> [!abstract] Contents
> - 凸优化

## 对偶锥和广义不等式
> [!definition] 对偶锥
> - 设$K$是欧式空间的子集，其**对偶锥**定义为
>
$$
K^*=\left\{\mathbf{x} \mid \mathbf{x}^T \mathbf{y} \geq 0, \forall \mathbf{y} \in K\right\}
$$
对偶锥是凸锥，凸锥上定义了广义不等式。
> [!definition] 广义不等式
> -
$$
\mathbf{x}_1 \succeq_{K^*} \mathbf{x}_2 \Leftrightarrow \mathbf{y}^{\top} \mathbf{x}_1 \geq \mathbf{y}^{\top} \mathbf{x}_2, \quad \forall \mathbf{y} \succeq_{K} 0
$$
## 凸优化
 参考{（[[boyd2004ConvexOptimization\|boyd2004ConvexOptimization]] Cha.4）}
$$
\begin{array}{ll}
		\operatorname{minimize} & f_0(x) \\
		\text { subject to } & f_i(x) \leqslant 0, \quad i=1, \cdots, m \\
		& a_i^\top x=b_i, \quad i=1, \cdots, p
		\end{array}
$$
eq-eq-convex-optimization

 比起一般的优化问题，凸优化问题的特征是
 > [!abstract] Contents
> - 目标函数和不等式约束中的函数，即函数$f_0$和$f_i$都是凸函数。
> - 等式约束是仿射的。

对约束做推广，可得
$$
\begin{array}{ll}
\operatorname{minimize} & f_0(x) \\
\text { subject to } & f_i(x) \preceq_{ K_i} 0, \quad i=1, \cdots, m \\
& A x=b
\end{array}
$$
其中 $f_0: \mathbb{R}^n \rightarrow \mathbb{R}, K_i \subseteq \mathbb{R}^{k_i}$ 为正常锥\footnote{定义为{（[[boyd2004ConvexOptimization\|boyd2004ConvexOptimization]] Sec.2.4.1）}：凸锥、闭集、内部非空、尖($x,-x\in K\implies x=0$)}，$f_i: \mathbb{R}^n \rightarrow \mathbb{R}^{k_i}$ 为 $K_i$-凸的。

 根据定义，可知凸优化问题的可行域是凸的、凸优化问题的局域最优解也是全局最优解。
 > [!theorem] 可微目标函数的最优化充要条件{} （[[boyd2004ConvexOptimization\|boyd2004ConvexOptimization]] (4.21)）
> - 设凸优化问题\eqref{eq:convex_optimization}的目标函数是可微的，记可行域为$X$，则$x\in X$是最优值当且仅当
>
$$
\nabla f_0(x)^T(y-x) \geqslant 0, \forall y \in X
$$
半正定规划是一种特殊的凸规划，它有多种不同的形式
 > [!abstract] Contents
> -
$$
\begin{array}{ll}
\operatorname{minimize} & c^T x \\
\text { subject to } & x_1 F_1+\cdots+x_n F_n+G \preceq 0 \\
& A x=b
\end{array}
$$
>   其中$G, F_1, \cdots, F_n \in \mathbf{S}^k, A \in \mathbb{R}^{p \times n}$，广义不等式定义在半正定锥$\mathbf{S}_+^k$上。
> - 在wiki上有另一种定义，
>
$$
\begin{aligned}
\min _{x^1, \ldots, x^n \in \mathbb{R}^n} &\quad \sum_{i, j } c_{i, j}\left(x^i \cdot x^j\right) \\
\text { subject to } &\quad \sum_{i, j } a_{i, j, k}\left(x^i \cdot x^j\right) \leq b_k \text { for all } k
\end{aligned}
$$
>   由于正定算符集与$\{(x^i,x^j)\}$的对应关系，这种定义可以等价地写成
> -
$$
\begin{aligned}
\min _{X \in \mathbf{S}^n_+} &\quad \mathrm{tr}(CX)\\
\text { subject to } & \quad\mathrm{tr}(A_kX) \leq b_k, \quad k=1, \ldots, m \\
& \quad X \succeq 0 .
\end{aligned}
$$
>   其中的$C$和$A_k$都经过了对称化处理，保证了内积的非负性。

 ### 对偶性
设$K_i$是正常锥，考虑优化问题(未必凸)
$$
\begin{array}{ll}
		\operatorname{minimize} & f_0(x) \\
		\text { subject to } & f_i(x) \preceq_{ K_i} 0, \quad i=1, \cdots, m \\
		& h_i(x)=0 , \quad i=1, \cdots, p
		\end{array}
$$
eq-eq-optimization

引入拉格朗日乘子$\lambda$，得到拉格朗日函数
$$
L(x, \lambda, \nu)=f_0(x)+\lambda_1^T f_1(x)+\cdots+\lambda_m^T f_m(x)+\nu_1 h_1(x)+\cdots+\nu_p h_p(x)
$$
拉格朗日对偶函数
$$
g(\lambda, \nu)=\inf _{x \in \mathcal{D}} L(x, \lambda, \nu)=\inf _{x \in \mathcal{D}}\left(f_0(x)+\sum_{i=1}^m \lambda_i^T f_i(x)+\sum_{i=1}^p \nu_i h_i(x)\right)
$$
对偶优化问题为
$$
\begin{array}{ll}
\operatorname{maximize} & g(\lambda, \nu) \\
\text { subject to } & \lambda_i \succeq_{K_i^*} 0, \quad i=1, \cdots, m
\end{array}
$$
Lagrange对偶函数的每个点都是原问题的一个下界

 Lagrange对偶函数与凸共轭(又称勒让德变换，参见\ref{def:Legendre-Fenchel})关系密切。
## 半正定规划
主条目：[[半正定规划\|半正定规划]]
### 问题的表述
锥优化的原问题和对偶问题，选取特定的$K$可以变为半正定规划问题
$$
\begin{aligned}
\text { Min } & \langle c, x\rangle & \operatorname{Max} & \langle b, y\rangle \\
\text { (P) } & x \in K & \text { s.t. } & z \in K^* \\
& A x=b & & A^* y+z=c
\end{aligned}
$$
矩阵形式的原问题和对偶问题
$$
\begin{aligned}
\max _{\mathcal{S}} & \operatorname{tr}[\mathcal{A}\mathcal{S}] \\
\text { s.t. } & \Phi(\mathcal{S})=\mathcal{B},~\mathcal{S} \geq 0 \\
\min _{\mathcal{E}} & \operatorname{tr}[\mathcal{EB}] \\
\text { s.t. } & \Phi^{\dagger}(\mathcal{E}) \geq  \mathcal{A}
\end{aligned}
$$
### Schur补
分块矩阵
$$
M=\left(\begin{array}{cc}A&B\\ C& D    
\end{array}\right)
$$
的Schur补是
$$
M / D : = A - B D ^ { - 1 } C .
$$
$$
M / A : = D - C A ^ { - 1 } B .
$$
当$M$是厄米矩阵时，记$C=B^\dagger$，Schur补可以用于刻画$M$的正定性
$$
M > 0 \Leftrightarrow A > 0 \text { 且 } \left( D - B ^ { \dagger } A ^ { - 1 } B \right) > 0 .\Leftrightarrow D > 0 \text { 且 } \left( A - B ^ { \dagger } B ^ { - 1 } B \right) > 0 .
$$
eq-eq-schrcomp

严格正定可以改为正定。

 > [!proof]
> - $(\Rightarrow)$根据正定性的定义，对于任意复值向量$\mathbf { v },~\mathbf { w }$，有
>
$$
\mathbf { v } ^ { \dagger } A \mathbf { v } + 2 \mathbf { v } ^ { \dagger } B \mathbf { w } + \mathbf { w } ^ { \dagger } D \mathbf { w } >0.
$$
>   令$\mathbf { w }=0$可知$A$是正定的。给定$\mathbf { w }$的情况下，关于$\mathbf { v }$的二次多项式是凸的，所以直接零梯度为零可以得到最值点$\mathbf { v }=-A^{-1}B\mathbf { w }$，最小值为
$$
\mathbf { w }^\dagger\left(D-B^\dagger A^{-1}B\right)\mathbf { w },
$$
>   因此Schur补$M/A$是正定的。根据正定矩阵的顺序主子式的判据。
>
>   充分性类似。第二个等价类似。

常用推论
$$
\left(\begin{array}{cc}
\mathbb{I} &C^{\dagger} \\
C & S
\end{array}\right) \geqslant 0 \iff S\geqslant CC^\dagger
$$
# 松散的内容
- [[黎曼最优化\|黎曼最优化]]
- 