---
{"dg-publish":true,"permalink":"/量子梳/","tags":["不定因果与因果结构"]}
---

### 量子梳作为FO的过程矩阵的定义

![2025-02-15-12-08-48.png|800](/img/user/2025-02-15-12-08-48.png)
- [[整理前的量子梳定义\|整理前的量子梳定义]] 
参考  [[lorenz2020QuantumCausalStructure\|lorenz2020QuantumCausalStructure]]

一个 **$n$-量子梳** ($n$-quantum comb) 是一个作用于 $n+1$ 个节点 $S=(A_0, A_1, \ldots, A_n)$ 上的正定矩阵 $\sigma$。这些节点通常被赋予物理意义：$A_0 = P$ 代表“过去”(Past)，$A_n = F$ 代表“未来”(Future)，而 $A_1, \ldots, A_{n-1}$ 代表中间的交互节点。该过程矩阵 $\sigma$ 作用在希尔伯特空间 $B\left(\bigotimes_{i=0}^n \mathcal{H}_{A_i^{\text{in}}} \otimes \mathcal{H}_{A_i^{\text{out}}}\right)$ 上。

由于一个 $n$-梳通常被看作是一个接收 $n-1$ 个量子信道作为输入，将一个量子信道作为输出的超映射（或超信道），它需要有 $n-1$ 个“插槽”来插入这些信道。因此，我们通常假设系统的最开始没有输入（即 $A_0^{\text{in}} = P^{\text{in}}$ 对应的空间是平凡的，维度为1），以及最末尾没有输出（即 $A_n^{\text{out}} = F^{\text{out}}$ 对应的空间是平凡的）。

除了是正定矩阵外，$\sigma$ 还必须满足一组递归的归一化条件，以确保其物理上的自洽性。这些条件有几种等价的数学表述：

### 等价的数学表述

**表述一：基于替换算符 $\mathcal{D}$ 的节点视角**

这是最直接的定义，它描述了从最高阶节点开始，逐步“截断”网络所必须满足的条件。一个算符 $\sigma$ 是一个 $n$-量子梳，当且仅当它满足：

1.  **总迹条件：**
    $$
    \operatorname{tr}(\sigma)=\prod_{i=0}^n d_{A_i^{\mathrm{out}}}
    $$

2.  **递归因果条件：**
    $$
    \begin{gathered}
    \mathcal{D}_{A_n^{\text{in}} A_{n-1}^{\text{out}}} \sigma =\mathcal{D}_{A_n^{\text{in}}} \sigma \\
    \mathcal{D}_{A_n^{\text{in}} A_{n-1} \cdots A_l A_{l-1}^{\text{out}}} \sigma = \mathcal{D}_{A_n^{\text{in}} A_{n-1} \cdots A_l} \sigma, \quad l=1, \ldots, n-1
    \end{gathered}
    $$

将节点替换为 $P$ 和 $F$ 的物理标签后，上述条件变为：
$$
\begin{gathered}
\operatorname{tr}\left(\sigma\right)=d_{P^{\text {out}}} d_{A_1^{\text {out}}} \cdots d_{A_{n-1}^{\text {out}}} \\
\mathcal{D}_{F^{\text{in}} A_{n-1}^{\text{out}}} \sigma = \mathcal{D}_{F^{\text{in}}} \sigma \\
\mathcal{D}_{F^{\text{in}} A_{n-1} \cdots A_l A_{l-1}^{\text{out}}} \sigma = \mathcal{D}_{F^{\text{in}} A_{n-1} \cdots A_l} \sigma, \quad l=2, \ldots, n-1 \\
\mathcal{D}_{F^{\text{in}} A_{n-1} \cdots A_1 P^{\text{out}}} \sigma = \mathcal{D}_{F^{\text{in}} A_{n-1} \cdots A_1} \sigma, \quad (\text{对应于 } l=1)
\end{gathered}
$$
- 与精密测量的文章{（[[liuFullyOptimizedQuantumMetrology\|liuFullyOptimizedQuantumMetrology]] (7)）}中的定义相同。
- 修改空间的记号之后与定理\ref{th:projeccarofcomb}相同。

---

**表述二：基于部分迹的递归定义**

该定义通过递归地对最高阶的节点进行部分迹来实现，物理意义更加清晰。其中 $\sigma_{(l)}$ 表示对 $\sigma$ 从 $A_n$ 到 $A_l$ 的所有子系统（输入和输出）都执行部分迹后得到的算符，即 $\sigma_{(l)}=\mathrm{tr}_{A_nA_{n-1}\cdots A_{l}}\sigma\in B(\mathcal{H}_{P^{\text{out}}} \otimes \mathcal{H}_{A_1} \otimes \cdots \otimes \mathcal{H}_{A_{l-1}} \otimes \mathcal{H}_{A_l^{\text{in}}})$ 。

$$
\begin{gathered}
\operatorname{tr}\left(\sigma\right)=d_{P^{\text {out}}} d_{A_1^{\text {out}}} \cdots d_{A_{n-1}^{\text {out}}} \\
\operatorname{tr}_{F} \sigma = \sigma_{(n-1)} \otimes \mathbb{I}_{A_{n-1}^{\text{out}}} \\
\operatorname{tr}_{A_l^\mathrm{in}} \sigma_{(l)} = \sigma_{(l-1)} \otimes \mathbb{I}_{A_{l-1}^{\text{out}}}, \quad l=2, \ldots, n-1 \\
\operatorname{tr}_{A_1^\mathrm{in}} \sigma_{(1)} = \mathbb{I}_{P^{\text{out}}}
\end{gathered}
$$

- 如果退化到 $n=2$，则和不能发送信息的定义\ref{def:nosignalling}相同。
- 与{（[[lorenz2020QuantumCausalStructure\|lorenz2020QuantumCausalStructure]] (3.10)）}中的定义相同。量子梳都具有确定的因果关系，并由节点的顺序确定，$A_i$不能向$A_j$通信如果，$i>j$。
- 替换记号以后与文献[[Optimal quantum learning of a unitary transformation\|Optimal quantum learning of a unitary transformation]]一致。
---


**表述三：以“梳齿”为中心的对称记号**

这种表述通过重新标记希尔伯特空间，使得定义在形式上最为简洁。我们将第 $l$ 个交互节点的输入和输出空间分别记为 $T_l^{\text{in}}$ 和 $T_l^{\text{out}}$。原来的 $P^{\text{out}}$ 对应 $T_1^{\text{in}}$，$A_l^{\text{in}}$ 对应 $T_l^{\text{out}}$，$A_l^{\text{out}}$ 对应 $T_{l+1}^{\text{in}}$，$F^{\text{in}}$ 对应 $T_n^{\text{out}}$。此时，$\sigma \in B\left(\bigotimes_{i=1}^n \mathcal{H}_{T_i^{\text{in}}} \otimes \mathcal{H}_{T_i^{\text{out}}}\right)$。

$$
\begin{gathered}
\operatorname{tr}(\sigma)=\prod_{i=1}^n d_{T_i^{\mathrm{in}}} \\
\mathcal{D}_{T_n \cdots T_l} \sigma = \mathcal{D}_{T_n \cdots T_{l+1} T_l^{\text{out}}} \sigma, \quad l=1, \ldots, n
\end{gathered}
$$
这个记号的优点在于，原本复杂的多个等式被统一成了一个递归等式。

---

### **特殊情况：输入和输出平凡的量子梳**

在许多文献中，量子梳被定义为一个将量子信道映射到量子信道的超映射。在这种情况下，整个梳的最开始（输入）和最末尾（输出）都是平凡的。这对应于设置 $P^{\text{out}}$ 和 $F^{\text{in}}$ 空间维度为1。此时，该过程定义了一个作用于 $n-1$ 个节点的 **$n$-量子梳**。其算符 $\sigma \equiv \sigma_{A_1 \ldots A_{n-1}} \in B\left(\bigotimes_{i=1}^{n-1} \mathcal{H}_{A_i^{\text{in}}} \otimes \mathcal{H}_{A_i^{\text{out}}}\right)$ 满足：

$$
\operatorname{tr}(\sigma_{A_1 \ldots A_{n-1}})=d_{A_1^\mathrm{out}}\cdots d_{A_{n-1}^\mathrm{out}}
$$
$$
\mathcal{D}_{A_{n-1}^{\text{out}}} \sigma = \sigma
$$
$$
\mathcal{D}_{A_{n-1} \cdots A_l A_{l-1}^{\text{out}}} \sigma = \mathcal{D}_{A_{n-1} \cdots A_l} \sigma, \quad l=1, \ldots, n-2
$$
其中，对应于 $l=n-1$ 的约束是平凡的，因此被略去。

> [!note]
> - 由于量子梳总是可以用一般的量子线路来实现（2-comb已证明，且给出了一种基于Uhlmann定理的构造方法 [[论文阅读笔记/Comparison of Quantum Channels by Superchannels\|Comparison of Quantum Channels by Superchannels]]]]，更多齿的待证），在这个意义上量子梳并非量子理论真正的高阶推广。
>
>
>   \myemph{问题}：量子梳是否规定了过程的因果结构？
>
>   \myemph{问题}：量子梳是是幺正过程？量子梳不一定是幺正的，但由于其具有确定的因果顺序，所以根据定理{（[[lorenz2020QuantumCausalStructure\|lorenz2020QuantumCausalStructure]] Th.5.1）}，它是可幺正拓展的。
>
>   容易证明量子梳都是归一化的过程矩阵。

    
> [!abstract] Contents
> - 在例\ref{ex:quantumprocess2}的第一点中，根据信道的先后作用顺序，存在确定的因果顺序，即$S=(A_2,A_1)$，$A_2$先于$A_1$，$\sigma_{A_1A_2}$是一个量子梳，因为$\sigma_{A_1A_2}=\mathbb{I}_{A_1^{\mathrm{out}*}}\otimes \rho^\mathcal{C}_{A_2^\mathrm{out}|A_1^\mathrm{in}}\otimes \rho_{A_2^\mathrm{in}}$在$A_1^{\mathrm{out}*}$上是平凡的，且$\mathrm{tr}_{A_1}\sigma_S=    \mathrm{tr}_{A_1^{\mathrm{in}}}\left( \rho^\mathcal{C}_{A_2^\mathrm{out}|A_1^\mathrm{in}} \right)\otimes \rho_{{A_2}^\mathrm{in}}=\mathbb{I}_{A_2^{\mathrm{out}*}} \otimes \rho_{A_2^\mathrm{in}}$在$A_2^{\mathrm{out}*}$上是平凡的。
> - 在例\ref{ex:quantumprocess2}的第二点中，根据信道的先后作用顺序，存在确定的因果顺序，即$S=(A_1,A_2)$，$A_1$先于$A_2$，$\sigma_{A_1A_2}$是一个量子梳，因为$\sigma_{A_1A_2}=\rho_{A_1^\mathrm{in}}\otimes  \rho^\mathcal{C}_{A_1^\mathrm{out}|A_2^\mathrm{in}}\otimes\mathbb{I}_{A_2^{\mathrm{out}*}}$在$A_2^{\mathrm{out}*}$上是平凡的，且$\mathrm{tr}_{A_2}\sigma_S=\rho_{A_1^\mathrm{in}}\otimes \mathrm{tr}_{A_2^{\mathrm{in}}}\left( \rho^\mathcal{C}_{A_1^\mathrm{out}|A_2^\mathrm{in}} \right) =\rho_{A_1^\mathrm{in}} \otimes\mathbb{I}_{A_1^{\mathrm{out}*}}$在$A_1^{\mathrm{out}*}$上是平凡的。

上面的例子需要重新检验。
    
一个$2$-梳吃进去一个信道，返回一个信道，在这里梳可以理解为一个在前后插入信道的操作$\mathcal{C}\mapsto \mathcal{E}^{A_1}\circ \mathcal{C}\circ \mathcal{E}^{A_2}$，在量子线路图上表现为有两个梳齿。
### 量子梳的投影刻画
![2025-02-15-12-03-51.png|800](/img/user/2025-02-15-12-03-51.png)
> [!theorem] 量子梳的投影刻画{} （[[hoffreumon2021MultiroundProcessMatrix\|hoffreumon2021MultiroundProcessMatrix]] Apd.1）
{ #th-th-projeccarofcomb}

>   一个正定矩阵$\sigma=B\left(\bigotimes_{i=1}^n T_i^{{ \text {in}}*} \otimes  {T_i^{\text {out}}}\right)$是量子梳当且仅当
> $$\mathrm{tr}(\sigma) = \prod_{i=1}^{n} d_{T^\mathrm{in}_i}$$
>   以及$$\mathcal{P}_n(\sigma)= \sigma$$
>   其中$$\mathcal{P}_n=\mathcal{I}-\mathcal{D}_{T^\mathrm{out}_n}(\mathcal{I}-\mathcal{D}_{T_n^\mathrm{in}}\mathcal{P}_{n-1})= \mathcal{I}-\mathcal{D}_{T^\mathrm{out}_n} +\mathcal{D}_{T_n}\mathcal{P}_{n-1},~\mathcal{P}_0=\mathcal{I}$$
> 将迭代式展开得到
> $$\mathcal{P}_n=\mathcal{I}-\mathcal{D}_{T^\mathrm{out}_n}(\mathcal{I}-\mathcal{D}_{T_n^\mathrm{in}}(\cdots (\mathcal{I}-\mathcal{D}_{T_1^\mathrm{out}}(\mathcal{I}-\mathcal{D}_{T_1^\mathrm{in}}))\cdots))$$

> [!proof]
> - 根据定义
> $$\mathrm{tr}(\sigma) = \prod_{i=1}^{n} d_{T^\mathrm{in}_i}$$
> $${\mathcal{D}}_{T_n\ldots T_{l  \bullet } }\sigma={\mathcal{D}}_{T_n\ldots T_{l+1}T_{l  \bullet } ^\mathrm{o}}\sigma ,~l=1\cdots n$$
>   由于记号的变动，原来非常麻烦的三个等式变成了一个等式。
>
>   (必要性) 只证明$n=2$的情形，$$\mathcal{P}_2(\sigma)=(1-\mathcal{D}_{T_2^\mathrm{o}}+\mathcal{D}_{T_2}-\mathcal{D}_{T_2 T_1^\mathrm{o}}+\mathcal{D}_{T_1T_2} )(\sigma) =\sigma$$
>   最后一个等号是因为左侧的后面两项抵消了。
>
>   ($\ldots$)

下面列出一些和量子梳的投影刻画有关的性质

- [[整理前的comb性质笔记\|整理前的comb性质笔记]] 

- 字母$T$的意思是齿。

- 前三个投影算符为（参见：重写投影刻画.nb）：
$$
\begin{aligned}
\mathcal{P}_1 & =  \mathcal{I}-\mathcal{D}_{T_1^\mathrm{o}}+\mathcal{D}_{T_1} \\
\mathcal{P}_2 & = \mathcal{I}-\mathcal{D}_{T_2^\mathrm{o}}+\mathcal{D}_{T_2}-\mathcal{D}_{T_2 T_1^\mathrm{o}}+\mathcal{D}_{T_1T_2} \\
\mathcal{P}_3 & = \mathcal{I}-D_{T_3^\mathrm{o}}-\mathcal{D}_{T_3}\mathcal{P}_2
\end{aligned}
$$

*   注意到当$n=1$时，该表达式退化为命题\ref{prop:choiandtracep}。

*   如果第**一个输入是平凡的**，那么有$\mathcal{P}_0=\mathcal{P}_1=\mathcal{I}$，迭代式不变，因此公式向后推迟了一颗齿 [1]。实际上，直接只需要将$T_i^\mathrm{in}$的完全退极化令为 $\mathcal{I}$ 代入原来的式子即可。
    $$
    \mathcal{P}_n=\mathcal{I}-\mathcal{D}_{T^\mathrm{out}_n}(\mathcal{I}-\mathcal{D}_{T_n^\mathrm{in}}(\cdots (\mathcal{I}-\mathcal{D}_{T_2^\mathrm{out}}(\mathcal{I}-\mathcal{D}_{T_2^\mathrm{in}}))\cdots))
    $$

*   如果最后一个输出是平凡的，那么公式最后会少一个空间：
    $$
    \mathcal{P}_n=\mathcal{I}-\mathcal{D}_{T_n^\mathrm{in}}(\cdots (\mathcal{I}-\mathcal{D}_{T_1^\mathrm{out}}(\mathcal{I}-\mathcal{D}_{T_1^\mathrm{in}}))\cdots)
    $$

*   当$n=3$且第一个输入与最后一个输出平凡时：
    $$
    \mathcal{P}_3 =\mathcal{I}-\mathcal{D}_{T_3^\mathrm{in}} (\mathcal{I}-\mathcal{D}_{T_1^\mathrm{out}}(\mathcal{I}-\mathcal{D}_{T_1^\mathrm{in}}))
    $$
    利用[[1 Stories of Bizzo's Life/5 量子科学和量子技术/33 量子因果结构#^bpkrmc\|33 量子因果结构#^bpkrmc]]中的记号，得到$\mathcal{P}_3= \mathcal{D}_{B^\mathrm{o}}-\mathcal{D}_{B}+\mathcal{D}_{A^\mathrm{o}B}$ ，与一般的量子过程矩阵的约束式\eqref{eq:2pointprocess}进行比较，量子梳是比过程矩阵更强的约束，下面的等式证明了这一点 [2]：
    $$
    \mathcal{P}_3  \circ L_V = \mathcal{P}_3
    $$

*   $\mathcal{P}_n$ 是保迹、保厄米的，并且在内积空间 $B(B(\mathsf{H}))$ 上是厄米的。

*   $\mathcal{P}_n$ 满足关系式：
    $$
    \mathcal{P}_n \mathcal{D}_{T_1^o \cdots T_n^o}=\mathcal{D}
    $$
    $$
    \mathcal{P}_n \mathcal{D}_{T_1^i \cdots T_n^i}=\mathcal{D}_{T_1^i \cdots T_n^i}
    $$
利用迭代式很容易看出来，证略。
---
**脚注**
[1] 验证参见：量子梳comb的投影刻画.nb - 第一个输入平凡的情形。
[2] 证明非常机械，参见：量子梳comb的投影刻画.nb，以及：重写投影刻画.nb。

> [!theorem] 量子梳的Kraus算符刻画 （[[dong2021ControlledQuantumOperations\|dong2021ControlledQuantumOperations]] Apd.D）
{ #th-th-krausofcomb}

> 

   
> [!theorem] 不同顺序的叠加的量子梳
> 

## 文献
-  