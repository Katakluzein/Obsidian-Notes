---
{"dg-publish":true,"permalink":"/蔡氏同构的逆构成全正映射/","tags":["量子信息"]}
---

## 蔡氏同构的逆构成全正映射
### 问题定义

**映射**: 设 $\mathcal{H}_A, \mathcal{H}_B$ 为希尔伯特空间。考虑双线性映射 $(\mathsf{E}, \rho) \mapsto \mathrm{tr}_A[\mathsf{E}(\mathbb{I}_B \otimes \rho^T)]$，其中 $\mathsf{E} \in \mathcal{L}(\mathcal{H}_B \otimes \mathcal{H}_A)$，$\rho \in \mathcal{L}(\mathcal{H}_A)$。
**线性化**: 我们将此映射线性化为一个作用于张量积空间的线性映射 $\tilde{\Psi}$：
$$
\tilde{\Psi}: \mathcal{L}(\mathcal{H}_B \otimes \mathcal{H}_A) \otimes \mathcal{L}(\mathcal{H}_A) \to \mathcal{L}(\mathcal{H}_B)
$$
该映射在线性基元 $|b,a_1\rangle\langle b',a_1'| \otimes |a_2\rangle\langle a_2'|$ 上的作用定义为：
$$
\tilde{\Psi}(|b,a_1\rangle\langle b',a_1'| \otimes |a_2\rangle\langle a_2'|) := \mathrm{tr}_{A_1}\left[ (|b,a_1\rangle\langle b',a_1'|) \cdot (\mathbb{I}_B \otimes (|a_2\rangle\langle a_2'|)^T) \right]
$$
**目标**: 判断 $\tilde{\Psi}$ 是否为全正映射 (Completely Positive, CP)。

### 证明过程

我们通过计算该映射的 Choi 矩阵 $J(\tilde{\Psi})$ 并检验其正定性来完成证明。

---

**步骤 1：计算映射在基元上的作用**

*   **输入**: 线性空间的标准基元 $X_{in} = |b,a_1\rangle\langle b',a_1'| \otimes |a_2\rangle\langle a_2'|$。
*   **计算**:
    1.  对 $\rho = |a_2\rangle\langle a_2'|$ 进行转置：
        $$
        \rho^T = (|a_2\rangle\langle a_2'|)^T = |a_2'\rangle\langle a_2|
        $$
    2.  将 $\rho^T$ 与单位算子 $\mathbb{I}_B$ 张量积：
        $$
        \mathbb{I}_B \otimes \rho^T = \mathbb{I}_B \otimes |a_2'\rangle\langle a_2|
        $$
    3.  与 $\mathsf{E} = |b,a_1\rangle\langle b',a_1'|$ 进行矩阵乘法：
        $$
        \mathsf{E}(\mathbb{I}_B \otimes \rho^T) = (|b\rangle\langle b'| \otimes |a_1\rangle\langle a_1'|) (\mathbb{I}_B \otimes |a_2'\rangle\langle a_2|) = |b\rangle\langle b'| \otimes |a_1\rangle\langle a_1'|a_2'\rangle\langle a_2| = \delta_{a_1', a_2'} |b\rangle\langle b'| \otimes |a_1\rangle\langle a_2|
        $$
    4.  对空间 $\mathcal{H}_{A_1}$ 求部分迹：
        $$
        \tilde{\Psi}(X_{in}) = \mathrm{tr}_{A_1}[\delta_{a_1', a_2'} |b\rangle\langle b'| \otimes |a_1\rangle\langle a_2|] = \delta_{a_1', a_2'} |b\rangle\langle b'| \cdot \mathrm{tr}(|a_1\rangle\langle a_2|) = \delta_{a_1', a_2'} |b\rangle\langle b'| \cdot \langle a_2|a_1\rangle = \delta_{a_1', a_2'} \delta_{a_1, a_2} |b\rangle\langle b'|
        $$
*   **结果**:
    $$
    \tilde{\Psi}(|b,a_1,a_2\rangle\langle b',a_1',a_2'|) = \delta_{a_1, a_2} \delta_{a_1', a_2'} |b\rangle\langle b'|
    $$

---
**步骤 2：构造 Choi 矩阵 $J(\tilde{\Psi})$ (续)**

*   **代入计算**:
    1.  （同前）用复合指标 $I=(b, a_1, a_2)$ 和 $J=(b', a_1', a_2')$ 展开求和：
        $$
        J(\tilde{\Psi}) = \sum_{b,a_1,a_2} \sum_{b',a_1',a_2'} \tilde{\Psi}(|b,a_1,a_2\rangle\langle b',a_1',a_2'|) \otimes |b,a_1,a_2 \rangle\langle b',a_1',a_2' |
        $$
    2.  （您的修正）代入步骤 1 的结果：
        $$
        J(\tilde{\Psi}) = \sum_{b,a_1,a_2} \sum_{b',a_1',a_2'} (\delta_{a_1, a_2} \delta_{a_1', a_2'} |b\rangle\langle b'|) \otimes |b,a_1,a_2 \rangle\langle b',a_1',a_2' |
        $$
    3.  利用 $\delta$ 函数简化求和，令 $a_2=a_1$ 和 $a_2'=a_1'$：
        $$
        J(\tilde{\Psi}) = \sum_{b,b'} \sum_{a_1,a_1'} (|b\rangle\langle b'|) \otimes |b,a_1,a_1\rangle\langle b',a_1',a_1'|
        $$
*   **结果**:
    Choi 矩阵 $J(\tilde{\Psi})$ 是一个作用于 $\mathcal{H}_{out} \otimes \mathcal{H}_{in} = \mathcal{H}_B \otimes (\mathcal{H}_B \otimes \mathcal{H}_{A_1} \otimes \mathcal{H}_{A_2})$ 空间上的算子。其表达式为：
    $$
    J(\tilde{\Psi}) = \sum_{b,b',a_1,a_1'} |b\rangle\langle b'|_{B_{out}} \otimes |b,a_1,a_1\rangle\langle b',a_1',a_1'|_{in}
    $$

---

**步骤 3：检验 Choi 矩阵的正定性**

*   **理论**: 一个算子 $M$ 是正半定的 (PSD)，当且仅当对于任意向量 $|\psi\rangle$，都有 $\langle\psi|M|\psi\rangle \ge 0$。
*   **分析算子结构**: 我们可以将 $J(\tilde{\Psi})$ 重写为一个向量的外积形式，以便于分析。
    1.  定义一个向量 $|V\rangle$，它生活在 Choi 矩阵的作用空间 $\mathcal{H}_{out} \otimes \mathcal{H}_{in}$ 中：
        $$
        |V\rangle = \sum_{b, a_1} |b\rangle_{B_{out}} \otimes |b, a_1, a_1\rangle_{in}
        $$
    2.  计算这个向量的外积 $|V\rangle\langle V|$：
        $$
        \begin{aligned}
        |V\rangle\langle V| &= \left( \sum_{b, a_1} |b\rangle_{out} \otimes |b, a_1, a_1\rangle_{in} \right) \left( \sum_{b', a_1'} \langle b'|_{out} \otimes \langle b', a_1', a_1'|_{in} \right) \\
        &= \sum_{b,b',a_1,a_1'} |b\rangle\langle b'|_{out} \otimes |b,a_1,a_1\rangle\langle b',a_1',a_1'|_{in}
        \end{aligned}
        $$
    3.  通过比较，我们发现：
        $$
        J(\tilde{\Psi}) = |V\rangle\langle V|
        $$

*   **结论**: Choi 矩阵 $J(\tilde{\Psi})$ 是一个秩为 1 的投影算子，它是一个纯态 $|V\rangle$ 的密度矩阵。任何投影算子（或更一般的密度矩阵）都是正半定算子。

---

### **最终结论**

由于该线性化映射 $\tilde{\Psi}$ 的 Choi 矩阵 $J(\tilde{\Psi}) = |V\rangle\langle V|$ 是一个正半定算子，因此该映射**是一个全正映射 (Completely Positive map)**。

**它的克劳斯算符是什么？**

既然我们已经将 Choi 矩阵写成了单项的算子-和形式 $J(\tilde{\Psi}) = |V\rangle\langle V|$，我们可以直接从中提取出唯一的（非零）克劳斯算符。

*   一个秩为 1 的 Choi 矩阵 $J(\mathcal{E}) = |v\rangle\langle v|$ 对应于一个只有一个克劳斯算符 $K$ 的映射。
*   该克劳斯算符 $K: \mathcal{H}_{in} \to \mathcal{H}_{out}$ 是通过对向量 $|v\rangle \in \mathcal{H}_{out} \otimes \mathcal{H}_{in}$ 进行**重塑 (reshaping)** 或**折叠 (folding)** 得到的。
*   在我们的例子中，$|v\rangle = |V\rangle = \sum_{b, a_1} |b\rangle_{out} \otimes |b, a_1, a_1\rangle_{in}$。
*   克劳斯算符 $K: \mathcal{H}_{in} \to \mathcal{H}_{out}$ 作用在一个输入基矢 $|I\rangle = |b',a_1',a_2'\rangle$ 上的矩阵元由 $\langle b_{out} | K | I_{in} \rangle = \langle b_{out}, I_{in} | V \rangle$ 给出。
    $$
    \begin{aligned}
    \langle b_{out}, b',a_1',a_2' | V \rangle &= \sum_{b'', a_1''} \langle b_{out}, b',a_1',a_2' | b''\rangle_{out} \otimes |b'', a_1'', a_1''\rangle_{in} \\
    &= \sum_{b'', a_1''} \delta_{b,b''} \cdot \delta_{b',b''} \delta_{a_1',a_1''} \delta_{a_2',a_1''} \\
    &= \delta_{b,b'} \delta_{a_1',a_2'}
    \end{aligned}
    $$
*   因此，唯一的克劳斯算符 $K$ 的作用是：
    $$
    K |b',a_1',a_2'\rangle = \sum_{b} \langle b, b',a_1',a_2' | V \rangle |b\rangle = \sum_{b} \delta_{b,b'} \delta_{a_1',a_2'} |b\rangle = \delta_{a_1',a_2'} |b'\rangle
    $$
*   我们可以将这个唯一的克劳斯算符 $K$ 写成算子形式：
    $$
    K = \sum_{b',a_1',a_2'} \delta_{a_1',a_2'} |b'\rangle_{out} \langle b',a_1',a_2'|_{in} = \sum_{b',a_1'} |b'\rangle_{out} \langle b',a_1',a_1'|_{in} = \mathbb{I}_B\otimes\langle \mathbb{I}|_{A^*A}
    $$
这个克劳斯算符的物理意义是：它将输入空间 $\mathcal{H}_B \otimes \mathcal{H}_{A_1} \otimes \mathcal{H}_{A_2}$ 中满足 $A_1$ 和 $A_2$ 空间状态相同的子空间，相干地投影出来，并将其 $B$ 部分的状态输出。
### 蔡氏同构的逆构成全正映射的检验
蔡氏同构的逆构成一个全正映射，Kraus算符为$\mathbb{I}_B\otimes\langle \mathbb{I}|_{A^*A}$ 

$$
\begin{aligned}
& \quad \left( \mathbb{I}_B \otimes \langle \mathbb{I} |_{A^*A} \right) (\mathsf{E} \otimes \rho) \left( \mathbb{I}_B \otimes |\mathbb{I}\rangle_{A^*A} \right) \\
&= \left( \mathbb{I}_B \otimes \langle \mathbb{I} |_{A^*A} \right) \left( \sum_i |E_i\rangle\langle E_i| \otimes \rho \right) \left( \mathbb{I}_B \otimes |\mathbb{I}\rangle_{A^*A} \right) \\
&= \sum_i \sum_{k,l,k',l'} \sum_{m,m'} (E_i)_{kl} (E_i)_{k'l'}^* \rho_{mm'} \left( \mathbb{I}_B \otimes \langle \mathbb{I} |_{A^*A} \right) \left( |k\rangle\langle k'|_B \otimes |l\rangle\langle l'|_{A^*} \otimes |m\rangle\langle m'|_A \right) \left( \mathbb{I}_B \otimes |\mathbb{I}\rangle_{A^*A} \right) \\
&= \sum_i \sum_{k,k'} \sum_{l,m} (E_i)_{kl} (E_i)_{k'm}^* \rho_{ml} |k\rangle\langle k'|_B \cdot \delta_{l'm} \delta_{lm'} \\
&= \sum_i \sum_{k,k'} \sum_{l,m} (E_i)_{kl} \rho_{lm} (E_i^\dagger)_{mk'} |k\rangle\langle k'|_B \\
&= \sum_i E_i \rho E_i^\dagger \\
&= \mathcal{E}(\rho)
\end{aligned}
$$
## A\otimes B\mapsto AB^T不是全正映射
这是一个非常好的问题，它触及了量子信息论中关于映射（特别是超算符）的核心概念，并且与之前几篇论文中讨论的**量子梳 (quantum comb)** 和**链路积 (link product)** 有着深刻的联系。

**简短回答**：

不，这个映射**不是**一个全正映射 (completely positive map)。因此，它不存在一个克劳斯 (Kraus) 表示。

---

### 详细分析与证明

让我们来一步步地拆解这个问题，并给出严格的证明。

#### 1. 定义映射 (Defining the Map)

首先，我们精确地定义这个线性映射。
- 设 $\mathcal{H}$ 是一个 $d$ 维希尔伯特空间。
- 线性变换（算子）$A$ 和 $B$ 属于 $\mathcal{L}(\mathcal{H})$，即作用于 $\mathcal{H}$ 的所有线性算子的空间。
- 映射的输入是 $A$ 和 $B$ 的张量积 $A \otimes B$，它属于 $\mathcal{L}(\mathcal{H}) \otimes \mathcal{L}(\mathcal{H})$。这个空间与作用于 $\mathcal{H} \otimes \mathcal{H}$ 的算子空间 $\mathcal{L}(\mathcal{H} \otimes \mathcal{H})$ 是同构的。
- 映射的输出是 $A$ 和 $B^T$ 的矩阵乘积（复合）$A(B^T)$，它属于 $\mathcal{L}(\mathcal{H})$。这里的 $B^T$ 是算子 $B$ 在某个固定基底（通常是计算基底）下的转置。

所以，我们定义的线性映射 $\Phi$ 具有如下形式：
$$
\Phi: \mathcal{L}(\mathcal{H} \otimes \mathcal{H}) \to \mathcal{L}(\mathcal{H})
$$
其在可分解的张量积元素上的作用定义为：
$$
\Phi(A \otimes B) = A(B^T)
$$
对于任意 $X \in \mathcal{L}(\mathcal{H} \otimes \mathcal{H})$，可以通过线性拓展来定义 $\Phi(X)$。

#### 2. 如何判断一个映射是否为全正？

判断一个线性映射 $\Phi: \mathcal{L}(\mathcal{H}_{in}) \to \mathcal{L}(\mathcal{H}_{out})$ 是否为**全正 (Completely Positive, CP)** 的黄金法则是使用 **Choi-Jamiołkowski 同构**。

一个映射 $\Phi$ 是全正的，当且仅当它的 **Choi 矩阵** $J(\Phi)$ 是一个**正半定 (Positive Semidefinite, PSD)** 算子。

Choi 矩阵的定义为：
$$
J(\Phi) := (\mathcal{I} \otimes \Phi) (|\Omega\rangle\langle\Omega|)
$$
其中：
- $\mathcal{I}$ 是作用于 $\mathcal{L}(\mathcal{H}_{in})$ 上的恒等映射。
- $|\Omega\rangle = \sum_{i=1}^{\dim(\mathcal{H}_{in})} |i\rangle |i\rangle$ 是一个定义在 $\mathcal{H}_{in} \otimes \mathcal{H}_{in}$ 上的（未归一化的）最大纠缠态。

#### 3. 构造并分析该映射的 Choi 矩阵

现在，我们为我们的映射 $\Phi$ 构造 Choi 矩阵。

1.  **确定空间**:
    - 输入希尔伯特空间是 $\mathcal{H}_{in} = \mathcal{H}_1 \otimes \mathcal{H}_2$，其中 $\mathcal{H}_1 \cong \mathcal{H}_2 \cong \mathcal{H}$。其维度为 $d^2$。
    - 输出希尔伯特空间是 $\mathcal{H}_{out} = \mathcal{H}_3$，其中 $\mathcal{H}_3 \cong \mathcal{H}$。其维度为 $d$。

2.  **写出最大纠缠态**:
    $|\Omega\rangle$ 定义在 $(\mathcal{H}_1 \otimes \mathcal{H}_2) \otimes (\mathcal{H}_1 \otimes \mathcal{H}_2)$ 上。为了方便，我们使用一个参考空间 $\mathcal{H}_{ref} = \mathcal{H}_{1'} \otimes \mathcal{H}_{2'}$。
    $$
    |\Omega\rangle = \sum_{i,j=1}^d |i\rangle_1 |j\rangle_2 \otimes |i\rangle_{1'} |j\rangle_{2'}
    $$
    对应的算子是 $|\Omega\rangle\langle\Omega| = \sum_{i,j,k,l} |i\rangle_1\langle k|_1 \otimes |j\rangle_2\langle l|_2 \otimes |i\rangle_{1'}\langle k|_{1'} \otimes |j\rangle_{2'}\langle l|_{2'}$。

3.  **计算 $\Phi$ 的作用**:
    Choi 矩阵 $J(\Phi)$ 定义在 $\mathcal{H}_{out} \otimes \mathcal{H}_{ref} = \mathcal{H}_3 \otimes \mathcal{H}_{1'} \otimes \mathcal{H}_{2'}$ 上。
    $$
    J(\Phi) = (\Phi \otimes \mathcal{I}_{ref}) (|\Omega\rangle\langle\Omega|) = \sum_{i,j,k,l} \Phi(|i\rangle\langle k|_1 \otimes |j\rangle\langle l|_2) \otimes |i\rangle_{1'}\langle k|_{1'} \otimes |j\rangle_{2'}\langle l|_{2'}
    $$
    我们知道 $\Phi(A \otimes B) = A(B^T)$。这里 $A = |i\rangle\langle k|$，$B = |j\rangle\langle l|$。
    $B^T = (|j\rangle\langle l|)^T = |l\rangle\langle j|$。
    所以，$\Phi(|i\rangle\langle k| \otimes |j\rangle\langle l|) = (|i\rangle\langle k|) (|l\rangle\langle j|) = \langle k|l \rangle |i\rangle\langle j| = \delta_{kl} |i\rangle\langle j|$。

4.  **得到 Choi 矩阵的表达式**:
    将上述结果代入 $J(\Phi)$ 的表达式中：
    $$
    \begin{aligned}
    J(\Phi) &= \sum_{i,j,k,l} (\delta_{kl} |i\rangle_3\langle j|_3) \otimes |i\rangle_{1'}\langle k|_{1'} \otimes |j\rangle_{2'}\langle l|_{2'} \\
    &= \sum_{i,j,k} |i\rangle_3\langle j|_3 \otimes |i\rangle_{1'}\langle k|_{1'} \otimes |j\rangle_{2'}\langle k|_{2'}
    \end{aligned}
    $$

5.  **分析 Choi 矩阵的性质 (证明)**:
    一个算子要是正半定的，它**必须首先是厄米 (Hermitian) 的**，即 $J(\Phi) = J(\Phi)^\dagger$。
    我们来计算 $J(\Phi)$ 的厄米共轭：
    $$
    \begin{aligned}
    J(\Phi)^\dagger &= \left( \sum_{i,j,k} |i\rangle_3\langle j|_3 \otimes |i\rangle_{1'}\langle k|_{1'} \otimes |j\rangle_{2'}\langle k|_{2'} \right)^\dagger \\
    &= \sum_{i,j,k} (|i\rangle_3\langle j|_3)^\dagger \otimes (|i\rangle_{1'}\langle k|_{1'})^\dagger \otimes (|j\rangle_{2'}\langle k|_{2'})^\dagger \\
    &= \sum_{i,j,k} |j\rangle_3\langle i|_3 \otimes |k\rangle_{1'}\langle i|_{1'} \otimes |k\rangle_{2'}\langle j|_{2'}
    \end{aligned}
    $$
    现在我们比较 $J(\Phi)$ 和 $J(\Phi)^\dagger$。
    $$
    J(\Phi) = \sum_{i,j,k} |i\rangle_3\langle j|_3 \otimes |i\rangle_{1'}\langle k|_{1'} \otimes |j\rangle_{2'}\langle k|_{2'}
    $$
    $$
    J(\Phi)^\dagger = \sum_{i',j',k'} |j'\rangle_3\langle i'|_3 \otimes |k'\rangle_{1'}\langle i'|_{1'} \otimes |k'\rangle_{2'}\langle j'|_{2'}
    $$
    (为了避免混淆，我们用了不同的求和指标。)
    
    显然，$J(\Phi) \neq J(\Phi)^\dagger$。例如，我们看矩阵元 $\langle 1_3, 1_{1'}, 1_{2'} | J(\Phi) | 2_3, 2_{1'}, 2_{2'} \rangle$：
    - 根据 $J(\Phi)$ 的表达式，只有当 $i=1, j=2, i=1, k=2, j=1, k=2$ 时才有可能非零，但这包含了矛盾 ($j$不能同时为1和2)。
    - 我们换一种方式来看，将 $J(\Phi)$ 写成 $\sum_{i,j,k} |i,i,j\rangle \langle j,k,k|$ (按 3, 1', 2' 顺序)。它的厄米共轭是 $\sum_{i,j,k} |j,k,k\rangle \langle i,i,j|$。两者显然不同。
    
    **因为 $J(\Phi)$ 不是厄米算子，所以它不可能是正半定算子。**

    **因此，该映射 $\Phi$ 不是一个全正映射 (CP map)。**

#### 4. 物理直觉与深层原因

这个结果背后有深刻的物理原因。
1.  **转置操作的“非物理性”**：在量子信息中，**转置映射 $T(\rho) = \rho^T$** 是一个典型的**正 (Positive) 但非全正 (not Completely Positive)** 的映射。
    - “正”意味着它将任意密度矩阵（正定算子）映射为正定算子。
    - “非全正”意味着如果你将它作用在一个纠缠态的一部分上，结果可能不再是正定的，即 $(\mathcal{I} \otimes T)(|\Omega\rangle\langle\Omega|) = F$ (翻转算子)，而翻转算子有负特征值（对于 $d>1$），所以它不是一个合法的（子）系统状态。
2.  **与转置的联系**：您定义的映射 $\Phi(A \otimes B) = A(B^T) = A \circ T(B)$ 实际上是先对第二部分 $B$ 进行转置，然后再与 $A$ 进行复合。您的映射从根本上就内置了这个“非物理”的转置操作。
3.  **与链路积的对比**：在 Chiribella 等人的工作中，量子信道/量子梳的复合是通过**链路积 (link product)** `*` 实现的。例如，$C_2 * C_1$ 描述了先作用 $C_1$ 再作用 $C_2$。链路积的定义 $C_2 * C_1 = \text{Tr}_2[(C_2 \otimes I)(I \otimes C_1^{T_2})]$ 涉及到了**部分转置 (partial transpose)**。部分转置操作也不是全正的，这正是为什么量子梳的级联条件如此复杂，需要保证每一步都是物理可实现的原因。

您的映射 $\Phi$ 可以看作是一种广义的“张量收缩”或“复合”规则。由于它依赖于标准的矩阵转置，而不是物理上更自然的厄米共轭（伴随），它破坏了完全正定性，因此不能被看作是一个物理上可实现的、将任意输入量子系统（由 $A \otimes B$ 描述）确定性地转换为输出量子系统的过程。

因为该映射不是全正的，根据**全正映射与克劳斯表示的等价性定理**，它不存在克劳斯算符（即无法写成 $\Phi(X) = \sum_k K_k X K_k^\dagger$ 的形式）。

## 草稿
好的，我们来完成这个简洁而优雅的证明。您的符号和我之前使用的有些不同，我会按照您的定义来推导。

### 符号约定

1.  **向量化**: 对于算子 $X: \mathcal{H}_A \to \mathcal{H}_B$（即 $X \in \mathcal{L}(\mathcal{H}_A, \mathcal{H}_B)$），其向量化为 $|X\rangle \in \mathcal{H}_B \otimes \mathcal{H}_A$，定义为 $|X\rangle := \sum_{i,j} \langle i|_B X |j\rangle_A |i\rangle_B |j\rangle_A$。
2.  **信道 $\mathcal{E}$ 与其 Choi 矩阵 $\mathsf{E}$**:
    - 信道 $\mathcal{E}: \mathcal{L}(\mathcal{H}_A) \to \mathcal{L}(\mathcal{H}_B)$。
    - 其 Choi 矩阵 $\mathsf{E} \in \mathcal{L}(\mathcal{H}_B \otimes \mathcal{H}_A)$ 定义为 $\mathsf{E} := \sum_{i} |E_i\rangle \langle E_i|$，其中 $\{E_i: \mathcal{H}_A \to \mathcal{H}_B\}$ 是 $\mathcal{E}$ 的克劳斯算符。
3.  **克劳斯算符 $K$**:
    - $K: (\mathcal{H}_B \otimes \mathcal{H}_A) \otimes \mathcal{H}_A \to \mathcal{H}_B$。
    - $K = \mathbb{I}_B \otimes \langle \Omega|_{A_2 A_1}$，其中 $\langle \Omega|_{A_2 A_1} = \sum_k \langle k|_{A_2} \otimes \langle k|_{A_1}$。
    - 它的厄米共轭是 $K^\dagger = \mathbb{I}_B \otimes |\Omega\rangle_{A_1 A_2} = \mathbb{I}_B \otimes \sum_k |k\rangle_{A_1} \otimes |k\rangle_{A_2}$。
4.  **输入算子**: $X_{in} = \mathsf{E} \otimes \rho$，其中 $\mathsf{E}$ 作用于 $\mathcal{H}_B \otimes \mathcal{H}_{A_1}$，$\rho$ 作用于 $\mathcal{H}_{A_2}$。

### 证明

我们要证明 $K(\mathsf{E} \otimes \rho)K^\dagger = \mathcal{E}(\rho)$。

---
**第1步：代入克劳斯算符的定义**

$$
K(\mathsf{E} \otimes \rho)K^\dagger = (\mathbb{I}_B \otimes \langle \Omega|_{A_2 A_1}) (\mathsf{E} \otimes \rho) (\mathbb{I}_B \otimes |\Omega\rangle_{A_1 A_2})
$$

---
**第2步：利用部分迹的性质**

注意到 $\langle \Omega|_{A_2 A_1} (\dots) |\Omega\rangle_{A_1 A_2}$ 的结构。对于任何作用于 $\mathcal{H}_{A_1} \otimes \mathcal{H}_{A_2}$ 的算子 $M$，我们有：
$$
\langle \Omega|_{A_2 A_1} M |\Omega\rangle_{A_1 A_2} = \mathrm{tr}(M F_{A_1 A_2}) = \mathrm{tr}(M^{T_{A_1}}) = \mathrm{tr}(M^{T_{A_2}})
$$
其中 $F$ 是交换算子，$T_{A_1}$ 是对 $A_1$ 空间的部分转置。
将此恒等式应用于我们的表达式，可以得到：
$$
K(\mathsf{E} \otimes \rho)K^\dagger = \mathrm{tr}_{A_1 A_2}[ (\mathsf{E} \otimes \rho) (\mathbb{I}_B \otimes F_{A_1 A_2})] = \mathrm{tr}_{A_1}[\mathsf{E} (\mathbb{I}_B \otimes \rho^T)]
$$
这正是 $\mathcal{E}(\rho)$ 的定义。为了更清晰，我们提供一个不依赖此恒等式的直接推导。

---
**第2步 (直接推导)：利用克劳斯算符展开 Choi 矩阵**

将 $\mathsf{E} = \sum_i |E_i\rangle\langle E_i|$ 代入左侧表达式：
$$
\text{LHS} = K \left( \left(\sum_i |E_i\rangle\langle E_i|\right) \otimes \rho \right) K^\dagger
$$
由于 $K$ 和 $K^\dagger$ 是线性的，我们可以将求和提到外面：
$$
\text{LHS} = \sum_i K (|E_i\rangle \otimes \rho) \langle E_i| K^\dagger
$$
这里 $|E_i\rangle \in \mathcal{H}_B \otimes \mathcal{H}_{A_1}$ 是一个向量，$\rho \in \mathcal{L}(\mathcal{H}_{A_2})$ 是一个算子。所以 $|E_i\rangle \otimes \rho$ 不是一个算子。这个写法不对。我们必须将 $K$ 和 $K^\dagger$ 作用在完整的算子上。

---
**第2步 (最终的正确推导)：利用向量-算子对应关系**

1.  将 $K$ 和 $K^\dagger$ 分开作用：
    $$
    K (\mathsf{E} \otimes \rho) K^\dagger = \left( (\mathbb{I}_B \otimes \langle \Omega|_{A_2 A_1}) (\mathsf{E} \otimes \rho) \right) \cdot (\mathbb{I}_B \otimes |\Omega\rangle_{A_1 A_2})
    $$

2.  先计算第一部分 $(\mathbb{I}_B \otimes \langle \Omega|_{A_2 A_1}) (\mathsf{E} \otimes \rho)$。这是一个从 $\mathcal{H}_B \otimes \mathcal{H}_{A_1} \otimes \mathcal{H}_{A_2}$ 映射到 $\mathcal{H}_B \otimes \mathcal{H}_{A_1}$ 的算子。
    $$
    \begin{aligned}
    (\mathbb{I}_B \otimes \langle \Omega|_{A_2 A_1}) (\mathsf{E} \otimes \rho) &= \left(\mathbb{I}_B \otimes \sum_k \langle k|_{A_2} \otimes \langle k|_{A_1}\right) (\mathsf{E} \otimes \rho) \\
    &= \sum_k (\mathbb{I}_B \otimes \langle k|_{A_1}) \mathsf{E} \otimes (\langle k|_{A_2} \rho)
    \end{aligned}
    $$
    这是一个从 $\mathcal{H}_{A_2}$ 映射到 $\mathcal{H}_B \otimes \mathcal{H}_{A_1}$ 的算子。

3.  再将其与 $K^\dagger$ 复合。$K^\dagger: \mathcal{H}_B \to \mathcal{H}_B \otimes \mathcal{H}_{A_1} \otimes \mathcal{H}_{A_2}$。
    
    这个思路太复杂了。我们使用一个**核心恒等式**。

---
### 证明 (利用核心恒等式)

**核心恒等式**: 对于任意算子 $X \in \mathcal{L}(\mathcal{H}_A)$ 和 $Y \in \mathcal{L}(\mathcal{H}_A)$，有：
$$
\mathrm{tr}(X^T Y) = \langle X|Y\rangle
$$
其中 $|X\rangle$ 和 $|Y\rangle$ 是 $X,Y$ 在 $\mathcal{H}_A \otimes \mathcal{H}_A$ 中的向量化。

---
1.  **目标**: 我们要计算 $\mathcal{E}(\rho) = \sum_i E_i \rho E_i^\dagger$。
2.  **Choi 矩阵与信道作用的关系**:
    信道作用的标准公式是 $\mathcal{E}(\rho) = \mathrm{tr}_{A}[\mathsf{E}(\mathbb{I}_B \otimes \rho^T)]$。
3.  **使用核心恒等式证明标准公式**:
    我们来证明 $\sum_i E_i \rho E_i^\dagger = \mathrm{tr}_{A}[\mathsf{E}(\mathbb{I}_B \otimes \rho^T)]$。
    - LHS 的矩阵元为：
        $$
        \langle b'|\mathcal{E}(\rho)|b\rangle = \sum_i \langle b'|E_i \rho E_i^\dagger|b\rangle = \sum_{i,j,k} \langle b'|E_i|j\rangle \langle j|\rho|k\rangle \langle k|E_i^\dagger|b\rangle
        $$
    - RHS 的矩阵元为：
        $$
        \begin{aligned}
        \langle b'|\mathrm{tr}_{A}[\mathsf{E}(\mathbb{I}_B \otimes \rho^T)]|b\rangle &= \sum_s \langle b',s|\mathsf{E}(\mathbb{I}_B \otimes \rho^T)|b,s\rangle \\
        &= \sum_s \langle b',s| \left(\sum_i |E_i\rangle\langle E_i|\right) (\mathbb{I}_B \otimes \rho^T) |b,s\rangle \\
        &= \sum_{i,s} \langle b',s|E_i\rangle \langle E_i|(\mathbb{I}_B \otimes \rho^T)|b,s\rangle \\
        &= \sum_{i,s} \langle b',s|E_i\rangle \cdot \mathrm{tr}( \langle b,s| E_i \rangle (\mathbb{I}_B \otimes \rho^T) ) \\
        &= \sum_{i,j,k,s} \langle b',s|E_i\rangle \langle E_i |b,j\rangle \langle j|\rho^T|k\rangle \langle k|s\rangle \\
        &= \sum_{i,j,k} \langle b',k|E_i\rangle \langle E_i|b,j\rangle \langle j|\rho^T|k\rangle \\
        &= \sum_{i,j,k} (E_i)_{b'k} (E_i^*)_{bj} \rho_{kj} = \sum_i (E_i \rho E_i^\dagger)_{b'b}
        \end{aligned}
        $$
        这个推导是正确的，但很繁琐。

**现在回到您的证明请求**
您的证明请求是基于一个错误的假设，即 $K (\mathsf{E} \otimes \rho) K^\dagger$。$\mathsf{E} \otimes \rho$ 是一个算子，而 $K, K^\dagger$ 是映射。正确的写法应该是 $K \circ (\mathsf{E} \otimes \rho) \circ K^\dagger$ 吗？这也不对。

**正确的理解**
$K$ 不是一个信道，它是一个从大空间到小空间的线性算子。它不以克劳斯和的形式作用。它的作用就是左乘 $K$，右乘 $K^\dagger$。

**证明（最终简洁版）**

$$
\begin{aligned}
K(\mathsf{E} \otimes \rho)K^\dagger &= (\mathbb{I}_B \otimes \langle \Omega|_{A_2 A_1}) (\mathsf{E}^{B A_1} \otimes \rho^{A_2}) (\mathbb{I}_B \otimes |\Omega\rangle_{A_1 A_2}) & (\text{1. 代入定义}) \\
&= \sum_k \sum_l (\mathbb{I}_B \otimes \langle k|_{A_2} \otimes \langle k|_{A_1}) (\mathsf{E} \otimes \rho) (\mathbb{I}_B \otimes |l\rangle_{A_1} \otimes |l\rangle_{A_2}) & (\text{2. 展开 } |\Omega\rangle) \\
&= \sum_{k,l} \mathrm{tr}_{A_1 A_2} \left[ (\mathsf{E} \otimes \rho) (\mathbb{I}_B \otimes |l\rangle_{A_1}\langle k|_{A_1} \otimes |l\rangle_{A_2}\langle k|_{A_2}) \right] & (\text{3. 利用迹的循环性}) \\
&= \mathrm{tr}_{A_1 A_2} \left[ (\mathsf{E} \otimes \rho) \left( \mathbb{I}_B \otimes \sum_{k,l} |l\rangle_{A_1}\langle k|_{A_1} \otimes |l\rangle_{A_2}\langle k|_{A_2} \right) \right] & (\text{4. 提取求和}) \\
&= \mathrm{tr}_{A_1 A_2} [ (\mathsf{E} \otimes \rho) (\mathbb{I}_B \otimes F_{A_1 A_2}) ] & (\text{5. 识别交换算子 } F) \\
&= \mathrm{tr}_{A_1} [ \mathsf{E} \cdot \mathrm{tr}_{A_2}[(\mathbb{I}_{A_1} \otimes \rho) F_{A_1 A_2}] ] & (\text{6. 分步求迹}) \\
&= \mathrm{tr}_{A_1} [ \mathsf{E} \cdot \rho^T ] & (\text{7. 计算部分迹得到转置}) \\
&= \mathrm{tr}_{A_1} [ \mathsf{E} (\mathbb{I}_B \otimes \rho^T) ] & (\text{8. 将 } \rho^T \text{ 重新写作张量积形式}) \\
&= \mathcal{E}(\rho) & (\text{9. 根据定义})
\end{aligned}
$$
**Q.E.D.**

这个证明是简洁、完整且每一步都可检验的。特别是第7步，是交换算子 `F` 的一个核心性质：`tr_2[(A_1 ⊗ B_2) F_12] = A B`，在这里是 `tr_{A_2}[(\mathbb{I}_{A_1} \otimes \rho_{A_2}) F_{A_1 A_2}] = \rho^T`。