---
{"dg-publish":true,"permalink":"/自然变换/","tags":["范畴论"]}
---

## 自然变换：函子之间的态射
> [!definition] 自然变换，或函子之间的态射{\cite[Def.2.2.5  liwenweiav1]
> \label{def:natraltrans}
>   设 $F, G: \mathsf{C}^{\prime} \rightarrow \mathsf{C}$ 是两个具有相同始对象和终对象的函子。一个从 $F$ 到 $G$ 的**自然变换 (natural transformation)** $\theta$ 是一族（a family of）态射，这族态射由 $\mathsf{C}'$ 中的每个对象 $X$ 所索引：
>   $$
>   \{\theta_{X}: F(X) \to G(X)\}_{X \in \operatorname{Ob}\left(\mathsf{C}^{\prime}\right)}
>   $$
>   其中，$\theta_X$ 被称为 $\theta$ 在 $X$ 处的**分量 (component)**{\cite{MonomorphismWikiwandArticles def.1.4.1}}。
>
>   这一族态射必须满足**自然性条件 (naturality condition)**，即对于 $\mathsf{C}^{\prime}$ 中的**每一个**态射 $f: X \rightarrow Y$，下面的交换图都成立：
>   ```tikz
>   \usepackage{amsmath}
>   \usepackage{tikz-cd}
>   \begin{document}
>   \begin{tikzcd}[sep=large]
>   FX && GX \\
>   \\
>   FY && GY
>   \arrow["{\theta_X}", from=1-1, to=1-3]
>   \arrow["Gf", from=1-3, to=3-3]
>   \arrow["Ff"', from=1-1, to=3-1]
>   \arrow["{\theta_Y}"', from=3-1, to=3-3]
>   \end{tikzcd}
>   \end{document}
>   ```
>
>   这个交换图等价于以下等式：
>   $$
>   G(f) \circ \theta_X = \theta_Y \circ F(f)
>   $$
>
>   我们通常将一个自然变换记作 $\theta: F \Rightarrow G$。它可以被形象地理解为将函子 $F$ “平滑地”形变为函子 $G$ 的一种方式，或者说是函子之间的“态射”。
>
>   在图示上，这可以表示为：
{ #ugno5r}

```tikz
\usepackage{amsmath}
\usepackage{tikz-cd}
\begin{document}
\begin{tikzcd}[sep=200] % 增加了 sep 使其更美观
{\mathsf{C}^\prime} & {\mathsf{C}}
\arrow[""{name=F, anchor=center, inner sep=10}, "F", bend right=25, from=1-1, to=1-2]
\arrow[""{name=G, anchor=center, inner sep=10}, "G"', bend left=25, from=1-1, to=1-2]
\arrow["\theta", shorten <=4pt, shorten >=4pt, Rightarrow, from=F, to=G]
\end{tikzcd}
\end{document}
```
>
>   上述条件称为自然性条件(natuality condition)。


```tikz
```
> [!definition] 自然同构
>   如果对于 $\mathsf{C}^\prime$ 中的每一个对象 $X$，分量 $\theta_X: F(X) \rightarrow G(X)$ 都是一个**同构 (isomorphism)**（即可逆），那么这个自然变换 $\theta$ 就被称为**自然同构 (natural isomorphism)** 或**自然等价 (natural equivalence)**（我已经基本上将这个术语清除了，因为我并不理解等价在范畴中的含义，有时候似乎被滥用了，例如等价也被用于范畴等价中，容易混淆），或简称**同构**。
>
>   在这种情况下，函子 $F$ 和 $G$ 被认为是**同构**的，记作 $F \simeq G$。这是函子范畴意义下的同构。
>   
>   这个定义也出现在[[LiWenWei2023DaiShuXueFangFaJuanYi]]定义2.2.8的上面，称$\theta:F\to G$是函子之间的同构（函子同构），称$\theta_X:FX\rightarrow GX$是对变元$X$的**典范同构**或**自然同构**。
{ #r9x7z8}



> [!note]
> - 自然变换是一系列两个函子的像之间的箭头。可以将$\theta$视为由$\mathsf{C}^\prime$中的对象$X$索引的一族态射，显然只有当$FX$和$GX$都在同一个范畴中才能定义他们之间的态射，四角和四边上的东西分别都是$\mathsf{C}$中的对象和态射。
>
>   自然变换保持了两个函子的作用、对称性或其他结构。
>
>   自然变换是一个正统的、标准的、系统的、直觉上自然的映射。
>
>   如果$\theta_X$这族态射中的每个一都是同构，那么称两个函子是自然同构的。
>
>   看到自然变换$\theta:F\implies G$就插入对象$X$，称为$\theta_X:FX\rightarrow GX$
>
>   在函子范畴中，函子是对象，自然变换是函子之间的态射，因此有定义头中的称呼。
>
>   通常称分量$\theta_X$关于$X$自然，以表示$\theta$是自然变换。

## 函子等价

<div class="transclusion internal-embed is-loaded"><a class="markdown-embed-link" href="/1 Stories of Bizzo's Life/1 数学基础/范畴/#q7hwob" aria-label="Open link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a><div class="markdown-embed">



> [!definition] 函子等价（范畴等价）{\cite[Def.0.17 {heunen2019CategoriesQuantumTheory}}]
>   函子 $F: \mathsf{C}^{\prime} \rightarrow \mathsf{C}$ 称为**等价**(equivalence)如果它满足以下三个性质，
> - **全**(full)：对每个 $X, Y \in \operatorname{Ob}\left(\mathsf{C}^{\prime}\right)$，都有$F:\mathrm{Hom}(X,Y)\rightarrow \mathrm{Hom}(F(X),F(Y)), f\mapsto F(f)$是满射。即函子$F$关于态射是满射。
> - **忠实**(faithful)：对每个 $X, Y \in \operatorname{Ob}\left(\mathsf{C}^{\prime}\right)$，以及所有箭头对$f_1,f_2:X\rightarrow Y$，都有$Ff_1=Ff_2$蕴含$f_1=f_2$。即函子$F$关于态射的是单射。
> - **本质满射**(essentially surjective on objects)：对每个$A\in \operatorname{Ob}\left(\mathsf{C}\right)$ ，都存在$X\in \operatorname{Ob}\left(\mathsf{C}^{\prime}\right)$，使得$F(X)$与$A$同构。即在对象同构的意义下，函子$F$关于对象是满射。 

</div></div>

基于自然变换和自然同构，有范畴等价的另一个刻画。
> [!theorem] 用自然变换定义等价函子（[[heunen2019CategoriesQuantumTheory]] Def.0.21，[[LiWenWei2023DaiShuXueFangFaJuanYi]] Th.2.2.13）
> - 函子$F:\mathsf{C}\rightarrow \mathsf{D}$是等价(即全忠实、本质满射)当且仅当存在一个函子$G:\mathsf{D}\rightarrow \mathsf{C}$使得函子的自然同构成立$F\circ G\simeq \mathrm{id}_\mathsf{C}$ 以及$G\circ F\simeq \mathrm{id}_\mathsf{D}$，称$G$和$F$互为**伪逆**，又称**拟逆**(pseudo)。


> [!proof]
> - [[函子等价的等价刻画]] 


> [!note]
> - 为什么不需要定义关于对象的本质单射？忠实满函子蕴含了“本质单射”{（[[perrone2024StartingCategoryTheory]] prop.1.5.7）}。只需要满、忠实和本质忠实就已经能够说明存在两个范畴之间存在等价，即存在一对自然变换$\alpha:F\circ G\implies \mathrm{id}_\mathsf{C}$和$\beta:G\circ F\implies \mathrm{id}_\mathsf{D}$。
> - 如果进一步有$F\circ G = \mathrm{id}_\mathsf{C}$以及$G\circ F = \mathrm{id}_\mathsf{D}$，则称$\mathsf{C}$和$\mathsf{D}$**同构**，$F$称为范畴之间的**同构**（范畴同构），$G$称为$F$的逆，在范畴层面等价比同构更有用[[LiWenWei2023DaiShuXueFangFaJuanYi]] def.2.2.8。
好的，我们来系统地整理函子之间两种重要的合成方式：**纵向合成 (Vertical Composition)** 和 **横向合成 (Horizontal Composition)**。
## 自然变换的合成
这两种合成的对象都是**自然变换 (Natural Transformations)**，它们构成了更高层次的范畴结构，即**2-范畴**的基础。
### 1. 纵向合成 (Vertical Composition)
#### 定义
纵向合成是最直观的一种。它就像普通函数的复合一样，将两个“头尾相连”的自然变换合成为一个新的自然变换。
**前提条件**：
给定三个函子 $F, G, H: \mathsf{C} \to \mathsf{D}$，以及两个自然变换：
*   $\theta: F \Rightarrow G$
*   $\psi: G \Rightarrow H$
**定义**：
它们的**纵向合成**是一个新的自然变换，记作 $\psi \circ \theta : F \Rightarrow H$。其在任意对象 $X \in Ob(\mathsf{C})$ 上的分量 $(\psi \circ \theta)_X$ 定义为对应分量态射的复合：
$$
(\psi \circ \theta)_X := \psi_X \circ \theta_X : F(X) \to H(X)
$$
#### 图示
在分量层面，这个定义非常简单：
$$
F(X) \xrightarrow{\theta_X} G(X) \xrightarrow{\psi_X} H(X)
$$
在函子层面，我们可以将其想象为垂直方向上的箭头复合，这也是“纵向”这个名称的由来：
$$
\begin{CD}
F \\
@V{\theta}VV \\
G \\
@V{\psi}VV \\
H
\end{CD}
\quad \text{合成为    } \quad \quad
\begin{CD}
F \\
@V{\psi \circ \theta}VV \\
H
\end{CD}
$$
#### 主要性质
*   **结合性**：纵向合成满足结合律，即 $(\phi \circ \psi) \circ \theta = \phi \circ (\psi \circ \theta)$。
*   **单位元**：对于任何函子 $F$，都存在一个**恒等自然变换 (identity natural transformation)** $id_F: F \Rightarrow F$，其每个分量都是恒等态射 $(id_F)_X = id_{F(X)}$。它是纵向合成的单位元。
*   **函子范畴**：正是由于这些性质，对于给定的范畴 $\mathsf{C}$ 和 $\mathsf{D}$，所有的函子 $F: \mathsf{C} \to \mathsf{D}$ 作为**对象**，它们之间的自然变换作为**态射**，构成了一个新的范畴，即**函子范畴** $[\mathsf{C}, \mathsf{D}]$。
---
### 2. 横向合成 (Horizontal Composition)
#### 定义
横向合成则更为复杂，它涉及到**函子自身的复合**。它描述了如何将两个独立的自然变换“并排”合成为一个新的自然变换。
**前提条件**：
给定三个范畴 $\mathsf{C}, \mathsf{D}, \mathsf{E}$ 和四个函子：
*   $F_1, F_2: \mathsf{C} \to \mathsf{D}$
*   $G_1, G_2: \mathsf{D} \to \mathsf{E}$
以及两个自然变换：
*   $\theta: F_1 \Rightarrow F_2$
*   $\psi: G_1 \Rightarrow G_2$
**定义**：
它们的**横向合成**是一个新的自然变换，记作 $\psi * \theta$ (有时也用 $\circ$ 或 $\circ_h$)，它作用于复合函子之间：
$$
\psi * \theta : G_1 \circ F_1 \Rightarrow G_2 \circ F_2
$$
其在任意对象 $X \in Ob(\mathsf{C})$ 上的分量 $(\psi * \theta)_X$ 定义为：
$$
(\psi * \theta)_X := G_2(\theta_X) \circ \psi_{F_1(X)}
$$
或者等价地
$$
(\psi * \theta)_X := \psi_{F_2(X)} \circ G_1(\theta_X)
$$
这两个定义是等价的，因为 $\psi$ 的自然性保证了下图（称为**粘贴图 (Pasting Diagram)**）的交换性：
```tikz
\usepackage{amsmath}
\usepackage{tikz-cd}
\begin{document}
\begin{tikzcd}
G_1(F_1(X)) \arrow[r, "G_1(\theta_X)"] \arrow[d, "\psi_{F_1(X)}"'] & G_1(F_2(X)) \arrow[d, "\psi_{F_2(X)}"] \\
G_2(F_1(X)) \arrow[r, "G_2(\theta_X)"] & G_2(F_2(X))
\end{tikzcd}
\end{document}
```
#### 图示
横向合成可以看作是“水平”方向上的复合：
($\mathsf{C} \xrightarrow[F_2]{\xrightarrow[\quad \theta \quad]{F_1}} \mathsf{D}$) 与 ($\mathsf{D} \xrightarrow[G_2]{\xrightarrow[\quad \psi \quad]{G_1}} \mathsf{E}$) 合成为 ($\mathsf{C} \xrightarrow[G_2 \circ F_2]{\xrightarrow[\quad \psi * \theta \quad]{G_1 \circ F_1}} \mathsf{E}$)

---
### 3. 主要定理：互换律 (Interchange Law)
先横再纵与先纵再横是互换的
- ![916601d3-8aff-401b-9f56-fdbaeee64f94.png](/img/user/916601d3-8aff-401b-9f56-fdbaeee64f94.png)
### 总结表格
| 特性          | 纵向合成 (Vertical Composition)                        | 横向合成 (Horizontal Composition)                                                             |
| :---------- | :------------------------------------------------- | :---------------------------------------------------------------------------------------- |
| **符号**      | $\psi \circ \theta$                                | $\psi * \theta$                                                                           |
| **操作对象**    | 两个头尾相接的自然变换                                        | 两个并排的函子-自然变换对                                                                             |
| **函子关系**    | $F, G, H: \mathsf{C} \to \mathsf{D}$               | $F_i: \mathsf{C} \to \mathsf{D}$, $G_i: \mathsf{D} \to \mathsf{E}$                        |
| **输入**      | $\theta: F \Rightarrow G$, $\psi: G \Rightarrow H$ | $\theta: F_1 \Rightarrow F_2$, $\psi: G_1 \Rightarrow G_2$                                |
| **输出**      | $\psi \circ \theta: F \Rightarrow H$               | $\psi * \theta: G_1 \circ F_1 \Rightarrow G_2 \circ F_2$                                  |
| **定义 (分量)** | $(\psi \circ \theta)_X = \psi_X \circ \theta_X$    | $(\psi * \theta)_X = G_2(\theta_X) \circ \psi_{F_1(X)}=\psi_{F_2(X)} \circ G_1(\theta_X)$ |
| **核心结构**    | 构成了**函子范畴**                                        | 是**2-范畴**结构的关键部分                                                                          |
| **核心定理**    | 结合律与单位元                                            | **互换律 (Interchange Law)**                                                                 |
这两种合成方式是范畴论从一维（对象和态射）向二维（对象、态射、态射之间的变换）迈进的关键，极大地丰富了范畴论的表达能力。
## 拟逆的精确到同构是唯一的
- [[拟逆的唯一性：同一个函子的拟逆是同构的]] 
## 双重对偶函子作为自然同构
> [!example] 线性空间上恒等函子与双重对偶函子之间的自然变换
> - 对偶函子\footnote{op写在前面还是写在后面应该是无关紧要的，重要的是态射被函子打到另一个范畴之后方向是相同还是相反，无论写前面还是后面都都表示这个函子是反变的。}$(\cdot)^*\equiv  \mathrm{Hom}_\mathsf{Vect}(\cdot,\mathbb{K}): \mathsf{Vect}^{\mathrm{op}}\rightarrow \mathsf{Vect}$，它将线性空间$V$打到$\mathrm{Hom}(V,\mathbb{K})$，即我们熟悉的对偶空间的定义$V^*=\{ \omega  \mid \omega :V\rightarrow \mathbb{K}\}$，对偶函子将线性映射$\phi:V\rightarrow W$打到“将$\phi$复合于前”，
>
$$
\mathrm{Hom}_\mathsf{Vect^{\mathrm{op}}}(W,\mathbb{K}) = \mathrm{Hom}_\mathsf{Vect}(\mathbb{K},W)=W^* \rightarrow \mathrm{Hom}_\mathsf{Vect^{\mathrm{op}}}(V,\mathbb{K})=\mathrm{Hom}_\mathsf{Vect}(\mathbb{K},V)=V^*
$$
>
$$
(\omega:W\rightarrow \mathbb{K}) \mapsto ( \phi^*(\omega)=\omega \circ \phi:V\rightarrow \mathbb{K})
$$
>   即对于任意的$\omega \in W^*$，定义$\phi^*(\omega)=\omega\circ \phi$，这类似于1-形式的拉回，参见式{eq:1fpullback}。由于$\phi:V\rightarrow W$和经过对偶函子作用后的$\phi^*:W^*\rightarrow V^*$两个箭头方向相反，对偶函子是反变函子，因此它和恒等函子$\mathsf{Vect}\rightarrow \mathsf{Vect}$之间不可能存在自然变换。即便推广自然性的定义，不要求打过去的是同一个范畴\footnote{实际上并不清楚$\mathsf{Vect}^{op}$和$\mathsf{Vect}$是否在某种意义下一样，即他们之间是否存在函子(范畴)等价}，任何在$V$与$V^*$建立的同构$d_V$都不可能使得下图交换，
>
>   ```tikz
>   \usepackage{amsmath}
>   \usepackage{tikz-cd}
>   \begin{document}
>   \begin{tikzcd}
>   V & {V^{*}} \\
>   V & {V^{*}}
>   \arrow["\phi"', from=1-1, to=2-1]
>   \arrow["{d_V}", from=1-1, to=1-2]
>   \arrow["{d_V}"', from=2-1, to=2-2]
>   \arrow["{\phi^{*}}", from=1-2, to=2-2]
>   \end{tikzcd}
>   \end{document}
>   ```
>
>
>   下面不证明不存在性(如何证?)，仅仅提供一个看上去自然但实际上并不自然的同构$d:V\rightarrow V^*,d(e_i)=e^i$，其中$e^i(e_i)=\delta_{j}^i$，根据线性性$d(v^ie_i)=v^ie^i$，分别沿两条路径走
>
$$
d(\phi(v))(e_k)=v^i\phi_{ki}
$$
>
$$
\phi^*(d(v))(e_k)=v^i\phi_{ik}
$$
>   基变换的图是交换的当且仅当$\phi_{ik}=\phi_{ki}$，即$\phi$在$\{e_i\}$下的矩阵是对称的。
>
>   这里没有提供$\mathsf{Vect}^{\mathrm{op}}$中的态射是1-形式(线性变换？还是什么？)的证明，\myemph{如何证?}，$\mathsf{Vect}$中的态射$\phi:V\rightarrow W$在$\mathsf{Vect}^{\mathrm{op}}$中对应的箭头是什么样的？思考共轭转置和对偶映射之间的关系。为什么对偶函子用$\mathrm{Hom}_{\mathsf{Vect}}(\cdot,\mathbb{K})$来定义而不是用其他的除$\mathbb{K}$以外的线性空间？
>
>
>
>   通常称线性空间$V$及其两重对偶$V^{**}$求值映射$\text{ev}$为自然同构，即对于任意的$V$，有$V\cong V^{**}$，这是存在从恒等自函子到双重对偶函子的自然变换(实际上是自然同构)
$$
\mathrm{ev}:\mathrm{id}_{\mathsf{Vect}}\implies \mathrm{Hom}_{\mathsf{Vect}}(\mathrm{Hom}_{\mathsf{Vect}}(\cdot,\mathbb{K}),\mathbb{K})
$$
>   其分量为$\mathrm{ev}_V:V\rightarrow V^{**},~v\mapsto (\mathrm{ev}_V(v):V^*\rightarrow \mathbb{K} ,~\omega \mapsto \mathrm{ev}_V(v)(\omega)=\omega(v))$。下面验证自然性，即存在交换图
>
>   ```tikz
>   \usepackage{amsmath}
>   \usepackage{tikz-cd}
>   \begin{document}
>   \begin{tikzcd}
>   V & {V^{**}} \\
>   W & {W^{**}}
>   \arrow["\phi"', from=1-1, to=2-1]
>   \arrow["{\mathrm{ev}_V}", from=1-1, to=1-2]
>   \arrow["{\mathrm{ev}_W}"', from=2-1, to=2-2]
>   \arrow["{\phi^{**}}", from=1-2, to=2-2]
>   \end{tikzcd}
>   \end{document}
>   ```
>
>
>   只要证明$\phi^{**}\circ \mathrm{ev}_V =\mathrm{ev}_W\circ \phi$，设$x \in V$，根据对偶函子的定义，$\phi^{**}(\mathrm{ev}_V(x))=\mathrm{ev}_V(x)\circ \phi^*$，取$\omega\in W^*$，有$\phi^{**}(\mathrm{ev}_V(x))(\omega)=\mathrm{ev}_V(x)\circ \phi^*(\omega) =\mathrm{ev}_V(x)(\omega\circ \phi)=\omega\circ \phi(x)$。另一方面，$\mathrm{ev}_W(\phi(x)) = \omega\circ \phi(x)$。如果$V=W$，且$\phi$是线性同构，那么可以将$\phi$理解为基变换(基变换就是线性同构)，自然性体现在如果改变$V$中的基底，那么$V^{**}$的基底也会随之改变，在基变换前后映射 $\mathrm{ev}_V$相等。
> [!example] $G$-等变函数是自然同构
> - 参见定义\ref{def:gequiv}。
